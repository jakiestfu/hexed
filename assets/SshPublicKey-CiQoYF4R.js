import{k as y}from"./index-Cy_iKu7E.js";var l=Object.getOwnPropertyNames,g=(h,o)=>function(){return o||(0,h[l(h)[0]])((o={exports:{}}).exports,o),o.exports},m=g({"<stdin>"(h){(function(o,r){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],r):typeof h=="object"&&h!==null&&typeof h.nodeType!="number"?r(h,y.KaitaiStream):r(o.SshPublicKey||(o.SshPublicKey={}),o.KaitaiStream)})(typeof self<"u"?self:h,function(o,r){var a=(function(){function n(t,e,s){this._io=t,this._parent=e,this._root=s||this,this._debug={},this._read()}n.prototype._read=function(){switch(this._debug.keyName={start:this._io.pos,ioOffset:this._io.byteOffset},this.keyName=new d(this._io,this,this._root),this._debug.keyName.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.keyName.value){case"ecdsa-sha2-nistp256":this.body=new p(this._io,this,this._root);break;case"ssh-dss":this.body=new u(this._io,this,this._root);break;case"ssh-ed25519":this.body=new c(this._io,this,this._root);break;case"ssh-rsa":this.body=new f(this._io,this,this._root);break}this._debug.body.end=this._io.pos};var _=n.Bignum2=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU4be(),this._debug.len.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.body=this._io.readBytes(this.len),this._debug.body.end=this._io.pos},Object.defineProperty(t.prototype,"lengthInBits",{get:function(){return this._m_lengthInBits!==void 0?this._m_lengthInBits:(this._debug._m_lengthInBits={},this._m_lengthInBits=(this.len-1)*8,this._m_lengthInBits)}}),t})(),d=n.Cstring=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU4be(),this._debug.len.end=this._io.pos,this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.value=r.bytesToStr(this._io.readBytes(this.len),"ASCII"),this._debug.value.end=this._io.pos},t})(),b=n.EllipticCurve=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU4be(),this._debug.len.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.body=this._io.readBytes(this.len),this._debug.body.end=this._io.pos},t})(),u=n.KeyDsa=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.dsaP={start:this._io.pos,ioOffset:this._io.byteOffset},this.dsaP=new _(this._io,this,this._root),this._debug.dsaP.end=this._io.pos,this._debug.dsaQ={start:this._io.pos,ioOffset:this._io.byteOffset},this.dsaQ=new _(this._io,this,this._root),this._debug.dsaQ.end=this._io.pos,this._debug.dsaG={start:this._io.pos,ioOffset:this._io.byteOffset},this.dsaG=new _(this._io,this,this._root),this._debug.dsaG.end=this._io.pos,this._debug.dsaPubKey={start:this._io.pos,ioOffset:this._io.byteOffset},this.dsaPubKey=new _(this._io,this,this._root),this._debug.dsaPubKey.end=this._io.pos},t})(),p=n.KeyEcdsa=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.curveName={start:this._io.pos,ioOffset:this._io.byteOffset},this.curveName=new d(this._io,this,this._root),this._debug.curveName.end=this._io.pos,this._debug.ec={start:this._io.pos,ioOffset:this._io.byteOffset},this.ec=new b(this._io,this,this._root),this._debug.ec.end=this._io.pos},t})(),c=n.KeyEd25519=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.lenPk={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenPk=this._io.readU4be(),this._debug.lenPk.end=this._io.pos,this._debug.pk={start:this._io.pos,ioOffset:this._io.byteOffset},this.pk=this._io.readBytes(this.lenPk),this._debug.pk.end=this._io.pos},t})(),f=n.KeyRsa=(function(){function t(e,s,i){this._io=e,this._parent=s,this._root=i,this._debug={},this._read()}return t.prototype._read=function(){this._debug.rsaE={start:this._io.pos,ioOffset:this._io.byteOffset},this.rsaE=new _(this._io,this,this._root),this._debug.rsaE.end=this._io.pos,this._debug.rsaN={start:this._io.pos,ioOffset:this._io.byteOffset},this.rsaN=new _(this._io,this,this._root),this._debug.rsaN.end=this._io.pos},Object.defineProperty(t.prototype,"keyLength",{get:function(){return this._m_keyLength!==void 0?this._m_keyLength:(this._debug._m_keyLength={},this._m_keyLength=this.rsaN.lengthInBits,this._m_keyLength)}}),t})();return n})();o.SshPublicKey=a})}});const O=m(),v={id:"ssh_public_key",title:"SSH public key",ksy:{meta:{id:"ssh_public_key",title:"SSH public key",license:"CC0-1.0",endian:"be"},doc:`SSH public keys are encoded in a special binary format, typically represented
to end users as either one-liner OpenSSH format or multi-line PEM format
(commercial SSH). Text wrapper carries extra information about user who
created the key, comment, etc, but the inner binary is always base64-encoded
and follows the same internal format.

This format spec deals with this internal binary format (called "blob" in
openssh sources) only. Buffer is expected to be raw binary and not base64-d.
Implementation closely follows code in OpenSSH.
`,"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshkey.c#L1970",seq:[{id:"key_name",type:"cstring"},{id:"body",type:{"switch-on":"key_name.value",cases:{'"ssh-rsa"':"key_rsa",'"ecdsa-sha2-nistp256"':"key_ecdsa",'"ssh-ed25519"':"key_ed25519",'"ssh-dss"':"key_dsa"}}}],types:{key_rsa:{"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshkey.c#L2011-L2028",seq:[{id:"rsa_e",type:"bignum2",doc:"Public key exponent, designated `e` in RSA documentation."},{id:"rsa_n",type:"bignum2",doc:'Modulus of both public and private keys, designated `n` in RSA\ndocumentation. Its length in bits is designated as "key length".\n'}],instances:{key_length:{"-webide-parse-mode":"eager",value:"rsa_n.length_in_bits",doc:"Key length in bits"}}},key_ecdsa:{"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshkey.c#L2060-L2103",seq:[{id:"curve_name",type:"cstring"},{id:"ec",type:"elliptic_curve"}]},key_ed25519:{"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshkey.c#L2111-L2124",seq:[{id:"len_pk",type:"u4"},{id:"pk",size:"len_pk"}]},key_dsa:{"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshkey.c#L2036-L2051",seq:[{id:"dsa_p",type:"bignum2"},{id:"dsa_q",type:"bignum2"},{id:"dsa_g",type:"bignum2"},{id:"dsa_pub_key",type:"bignum2"}]},cstring:{doc:'A integer-prefixed string designed to be read using `sshbuf_get_cstring`\nand written by `sshbuf_put_cstring` routines in ssh sources. Name is an\nobscure misnomer, as typically "C string" means a null-terminated string.\n',"doc-ref":"https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshbuf-getput-basic.c#L181","-webide-representation":"{value}",seq:[{id:"len",type:"u4"},{id:"value",type:"str",size:"len",encoding:"ASCII"}]},bignum2:{doc:`Big integers serialization format used by ssh, v2. In the code, the following
routines are used to read/write it:

* sshbuf_get_bignum2
* sshbuf_get_bignum2_bytes_direct
* sshbuf_put_bignum2
* sshbuf_get_bignum2_bytes_direct
`,"doc-ref":`https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshbuf-getput-crypto.c#L35
https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshbuf-getput-basic.c#L431
`,seq:[{id:"len",type:"u4"},{id:"body",size:"len"}],instances:{length_in_bits:{value:"(len - 1) * 8",doc:"Length of big integer in bits. In OpenSSH sources, this corresponds to\n`BN_num_bits` function.\n"}}},elliptic_curve:{doc:`Elliptic curve dump format used by ssh. In OpenSSH code, the following
routines are used to read/write it:

* sshbuf_get_ec
* get_ec
`,"doc-ref":`https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshbuf-getput-crypto.c#L90
https://github.com/openssh/openssh-portable/blob/b4d4eda6/sshbuf-getput-crypto.c#L76
`,seq:[{id:"len",type:"u4"},{id:"body",size:"len"}]}}}};export{O as default,v as spec};
