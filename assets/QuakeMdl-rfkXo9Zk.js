import{k as l}from"./index-DZ3xxA7Z.js";var c=Object.getOwnPropertyNames,y=(a,r)=>function(){return r||(0,a[c(a)[0]])((r={exports:{}}).exports,r),r.exports},O=y({"<stdin>"(a){(function(r,o){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],o):typeof a=="object"&&a!==null&&typeof a.nodeType!="number"?o(a,l.KaitaiStream):o(r.QuakeMdl||(r.QuakeMdl={}),r.KaitaiStream)})(typeof self<"u"?self:a,function(r,o){var _=(function(){function h(t,e,i){this._io=t,this._parent=e,this._root=i||this,this._debug={},this._read()}h.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new u(this._io,this,this._root),this._debug.header.end=this._io.pos,this._debug.skins={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.skins.arr=[],this.skins=[];for(var t=0;t<this.header.numSkins;t++)this._debug.skins.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.skins.push(new m(this._io,this,this._root)),this._debug.skins.arr[t].end=this._io.pos;this._debug.skins.end=this._io.pos,this._debug.textureCoordinates={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.textureCoordinates.arr=[],this.textureCoordinates=[];for(var t=0;t<this.header.numVerts;t++)this._debug.textureCoordinates.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.textureCoordinates.push(new b(this._io,this,this._root)),this._debug.textureCoordinates.arr[t].end=this._io.pos;this._debug.textureCoordinates.end=this._io.pos,this._debug.triangles={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.triangles.arr=[],this.triangles=[];for(var t=0;t<this.header.numTris;t++)this._debug.triangles.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.triangles.push(new g(this._io,this,this._root)),this._debug.triangles.arr[t].end=this._io.pos;this._debug.triangles.end=this._io.pos,this._debug.frames={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.frames.arr=[],this.frames=[];for(var t=0;t<this.header.numFrames;t++)this._debug.frames.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.frames.push(new f(this._io,this,this._root)),this._debug.frames.arr[t].end=this._io.pos;this._debug.frames.end=this._io.pos};var f=h.MdlFrame=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=this._io.readS4le(),this._debug.type.end=this._io.pos,this.type!=0&&(this._debug.min={start:this._io.pos,ioOffset:this._io.byteOffset},this.min=new n(this._io,this,this._root),this._debug.min.end=this._io.pos),this.type!=0&&(this._debug.max={start:this._io.pos,ioOffset:this._io.byteOffset},this.max=new n(this._io,this,this._root),this._debug.max.end=this._io.pos),this.type!=0){this._debug.time={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.time.arr=[],this.time=[];for(var e=0;e<this.type;e++)this._debug.time.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.time.push(this._io.readF4le()),this._debug.time.arr[e].end=this._io.pos;this._debug.time.end=this._io.pos}this._debug.frames={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.frames.arr=[],this.frames=[];for(var e=0;e<this.numSimpleFrames;e++)this._debug.frames.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.frames.push(new p(this._io,this,this._root)),this._debug.frames.arr[e].end=this._io.pos;this._debug.frames.end=this._io.pos},Object.defineProperty(t.prototype,"numSimpleFrames",{get:function(){return this._m_numSimpleFrames!==void 0?this._m_numSimpleFrames:(this._debug._m_numSimpleFrames={},this._m_numSimpleFrames=this.type==0?1:this.type,this._m_numSimpleFrames)}}),t})(),u=h.MdlHeader=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.ident={start:this._io.pos,ioOffset:this._io.byteOffset},this.ident=this._io.readBytes(4),this._debug.ident.end=this._io.pos,o.byteArrayCompare(this.ident,new Uint8Array([73,68,80,79]))!=0){var e=new o.ValidationNotEqualError(new Uint8Array([73,68,80,79]),this.ident,this._io,"/types/mdl_header/seq/0");throw this._debug.ident.validationError=e,e}if(this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readS4le(),this._debug.version.end=this._io.pos,this.version!=6){var e=new o.ValidationNotEqualError(6,this.version,this._io,"/types/mdl_header/seq/1");throw this._debug.version.validationError=e,e}this._debug.scale={start:this._io.pos,ioOffset:this._io.byteOffset},this.scale=new d(this._io,this,this._root),this._debug.scale.end=this._io.pos,this._debug.origin={start:this._io.pos,ioOffset:this._io.byteOffset},this.origin=new d(this._io,this,this._root),this._debug.origin.end=this._io.pos,this._debug.radius={start:this._io.pos,ioOffset:this._io.byteOffset},this.radius=this._io.readF4le(),this._debug.radius.end=this._io.pos,this._debug.eyePosition={start:this._io.pos,ioOffset:this._io.byteOffset},this.eyePosition=new d(this._io,this,this._root),this._debug.eyePosition.end=this._io.pos,this._debug.numSkins={start:this._io.pos,ioOffset:this._io.byteOffset},this.numSkins=this._io.readS4le(),this._debug.numSkins.end=this._io.pos,this._debug.skinWidth={start:this._io.pos,ioOffset:this._io.byteOffset},this.skinWidth=this._io.readS4le(),this._debug.skinWidth.end=this._io.pos,this._debug.skinHeight={start:this._io.pos,ioOffset:this._io.byteOffset},this.skinHeight=this._io.readS4le(),this._debug.skinHeight.end=this._io.pos,this._debug.numVerts={start:this._io.pos,ioOffset:this._io.byteOffset},this.numVerts=this._io.readS4le(),this._debug.numVerts.end=this._io.pos,this._debug.numTris={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTris=this._io.readS4le(),this._debug.numTris.end=this._io.pos,this._debug.numFrames={start:this._io.pos,ioOffset:this._io.byteOffset},this.numFrames=this._io.readS4le(),this._debug.numFrames.end=this._io.pos,this._debug.synctype={start:this._io.pos,ioOffset:this._io.byteOffset},this.synctype=this._io.readS4le(),this._debug.synctype.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=this._io.readS4le(),this._debug.flags.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readF4le(),this._debug.size.end=this._io.pos},Object.defineProperty(t.prototype,"skinSize",{get:function(){return this._m_skinSize!==void 0?this._m_skinSize:(this._debug._m_skinSize={},this._m_skinSize=this.skinWidth*this.skinHeight,this._m_skinSize)}}),t})(),p=h.MdlSimpleFrame=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.bboxMin={start:this._io.pos,ioOffset:this._io.byteOffset},this.bboxMin=new n(this._io,this,this._root),this._debug.bboxMin.end=this._io.pos,this._debug.bboxMax={start:this._io.pos,ioOffset:this._io.byteOffset},this.bboxMax=new n(this._io,this,this._root),this._debug.bboxMax.end=this._io.pos,this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=o.bytesToStr(o.bytesTerminate(o.bytesStripRight(this._io.readBytes(16),0),0,!1),"ASCII"),this._debug.name.end=this._io.pos,this._debug.vertices={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.vertices.arr=[],this.vertices=[];for(var e=0;e<this._root.header.numVerts;e++)this._debug.vertices.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.vertices.push(new n(this._io,this,this._root)),this._debug.vertices.arr[e].end=this._io.pos;this._debug.vertices.end=this._io.pos},t})(),m=h.MdlSkin=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.group={start:this._io.pos,ioOffset:this._io.byteOffset},this.group=this._io.readS4le(),this._debug.group.end=this._io.pos,this.group==0&&(this._debug.singleTextureData={start:this._io.pos,ioOffset:this._io.byteOffset},this.singleTextureData=this._io.readBytes(this._root.header.skinSize),this._debug.singleTextureData.end=this._io.pos),this.group!=0&&(this._debug.numFrames={start:this._io.pos,ioOffset:this._io.byteOffset},this.numFrames=this._io.readU4le(),this._debug.numFrames.end=this._io.pos),this.group!=0){this._debug.frameTimes={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.frameTimes.arr=[],this.frameTimes=[];for(var e=0;e<this.numFrames;e++)this._debug.frameTimes.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.frameTimes.push(this._io.readF4le()),this._debug.frameTimes.arr[e].end=this._io.pos;this._debug.frameTimes.end=this._io.pos}if(this.group!=0){this._debug.groupTextureData={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.groupTextureData.arr=[],this.groupTextureData=[];for(var e=0;e<this.numFrames;e++)this._debug.groupTextureData.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.groupTextureData.push(this._io.readBytes(this._root.header.skinSize)),this._debug.groupTextureData.arr[e].end=this._io.pos;this._debug.groupTextureData.end=this._io.pos}},t})(),b=h.MdlTexcoord=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.onSeam={start:this._io.pos,ioOffset:this._io.byteOffset},this.onSeam=this._io.readS4le(),this._debug.onSeam.end=this._io.pos,this._debug.s={start:this._io.pos,ioOffset:this._io.byteOffset},this.s=this._io.readS4le(),this._debug.s.end=this._io.pos,this._debug.t={start:this._io.pos,ioOffset:this._io.byteOffset},this.t=this._io.readS4le(),this._debug.t.end=this._io.pos},t})(),g=h.MdlTriangle=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.facesFront={start:this._io.pos,ioOffset:this._io.byteOffset},this.facesFront=this._io.readS4le(),this._debug.facesFront.end=this._io.pos,this._debug.vertices={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.vertices.arr=[],this.vertices=[];for(var e=0;e<3;e++)this._debug.vertices.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.vertices.push(this._io.readS4le()),this._debug.vertices.arr[e].end=this._io.pos;this._debug.vertices.end=this._io.pos},t})(),n=h.MdlVertex=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.values={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.values.arr=[],this.values=[];for(var e=0;e<3;e++)this._debug.values.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.values.push(this._io.readU1()),this._debug.values.arr[e].end=this._io.pos;this._debug.values.end=this._io.pos,this._debug.normalIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.normalIndex=this._io.readU1(),this._debug.normalIndex.end=this._io.pos},t})(),d=h.Vec3=(function(){function t(e,i,s){this._io=e,this._parent=i,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.x={start:this._io.pos,ioOffset:this._io.byteOffset},this.x=this._io.readF4le(),this._debug.x.end=this._io.pos,this._debug.y={start:this._io.pos,ioOffset:this._io.byteOffset},this.y=this._io.readF4le(),this._debug.y.end=this._io.pos,this._debug.z={start:this._io.pos,ioOffset:this._io.byteOffset},this.z=this._io.readF4le(),this._debug.z.end=this._io.pos},t})();return h})();r.QuakeMdl=_})}});const x=O(),k={id:"quake_mdl",title:"Quake 1 (idtech2) model format (MDL version 6)",ksy:{meta:{id:"quake_mdl",title:"Quake 1 (idtech2) model format (MDL version 6)",application:"Quake 1 (idtech2)","file-extension":"mdl",tags:["3d","game"],license:"CC0-1.0","ks-version":"0.10",endian:"le"},doc:`Quake 1 model format is used to store 3D models completely with
textures and animations used in the game. Quake 1 engine
(retroactively named "idtech2") is a popular 3D engine first used
for Quake game by id Software in 1996.

Model is constructed traditionally from vertices in 3D space, faces
which connect vertices, textures ("skins", i.e. 2D bitmaps) and
texture UV mapping information. As opposed to more modern,
bones-based animation formats, Quake model was animated by changing
locations of all vertices it included in 3D space, frame by frame.

File format stores:

* "Skins" — effectively 2D bitmaps which will be used as a
  texture. Every model can have multiple skins — e.g. these can be
  switched to depict various levels of damage to the
  monsters. Bitmaps are 8-bit-per-pixel, indexed in global Quake
  palette, subject to lighting and gamma adjustment when rendering
  in the game using colormap technique.
* "Texture coordinates" — UV coordinates, mapping 3D vertices to
  skin coordinates.
* "Triangles" — triangular faces connecting 3D vertices.
* "Frames" — locations of vertices in 3D space; can include more
  than one frame, thus allowing representation of different frames
  for animation purposes.

Originally, 3D geometry for models for Quake was designed in [Alias
PowerAnimator](https://en.wikipedia.org/wiki/PowerAnimator),
precursor of modern day Autodesk Maya and Autodesk Alias. Therefore,
3D-related part of Quake model format followed closely Alias TRI
format, and Quake development utilities included a converter from Alias
TRI (\`modelgen\`).

Skins (textures) where prepared as LBM bitmaps with the help from
\`texmap\` utility in the same development utilities toolkit.
`,seq:[{id:"header",type:"mdl_header"},{id:"skins",type:"mdl_skin",repeat:"expr","repeat-expr":"header.num_skins"},{id:"texture_coordinates",type:"mdl_texcoord",repeat:"expr","repeat-expr":"header.num_verts"},{id:"triangles",type:"mdl_triangle",repeat:"expr","repeat-expr":"header.num_tris"},{id:"frames",type:"mdl_frame",repeat:"expr","repeat-expr":"header.num_frames"}],types:{vec3:{"-orig-id":"vec3_t",doc:`Basic 3D vector (x, y, z) using single-precision floating point
coordnates. Can be used to specify a point in 3D space,
direction, scaling factor, etc.
`,seq:[{id:"x",type:"f4"},{id:"y",type:"f4"},{id:"z",type:"f4"}]},mdl_header:{"-orig-id":"mdl_t","doc-ref":["https://github.com/id-Software/Quake/blob/0023db327bc1db00068284b70e1db45857aeee35/WinQuake/modelgen.h#L59-L75","https://www.gamers.org/dEngine/quake/spec/quake-spec34/qkspec_5.htm#MD0"],seq:[{id:"ident",contents:"IDPO",doc:`Magic signature bytes that every Quake model must
have. "IDPO" is short for "IDPOLYHEADER".
`,"doc-ref":"https://github.com/id-Software/Quake/blob/0023db327bc1db00068284b70e1db45857aeee35/WinQuake/modelgen.h#L132-L133"},{id:"version",type:"s4",valid:{eq:6}},{id:"scale",type:"vec3",doc:`Global scaling factors in 3 dimensions for whole model. When
represented in 3D world, this model local coordinates will
be multiplied by these factors.
`},{id:"origin",type:"vec3"},{id:"radius",type:"f4"},{id:"eye_position",type:"vec3"},{id:"num_skins",type:"s4",doc:`Number of skins (=texture bitmaps) included in this model.
`},{id:"skin_width",type:"s4",doc:`Width (U coordinate max) of every skin (=texture) in pixels.
`},{id:"skin_height",type:"s4",doc:`Height (V coordinate max) of every skin (=texture) in
pixels.
`},{id:"num_verts",type:"s4",doc:`Number of vertices in this model. Note that this is constant
for all the animation frames and all textures.
`},{id:"num_tris",type:"s4",doc:`Number of triangles (=triangular faces) in this model.
`},{id:"num_frames",type:"s4",doc:`Number of animation frames included in this model.
`},{id:"synctype",type:"s4"},{id:"flags",type:"s4"},{id:"size",type:"f4"}],instances:{skin_size:{value:"skin_width * skin_height",doc:`Skin size in pixels.
`}}},mdl_skin:{seq:[{id:"group",type:"s4"},{id:"single_texture_data",size:"_root.header.skin_size",if:"group == 0"},{id:"num_frames",type:"u4",if:"group != 0"},{id:"frame_times",type:"f4",repeat:"expr","repeat-expr":"num_frames",if:"group != 0"},{id:"group_texture_data",size:"_root.header.skin_size",repeat:"expr","repeat-expr":"num_frames",if:"group != 0"}]},mdl_texcoord:{"-orig-id":"stvert_t","doc-ref":["https://github.com/id-Software/Quake/blob/0023db327bc1db00068284b70e1db45857aeee35/WinQuake/modelgen.h#L79-L83","https://www.gamers.org/dEngine/quake/spec/quake-spec34/qkspec_5.htm#MD2"],seq:[{id:"on_seam",type:"s4"},{id:"s",type:"s4"},{id:"t",type:"s4"}]},mdl_triangle:{"-orig-id":"dtriangle_t",doc:`Represents a triangular face, connecting 3 vertices, referenced
by their indexes.
`,"doc-ref":["https://github.com/id-Software/Quake/blob/0023db327bc1db00068284b70e1db45857aeee35/WinQuake/modelgen.h#L85-L88","https://www.gamers.org/dEngine/quake/spec/quake-spec34/qkspec_5.htm#MD3"],seq:[{id:"faces_front",type:"s4"},{id:"vertices",type:"s4",repeat:"expr","repeat-expr":3}]},mdl_vertex:{seq:[{id:"values",type:"u1",repeat:"expr","repeat-expr":3},{id:"normal_index",type:"u1"}]},mdl_simple_frame:{seq:[{id:"bbox_min",type:"mdl_vertex"},{id:"bbox_max",type:"mdl_vertex"},{id:"name",type:"str",size:16,encoding:"ASCII",terminator:0,"pad-right":0},{id:"vertices",type:"mdl_vertex",repeat:"expr","repeat-expr":"_root.header.num_verts"}]},mdl_frame:{seq:[{id:"type",type:"s4"},{id:"min",type:"mdl_vertex",if:"type != 0"},{id:"max",type:"mdl_vertex",if:"type != 0"},{id:"time",type:"f4",repeat:"expr","repeat-expr":"type",if:"type != 0"},{id:"frames",type:"mdl_simple_frame",repeat:"expr","repeat-expr":"num_simple_frames"}],instances:{num_simple_frames:{value:"(type == 0 ? 1 : type)"}}}}}};export{x as default,k as spec};
