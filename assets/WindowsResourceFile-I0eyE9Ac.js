import{k as u}from"./index-C9sUxlHS.js";var f=Object.getOwnPropertyNames,p=(t,i)=>function(){return i||(0,t[f(t)[0]])((i={exports:{}}).exports,i),i.exports},c=p({"<stdin>"(t){(function(i,o){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],o):typeof t=="object"&&t!==null&&typeof t.nodeType!="number"?o(t,u.KaitaiStream):o(i.WindowsResourceFile||(i.WindowsResourceFile={}),i.KaitaiStream)})(typeof self<"u"?self:t,function(i,o){var h=(function(){function n(e,s,r){this._io=e,this._parent=s,this._root=r||this,this._debug={},this._read()}n.prototype._read=function(){for(this._debug.resources={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.resources.arr=[],this.resources=[];!this._io.isEof();)this._debug.resources.arr[this.resources.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.resources.push(new _(this._io,this,this._root)),this._debug.resources.arr[this.resources.length-1].end=this._io.pos;this._debug.resources.end=this._io.pos};var _=n.Resource=(function(){e.PredefTypes=Object.freeze({CURSOR:1,BITMAP:2,ICON:3,MENU:4,DIALOG:5,STRING:6,FONTDIR:7,FONT:8,ACCELERATOR:9,RCDATA:10,MESSAGETABLE:11,GROUP_CURSOR:12,GROUP_ICON:14,VERSION:16,DLGINCLUDE:17,PLUGPLAY:19,VXD:20,ANICURSOR:21,ANIICON:22,HTML:23,MANIFEST:24,1:"CURSOR",2:"BITMAP",3:"ICON",4:"MENU",5:"DIALOG",6:"STRING",7:"FONTDIR",8:"FONT",9:"ACCELERATOR",10:"RCDATA",11:"MESSAGETABLE",12:"GROUP_CURSOR",14:"GROUP_ICON",16:"VERSION",17:"DLGINCLUDE",19:"PLUGPLAY",20:"VXD",21:"ANICURSOR",22:"ANIICON",23:"HTML",24:"MANIFEST"});function e(s,r,a){this._io=s,this._parent=r,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){this._debug.valueSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.valueSize=this._io.readU4le(),this._debug.valueSize.end=this._io.pos,this._debug.headerSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerSize=this._io.readU4le(),this._debug.headerSize.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=new d(this._io,this,this._root),this._debug.type.end=this._io.pos,this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=new d(this._io,this,this._root),this._debug.name.end=this._io.pos,this._debug.padding1={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding1=this._io.readBytes(o.mod(4-this._io.pos,4)),this._debug.padding1.end=this._io.pos,this._debug.formatVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.formatVersion=this._io.readU4le(),this._debug.formatVersion.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=this._io.readU2le(),this._debug.flags.end=this._io.pos,this._debug.language={start:this._io.pos,ioOffset:this._io.byteOffset},this.language=this._io.readU2le(),this._debug.language.end=this._io.pos,this._debug.valueVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.valueVersion=this._io.readU4le(),this._debug.valueVersion.end=this._io.pos,this._debug.characteristics={start:this._io.pos,ioOffset:this._io.byteOffset},this.characteristics=this._io.readU4le(),this._debug.characteristics.end=this._io.pos,this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.value=this._io.readBytes(this.valueSize),this._debug.value.end=this._io.pos,this._debug.padding2={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding2=this._io.readBytes(o.mod(4-this._io.pos,4)),this._debug.padding2.end=this._io.pos},Object.defineProperty(e.prototype,"typeAsPredef",{get:function(){return this._m_typeAsPredef!==void 0?this._m_typeAsPredef:(!this.type.isString&&this.type.asNumeric<=255&&(this._debug._m_typeAsPredef={enumName:"WindowsResourceFile.Resource.PredefTypes"},this._m_typeAsPredef=this.type.asNumeric),this._m_typeAsPredef)}}),e})(),d=n.UnicodeOrId=(function(){function e(s,r,a){this._io=s,this._parent=r,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){if(this.savePos1>=0&&(this._debug.first={start:this._io.pos,ioOffset:this._io.byteOffset},this.first=this._io.readU2le(),this._debug.first.end=this._io.pos),this.isString||(this._debug.asNumeric={start:this._io.pos,ioOffset:this._io.byteOffset},this.asNumeric=this._io.readU2le(),this._debug.asNumeric.end=this._io.pos),this.isString){this._debug.rest={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.rest.arr=[],this.rest=[];do{this._debug.rest.arr[this.rest.length]={start:this._io.pos,ioOffset:this._io.byteOffset};var s=this._io.readU2le();this.rest.push(s),this._debug.rest.arr[this.rest.length-1].end=this._io.pos}while(s!=0);this._debug.rest.end=this._io.pos}this.isString&&this.savePos2>=0&&(this._debug.noop={start:this._io.pos,ioOffset:this._io.byteOffset},this.noop=this._io.readBytes(0),this._debug.noop.end=this._io.pos)},Object.defineProperty(e.prototype,"asString",{get:function(){if(this._m_asString!==void 0)return this._m_asString;if(this.isString){var s=this._io.pos;this._io.seek(this.savePos1),this._debug._m_asString={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_asString=o.bytesToStr(this._io.readBytes(this.savePos2-this.savePos1-2),"UTF-16LE"),this._debug._m_asString.end=this._io.pos,this._io.seek(s)}return this._m_asString}}),Object.defineProperty(e.prototype,"isString",{get:function(){return this._m_isString!==void 0?this._m_isString:(this._debug._m_isString={},this._m_isString=this.first!=65535,this._m_isString)}}),Object.defineProperty(e.prototype,"savePos1",{get:function(){return this._m_savePos1!==void 0?this._m_savePos1:(this._debug._m_savePos1={},this._m_savePos1=this._io.pos,this._m_savePos1)}}),Object.defineProperty(e.prototype,"savePos2",{get:function(){return this._m_savePos2!==void 0?this._m_savePos2:(this._debug._m_savePos2={},this._m_savePos2=this._io.pos,this._m_savePos2)}}),e})();return n})();i.WindowsResourceFile=h})}});const l=c(),y={id:"windows_resource_file",title:"Windows resource file",ksy:{meta:{id:"windows_resource_file",title:"Windows resource file","file-extension":"res",xref:{justsolve:"Windows_resource",wikidata:"Q1417897"},license:"CC0-1.0",endian:"le"},doc:`Windows resource file (.res) are binary bundles of
"resources". Resource has some sort of ID (numerical or string),
type (predefined or user-defined), and raw value. Resource files can
be seen standalone (as .res file), or embedded inside PE executable
(.exe, .dll) files.

Typical use cases include:

* providing information about the application (such as title, copyrights, etc)
* embedding icon(s) to be displayed in file managers into .exe
* adding non-code data into the binary, such as menus, dialog forms,
  cursor images, fonts, various misc bitmaps, and locale-aware
  strings

Windows provides special API to access "resources" from a binary.

Normally, resources files are created with \`rc\` compiler: it takes a
.rc file (so called "resource-definition script") + all the raw
resource binary files for input, and outputs .res file. That .res
file can be linked into an .exe / .dll afterwards using a linker.

Internally, resource file is just a sequence of individual resource
definitions. RC tool ensures that first resource (#0) is always
empty.
`,seq:[{id:"resources",type:"resource",repeat:"eos"}],types:{resource:{doc:"Each resource has a `type` and a `name`, which can be used to\nidentify it, and a `value`. Both `type` and `name` can be a\nnumber or a string.\n","doc-ref":"https://learn.microsoft.com/en-us/windows/win32/menurc/resourceheader",seq:[{id:"value_size","-orig-id":"DataSize",type:"u4",doc:"Size of resource value that follows the header"},{id:"header_size","-orig-id":"HeaderSize",type:"u4",doc:"Size of this header (i.e. every field except `value` and an\noptional padding after it)\n"},{id:"type","-orig-id":"TYPE",type:"unicode_or_id"},{id:"name","-orig-id":"NAME",type:"unicode_or_id"},{id:"padding1",size:"(4 - _io.pos) % 4"},{id:"format_version","-orig-id":"DataVersion",type:"u4"},{id:"flags","-orig-id":"MemoryFlags",type:"u2"},{id:"language","-orig-id":"LanguageId",type:"u2"},{id:"value_version","-orig-id":"Version",type:"u4",doc:"Version for value, as specified by a user."},{id:"characteristics","-orig-id":"Characteristics",type:"u4",doc:"Extra 4 bytes that can be used by user for any purpose."},{id:"value",size:"value_size"},{id:"padding2",size:"(4 - _io.pos) % 4"}],instances:{type_as_predef:{value:"type.as_numeric",enum:"predef_types",if:"not type.is_string and type.as_numeric <= 0xff",doc:`Numeric type IDs in range of [0..0xff] are reserved for
system usage in Windows, and there are some predefined,
well-known values in that range. This instance allows to get
it as enum value, if applicable.
`}},enums:{predef_types:{1:"cursor",2:"bitmap",3:"icon",4:"menu",5:"dialog",6:"string",7:"fontdir",8:"font",9:"accelerator",10:"rcdata",11:"messagetable",12:"group_cursor",14:"group_icon",16:"version",17:"dlginclude",19:"plugplay",20:"vxd",21:"anicursor",22:"aniicon",23:"html",24:"manifest"}}},unicode_or_id:{doc:"Resources use a special serialization of names and types: they\ncan be either a number or a string.\n\nUse `is_string` to check which kind we've got here, and then use\n`as_numeric` or `as_string` to get relevant value.\n",seq:[{id:"first",type:"u2",if:"save_pos1 >= 0"},{id:"as_numeric",type:"u2",if:"not is_string"},{id:"rest",type:"u2",repeat:"until","repeat-until":"_ == 0",if:"is_string"},{id:"noop",size:0,if:"is_string and save_pos2 >= 0"}],instances:{save_pos1:{value:"_io.pos"},save_pos2:{value:"_io.pos"},is_string:{value:"first != 0xffff"},as_string:{pos:"save_pos1",size:"save_pos2 - save_pos1 - 2",type:"str",encoding:"UTF-16LE",if:"is_string"}}}}}};export{l as default,y as spec};
