import{k as b}from"./index-COA_x_BK.js";var u=Object.getOwnPropertyNames,p=(r,t)=>function(){return t||(0,r[u(r)[0]])((t={exports:{}}).exports,t),t.exports},y=p({"<stdin>"(r){(function(t,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream","./DosDatetime"],s):typeof r=="object"&&r!==null&&typeof r.nodeType!="number"?s(r,b.KaitaiStream,require("./DosDatetime")):s(t.Rar||(t.Rar={}),t.KaitaiStream,t.DosDatetime||(t.DosDatetime={}))})(typeof self<"u"?self:r,function(t,s,d){var _=(function(){o.BlockTypes=Object.freeze({MARKER:114,ARCHIVE_HEADER:115,FILE_HEADER:116,OLD_STYLE_COMMENT_HEADER:117,OLD_STYLE_AUTHENTICITY_INFO_76:118,OLD_STYLE_SUBBLOCK:119,OLD_STYLE_RECOVERY_RECORD:120,OLD_STYLE_AUTHENTICITY_INFO_79:121,SUBBLOCK:122,TERMINATOR:123,114:"MARKER",115:"ARCHIVE_HEADER",116:"FILE_HEADER",117:"OLD_STYLE_COMMENT_HEADER",118:"OLD_STYLE_AUTHENTICITY_INFO_76",119:"OLD_STYLE_SUBBLOCK",120:"OLD_STYLE_RECOVERY_RECORD",121:"OLD_STYLE_AUTHENTICITY_INFO_79",122:"SUBBLOCK",123:"TERMINATOR"}),o.Methods=Object.freeze({STORE:48,FASTEST:49,FAST:50,NORMAL:51,GOOD:52,BEST:53,48:"STORE",49:"FASTEST",50:"FAST",51:"NORMAL",52:"GOOD",53:"BEST"}),o.Oses=Object.freeze({MS_DOS:0,OS_2:1,WINDOWS:2,UNIX:3,MAC_OS:4,BEOS:5,0:"MS_DOS",1:"OS_2",2:"WINDOWS",3:"UNIX",4:"MAC_OS",5:"BEOS"});function o(e,i,a){this._io=e,this._parent=i,this._root=a||this,this._debug={},this._read()}o.prototype._read=function(){for(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=new l(this._io,this,this._root),this._debug.magic.end=this._io.pos,this._debug.blocks={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.blocks.arr=[],this.blocks=[];!this._io.isEof();){switch(this._debug.blocks.arr[this.blocks.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic.version){case 0:this.blocks.push(new n(this._io,this,this._root));break;case 1:this.blocks.push(new c(this._io,this,this._root));break}this._debug.blocks.arr[this.blocks.length-1].end=this._io.pos}this._debug.blocks.end=this._io.pos};var n=o.Block=(function(){function e(i,a,h){this._io=i,this._parent=a,this._root=h,this._debug={},this._read()}return e.prototype._read=function(){switch(this._debug.crc16={start:this._io.pos,ioOffset:this._io.byteOffset},this.crc16=this._io.readU2le(),this._debug.crc16.end=this._io.pos,this._debug.blockType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Rar.BlockTypes"},this.blockType=this._io.readU1(),this._debug.blockType.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=this._io.readU2le(),this._debug.flags.end=this._io.pos,this._debug.blockSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockSize=this._io.readU2le(),this._debug.blockSize.end=this._io.pos,this.hasAdd&&(this._debug.addSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.addSize=this._io.readU4le(),this._debug.addSize.end=this._io.pos),this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockType){case o.BlockTypes.FILE_HEADER:this._raw_body=this._io.readBytes(this.bodySize);var i=new s(this._raw_body);this.body=new f(i,this,this._root);break;default:this.body=this._io.readBytes(this.bodySize);break}this._debug.body.end=this._io.pos,this.hasAdd&&(this._debug.addBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.addBody=this._io.readBytes(this.addSize),this._debug.addBody.end=this._io.pos)},Object.defineProperty(e.prototype,"bodySize",{get:function(){return this._m_bodySize!==void 0?this._m_bodySize:(this._debug._m_bodySize={},this._m_bodySize=this.blockSize-this.headerSize,this._m_bodySize)}}),Object.defineProperty(e.prototype,"hasAdd",{get:function(){return this._m_hasAdd!==void 0?this._m_hasAdd:(this._debug._m_hasAdd={},this._m_hasAdd=(this.flags&32768)!=0,this._m_hasAdd)}}),Object.defineProperty(e.prototype,"headerSize",{get:function(){return this._m_headerSize!==void 0?this._m_headerSize:(this._debug._m_headerSize={},this._m_headerSize=this.hasAdd?11:7,this._m_headerSize)}}),e})(),f=o.BlockFileHeader=(function(){function e(i,a,h){this._io=i,this._parent=a,this._root=h,this._debug={},this._read()}return e.prototype._read=function(){this._debug.lowUnpSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.lowUnpSize=this._io.readU4le(),this._debug.lowUnpSize.end=this._io.pos,this._debug.hostOs={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Rar.Oses"},this.hostOs=this._io.readU1(),this._debug.hostOs.end=this._io.pos,this._debug.fileCrc32={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileCrc32=this._io.readU4le(),this._debug.fileCrc32.end=this._io.pos,this._debug.fileTime={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_fileTime=this._io.readBytes(4);var i=new s(this._raw_fileTime);this.fileTime=new d.DosDatetime(i,null,null),this._debug.fileTime.end=this._io.pos,this._debug.rarVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.rarVersion=this._io.readU1(),this._debug.rarVersion.end=this._io.pos,this._debug.method={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Rar.Methods"},this.method=this._io.readU1(),this._debug.method.end=this._io.pos,this._debug.nameSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.nameSize=this._io.readU2le(),this._debug.nameSize.end=this._io.pos,this._debug.attr={start:this._io.pos,ioOffset:this._io.byteOffset},this.attr=this._io.readU4le(),this._debug.attr.end=this._io.pos,(this._parent.flags&256)!=0&&(this._debug.highPackSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.highPackSize=this._io.readU4le(),this._debug.highPackSize.end=this._io.pos),this._debug.fileName={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileName=this._io.readBytes(this.nameSize),this._debug.fileName.end=this._io.pos,(this._parent.flags&1024)!=0&&(this._debug.salt={start:this._io.pos,ioOffset:this._io.byteOffset},this.salt=this._io.readU8le(),this._debug.salt.end=this._io.pos)},e})(),c=o.BlockV5=(function(){function e(i,a,h){this._io=i,this._parent=a,this._root=h,this._debug={},this._read()}return e.prototype._read=function(){},e})(),l=o.MagicSignature=(function(){function e(i,a,h){this._io=i,this._parent=a,this._root=h,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.magic1={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic1=this._io.readBytes(6),this._debug.magic1.end=this._io.pos,s.byteArrayCompare(this.magic1,new Uint8Array([82,97,114,33,26,7]))!=0){var i=new s.ValidationNotEqualError(new Uint8Array([82,97,114,33,26,7]),this.magic1,this._io,"/types/magic_signature/seq/0");throw this._debug.magic1.validationError=i,i}if(this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU1(),this._debug.version.end=this._io.pos,this.version==1&&(this._debug.magic3={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic3=this._io.readBytes(1),this._debug.magic3.end=this._io.pos,s.byteArrayCompare(this.magic3,new Uint8Array([0]))!=0)){var i=new s.ValidationNotEqualError(new Uint8Array([0]),this.magic3,this._io,"/types/magic_signature/seq/2");throw this._debug.magic3.validationError=i,i}},e})();return o})();t.Rar=_})}});const g=y(),O={id:"rar",title:"RAR (Roshall ARchiver) archive files",ksy:{meta:{id:"rar",title:"RAR (Roshall ARchiver) archive files",application:"RAR archiver","file-extension":"rar",xref:{forensicswiki:"rar",justsolve:"RAR",loc:"fdd000450",mime:["application/vnd.rar","application/x-rar-compressed"],pronom:["x-fmt/264","fmt/411","fmt/613"],wikidata:"Q243303"},license:"CC0-1.0","ks-version":.7,imports:["/common/dos_datetime"],endian:"le"},doc:`RAR is a archive format used by popular proprietary RAR archiver,
created by Eugene Roshal. There are two major versions of format
(v1.5-4.0 and RAR v5+).

File format essentially consists of a linear sequence of
blocks. Each block has fixed header and custom body (that depends on
block type), so it's possible to skip block even if one doesn't know
how to process a certain block type.
`,"doc-ref":"http://acritum.com/winrar/rar-format",seq:[{id:"magic",type:"magic_signature",doc:"File format signature to validate that it is indeed a RAR archive"},{id:"blocks",type:{"switch-on":"magic.version",cases:{0:"block",1:"block_v5"}},repeat:"eos",doc:"Sequence of blocks that constitute the RAR file"}],types:{magic_signature:{doc:`RAR uses either 7-byte magic for RAR versions 1.5 to 4.0, and
8-byte magic (and pretty different block format) for v5+. This
type would parse and validate both versions of signature. Note
that actually this signature is a valid RAR "block": in theory,
one can omit signature reading at all, and read this normally,
as a block, if exact RAR version is known (and thus it's
possible to choose correct block format).
`,seq:[{id:"magic1",contents:["Rar!",26,7],doc:"Fixed part of file's magic signature that doesn't change with RAR version"},{id:"version",type:"u1",doc:`Variable part of magic signature: 0 means old (RAR 1.5-4.0)
format, 1 means new (RAR 5+) format
`},{id:"magic3",contents:[0],if:"version == 1",doc:"New format (RAR 5+) magic contains extra byte"}]},block:{doc:"Basic block that RAR files consist of. There are several block\ntypes (see `block_type`), which have different `body` and\n`add_body`.\n",seq:[{id:"crc16",type:"u2",doc:"CRC16 of whole block or some part of it (depends on block type)"},{id:"block_type",type:"u1",enum:"block_types"},{id:"flags",type:"u2"},{id:"block_size",type:"u2",doc:"Size of block (header + body, but without additional content)"},{id:"add_size",type:"u4",if:"has_add",doc:"Size of additional content in this block"},{id:"body",size:"body_size",type:{"switch-on":"block_type",cases:{"block_types::file_header":"block_file_header"}}},{id:"add_body",size:"add_size",if:"has_add",doc:"Additional content in this block"}],instances:{has_add:{value:"flags & 0x8000 != 0",doc:"True if block has additional content attached to it"},header_size:{value:"has_add ? 11 : 7"},body_size:{value:"block_size - header_size"}}},block_file_header:{seq:[{id:"low_unp_size",type:"u4",doc:"Uncompressed file size (lower 32 bits, if 64-bit header flag is present)"},{id:"host_os",type:"u1",enum:"oses",doc:"Operating system used for archiving"},{id:"file_crc32",type:"u4"},{id:"file_time",size:4,type:"dos_datetime",doc:"Date and time in standard MS DOS format"},{id:"rar_version",type:"u1",doc:"RAR version needed to extract file (Version number is encoded as 10 * Major version + minor version.)"},{id:"method",type:"u1",enum:"methods",doc:"Compression method"},{id:"name_size",type:"u2",doc:"File name size"},{id:"attr",type:"u4",doc:"File attributes"},{id:"high_pack_size",type:"u4",doc:"Compressed file size, high 32 bits, only if 64-bit header flag is present",if:"_parent.flags & 0x100 != 0"},{id:"file_name",size:"name_size"},{id:"salt",type:"u8",if:"_parent.flags & 0x400 != 0"}]},block_v5:{}},enums:{block_types:{114:"marker",115:"archive_header",116:"file_header",117:"old_style_comment_header",118:"old_style_authenticity_info_76",119:"old_style_subblock",120:"old_style_recovery_record",121:"old_style_authenticity_info_79",122:"subblock",123:"terminator"},oses:{0:"ms_dos",1:"os_2",2:"windows",3:"unix",4:"mac_os",5:"beos"},methods:{48:"store",49:"fastest",50:"fast",51:"normal",52:"good",53:"best"}}}};export{g as default,O as spec};
