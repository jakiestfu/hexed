import{k as O}from"./index-ik_lyK6M.js";var v=Object.getOwnPropertyNames,x=(n,h)=>function(){return h||(0,n[v(n)[0]])((h={exports:{}}).exports,h),h.exports},S=x({"<stdin>"(n){(function(h,_){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],_):typeof n=="object"&&n!==null&&typeof n.nodeType!="number"?_(n,O.KaitaiStream):_(h.TlsClientHello||(h.TlsClientHello={}),h.KaitaiStream)})(typeof self<"u"?self:n,function(h,_){var r=(function(){function o(t,s,i){this._io=t,this._parent=s,this._root=i||this,this._debug={},this._read()}o.prototype._read=function(){this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=new m(this._io,this,this._root),this._debug.version.end=this._io.pos,this._debug.random={start:this._io.pos,ioOffset:this._io.byteOffset},this.random=new l(this._io,this,this._root),this._debug.random.end=this._io.pos,this._debug.sessionId={start:this._io.pos,ioOffset:this._io.byteOffset},this.sessionId=new y(this._io,this,this._root),this._debug.sessionId.end=this._io.pos,this._debug.cipherSuites={start:this._io.pos,ioOffset:this._io.byteOffset},this.cipherSuites=new a(this._io,this,this._root),this._debug.cipherSuites.end=this._io.pos,this._debug.compressionMethods={start:this._io.pos,ioOffset:this._io.byteOffset},this.compressionMethods=new p(this._io,this,this._root),this._debug.compressionMethods.end=this._io.pos,this._io.isEof()==!1&&(this._debug.extensions={start:this._io.pos,ioOffset:this._io.byteOffset},this.extensions=new u(this._io,this,this._root),this._debug.extensions.end=this._io.pos)};var d=o.Alpn=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.extLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.extLen=this._io.readU2be(),this._debug.extLen.end=this._io.pos,this._debug.alpnProtocols={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.alpnProtocols.arr=[],this.alpnProtocols=[];!this._io.isEof();)this._debug.alpnProtocols.arr[this.alpnProtocols.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.alpnProtocols.push(new b(this._io,this,this._root)),this._debug.alpnProtocols.arr[this.alpnProtocols.length-1].end=this._io.pos;this._debug.alpnProtocols.end=this._io.pos},t})(),a=o.CipherSuites=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU2be(),this._debug.len.end=this._io.pos,this._debug.cipherSuites={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.cipherSuites.arr=[],this.cipherSuites=[];for(var s=0;s<Math.floor(this.len/2);s++)this._debug.cipherSuites.arr[s]={start:this._io.pos,ioOffset:this._io.byteOffset},this.cipherSuites.push(this._io.readU2be()),this._debug.cipherSuites.arr[s].end=this._io.pos;this._debug.cipherSuites.end=this._io.pos},t})(),p=o.CompressionMethods=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU1(),this._debug.len.end=this._io.pos,this._debug.compressionMethods={start:this._io.pos,ioOffset:this._io.byteOffset},this.compressionMethods=this._io.readBytes(this.len),this._debug.compressionMethods.end=this._io.pos},t})(),f=o.Extension=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=this._io.readU2be(),this._debug.type.end=this._io.pos,this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU2be(),this._debug.len.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.type){case 0:this._raw_body=this._io.readBytes(this.len);var s=new _(this._raw_body);this.body=new c(s,this,this._root);break;case 16:this._raw_body=this._io.readBytes(this.len);var s=new _(this._raw_body);this.body=new d(s,this,this._root);break;default:this.body=this._io.readBytes(this.len);break}this._debug.body.end=this._io.pos},t})(),u=o.Extensions=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU2be(),this._debug.len.end=this._io.pos,this._debug.extensions={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.extensions.arr=[],this.extensions=[];!this._io.isEof();)this._debug.extensions.arr[this.extensions.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.extensions.push(new f(this._io,this,this._root)),this._debug.extensions.arr[this.extensions.length-1].end=this._io.pos;this._debug.extensions.end=this._io.pos},t})(),b=o.Protocol=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.strlen={start:this._io.pos,ioOffset:this._io.byteOffset},this.strlen=this._io.readU1(),this._debug.strlen.end=this._io.pos,this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=this._io.readBytes(this.strlen),this._debug.name.end=this._io.pos},t})(),l=o.Random=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.gmtUnixTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.gmtUnixTime=this._io.readU4be(),this._debug.gmtUnixTime.end=this._io.pos,this._debug.random={start:this._io.pos,ioOffset:this._io.byteOffset},this.random=this._io.readBytes(28),this._debug.random.end=this._io.pos},t})(),g=o.ServerName=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.nameType={start:this._io.pos,ioOffset:this._io.byteOffset},this.nameType=this._io.readU1(),this._debug.nameType.end=this._io.pos,this._debug.length={start:this._io.pos,ioOffset:this._io.byteOffset},this.length=this._io.readU2be(),this._debug.length.end=this._io.pos,this._debug.hostName={start:this._io.pos,ioOffset:this._io.byteOffset},this.hostName=this._io.readBytes(this.length),this._debug.hostName.end=this._io.pos},t})(),y=o.SessionId=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=this._io.readU1(),this._debug.len.end=this._io.pos,this._debug.sid={start:this._io.pos,ioOffset:this._io.byteOffset},this.sid=this._io.readBytes(this.len),this._debug.sid.end=this._io.pos},t})(),c=o.Sni=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.listLength={start:this._io.pos,ioOffset:this._io.byteOffset},this.listLength=this._io.readU2be(),this._debug.listLength.end=this._io.pos,this._debug.serverNames={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.serverNames.arr=[],this.serverNames=[];!this._io.isEof();)this._debug.serverNames.arr[this.serverNames.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.serverNames.push(new g(this._io,this,this._root)),this._debug.serverNames.arr[this.serverNames.length-1].end=this._io.pos;this._debug.serverNames.end=this._io.pos},t})(),m=o.Version=(function(){function t(s,i,e){this._io=s,this._parent=i,this._root=e,this._debug={},this._read()}return t.prototype._read=function(){this._debug.major={start:this._io.pos,ioOffset:this._io.byteOffset},this.major=this._io.readU1(),this._debug.major.end=this._io.pos,this._debug.minor={start:this._io.pos,ioOffset:this._io.byteOffset},this.minor=this._io.readU1(),this._debug.minor.end=this._io.pos},t})();return o})();h.TlsClientHello=r})}});const U=S(),N={id:"tls_client_hello",title:"tls_client_hello",ksy:{meta:{id:"tls_client_hello",xref:{rfc:5246,wikidata:"Q206494"},license:"MIT",endian:"be"},seq:[{id:"version",type:"version"},{id:"random",type:"random"},{id:"session_id",type:"session_id"},{id:"cipher_suites",type:"cipher_suites"},{id:"compression_methods",type:"compression_methods"},{id:"extensions",type:"extensions",if:"_io.eof == false"}],types:{version:{seq:[{id:"major",type:"u1"},{id:"minor",type:"u1"}]},random:{seq:[{id:"gmt_unix_time",type:"u4"},{id:"random",size:28}]},session_id:{seq:[{id:"len",type:"u1"},{id:"sid",size:"len"}]},cipher_suites:{seq:[{id:"len",type:"u2"},{id:"cipher_suites",type:"u2",repeat:"expr","repeat-expr":"len/2"}]},compression_methods:{seq:[{id:"len",type:"u1"},{id:"compression_methods",size:"len"}]},extensions:{seq:[{id:"len",type:"u2"},{id:"extensions",type:"extension",repeat:"eos"}]},extension:{seq:[{id:"type",type:"u2"},{id:"len",type:"u2"},{id:"body",size:"len",type:{"switch-on":"type",cases:{0:"sni",16:"alpn"}}}]},sni:{seq:[{id:"list_length",type:"u2"},{id:"server_names",type:"server_name",repeat:"eos"}]},server_name:{seq:[{id:"name_type",type:"u1"},{id:"length",type:"u2"},{id:"host_name",size:"length"}]},alpn:{seq:[{id:"ext_len",type:"u2"},{id:"alpn_protocols",type:"protocol",repeat:"eos"}]},protocol:{seq:[{id:"strlen",type:"u1"},{id:"name",size:"strlen"}]}}}};export{U as default,N as spec};
