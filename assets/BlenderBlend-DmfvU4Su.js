import{k as c}from"./index-C9sUxlHS.js";var y=Object.getOwnPropertyNames,b=(d,n)=>function(){return n||(0,d[y(d)[0]])((n={exports:{}}).exports,n),n.exports},l=b({"<stdin>"(d){(function(n,i){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],i):typeof d=="object"&&d!==null&&typeof d.nodeType!="number"?i(d,c.KaitaiStream):i(n.BlenderBlend||(n.BlenderBlend={}),n.KaitaiStream)})(typeof self<"u"?self:d,function(n,i){var h=(function(){o.Endian=Object.freeze({BE:86,LE:118,86:"BE",118:"LE"}),o.PtrSize=Object.freeze({BITS_64:45,BITS_32:95,45:"BITS_64",95:"BITS_32"});function o(s,t,e){this._io=s,this._parent=t,this._root=e||this,this._debug={},this._read()}o.prototype._read=function(){for(this._debug.hdr={start:this._io.pos,ioOffset:this._io.byteOffset},this.hdr=new f(this._io,this,this._root),this._debug.hdr.end=this._io.pos,this._debug.blocks={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.blocks.arr=[],this.blocks=[];!this._io.isEof();)this._debug.blocks.arr[this.blocks.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.blocks.push(new u(this._io,this,this._root)),this._debug.blocks.arr[this.blocks.length-1].end=this._io.pos;this._debug.blocks.end=this._io.pos};var _=o.Dna1Body=(function(){function s(t,e,r){this._io=t,this._parent=e,this._root=r,this._debug={},this._read()}return s.prototype._read=function(){if(this._debug.id={start:this._io.pos,ioOffset:this._io.byteOffset},this.id=this._io.readBytes(4),this._debug.id.end=this._io.pos,i.byteArrayCompare(this.id,new Uint8Array([83,68,78,65]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([83,68,78,65]),this.id,this._io,"/types/dna1_body/seq/0");throw this._debug.id.validationError=t,t}if(this._debug.nameMagic={start:this._io.pos,ioOffset:this._io.byteOffset},this.nameMagic=this._io.readBytes(4),this._debug.nameMagic.end=this._io.pos,i.byteArrayCompare(this.nameMagic,new Uint8Array([78,65,77,69]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([78,65,77,69]),this.nameMagic,this._io,"/types/dna1_body/seq/1");throw this._debug.nameMagic.validationError=t,t}this._debug.numNames={start:this._io.pos,ioOffset:this._io.byteOffset},this.numNames=this._io.readU4le(),this._debug.numNames.end=this._io.pos,this._debug.names={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.names.arr=[],this.names=[];for(var e=0;e<this.numNames;e++)this._debug.names.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.names.push(i.bytesToStr(this._io.readBytesTerm(0,!1,!0,!0),"UTF-8")),this._debug.names.arr[e].end=this._io.pos;if(this._debug.names.end=this._io.pos,this._debug.padding1={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding1=this._io.readBytes(i.mod(4-this._io.pos,4)),this._debug.padding1.end=this._io.pos,this._debug.typeMagic={start:this._io.pos,ioOffset:this._io.byteOffset},this.typeMagic=this._io.readBytes(4),this._debug.typeMagic.end=this._io.pos,i.byteArrayCompare(this.typeMagic,new Uint8Array([84,89,80,69]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([84,89,80,69]),this.typeMagic,this._io,"/types/dna1_body/seq/5");throw this._debug.typeMagic.validationError=t,t}this._debug.numTypes={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTypes=this._io.readU4le(),this._debug.numTypes.end=this._io.pos,this._debug.types={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.types.arr=[],this.types=[];for(var e=0;e<this.numTypes;e++)this._debug.types.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.types.push(i.bytesToStr(this._io.readBytesTerm(0,!1,!0,!0),"UTF-8")),this._debug.types.arr[e].end=this._io.pos;if(this._debug.types.end=this._io.pos,this._debug.padding2={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding2=this._io.readBytes(i.mod(4-this._io.pos,4)),this._debug.padding2.end=this._io.pos,this._debug.tlenMagic={start:this._io.pos,ioOffset:this._io.byteOffset},this.tlenMagic=this._io.readBytes(4),this._debug.tlenMagic.end=this._io.pos,i.byteArrayCompare(this.tlenMagic,new Uint8Array([84,76,69,78]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([84,76,69,78]),this.tlenMagic,this._io,"/types/dna1_body/seq/9");throw this._debug.tlenMagic.validationError=t,t}this._debug.lengths={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.lengths.arr=[],this.lengths=[];for(var e=0;e<this.numTypes;e++)this._debug.lengths.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.lengths.push(this._io.readU2le()),this._debug.lengths.arr[e].end=this._io.pos;if(this._debug.lengths.end=this._io.pos,this._debug.padding3={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding3=this._io.readBytes(i.mod(4-this._io.pos,4)),this._debug.padding3.end=this._io.pos,this._debug.strcMagic={start:this._io.pos,ioOffset:this._io.byteOffset},this.strcMagic=this._io.readBytes(4),this._debug.strcMagic.end=this._io.pos,i.byteArrayCompare(this.strcMagic,new Uint8Array([83,84,82,67]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([83,84,82,67]),this.strcMagic,this._io,"/types/dna1_body/seq/12");throw this._debug.strcMagic.validationError=t,t}this._debug.numStructs={start:this._io.pos,ioOffset:this._io.byteOffset},this.numStructs=this._io.readU4le(),this._debug.numStructs.end=this._io.pos,this._debug.structs={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.structs.arr=[],this.structs=[];for(var e=0;e<this.numStructs;e++)this._debug.structs.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.structs.push(new p(this._io,this,this._root)),this._debug.structs.arr[e].end=this._io.pos;this._debug.structs.end=this._io.pos},s})(),a=o.DnaField=(function(){function s(t,e,r){this._io=t,this._parent=e,this._root=r,this._debug={},this._read()}return s.prototype._read=function(){this._debug.idxType={start:this._io.pos,ioOffset:this._io.byteOffset},this.idxType=this._io.readU2le(),this._debug.idxType.end=this._io.pos,this._debug.idxName={start:this._io.pos,ioOffset:this._io.byteOffset},this.idxName=this._io.readU2le(),this._debug.idxName.end=this._io.pos},Object.defineProperty(s.prototype,"name",{get:function(){return this._m_name!==void 0?this._m_name:(this._debug._m_name={},this._m_name=this._parent._parent.names[this.idxName],this._m_name)}}),Object.defineProperty(s.prototype,"type",{get:function(){return this._m_type!==void 0?this._m_type:(this._debug._m_type={},this._m_type=this._parent._parent.types[this.idxType],this._m_type)}}),s})(),p=o.DnaStruct=(function(){function s(t,e,r){this._io=t,this._parent=e,this._root=r,this._debug={},this._read()}return s.prototype._read=function(){this._debug.idxType={start:this._io.pos,ioOffset:this._io.byteOffset},this.idxType=this._io.readU2le(),this._debug.idxType.end=this._io.pos,this._debug.numFields={start:this._io.pos,ioOffset:this._io.byteOffset},this.numFields=this._io.readU2le(),this._debug.numFields.end=this._io.pos,this._debug.fields={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.fields.arr=[],this.fields=[];for(var t=0;t<this.numFields;t++)this._debug.fields.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.fields.push(new a(this._io,this,this._root)),this._debug.fields.arr[t].end=this._io.pos;this._debug.fields.end=this._io.pos},Object.defineProperty(s.prototype,"type",{get:function(){return this._m_type!==void 0?this._m_type:(this._debug._m_type={},this._m_type=this._parent.types[this.idxType],this._m_type)}}),s})(),u=o.FileBlock=(function(){function s(t,e,r){this._io=t,this._parent=e,this._root=r,this._debug={},this._read()}return s.prototype._read=function(){switch(this._debug.code={start:this._io.pos,ioOffset:this._io.byteOffset},this.code=i.bytesToStr(this._io.readBytes(4),"ASCII"),this._debug.code.end=this._io.pos,this._debug.lenBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenBody=this._io.readU4le(),this._debug.lenBody.end=this._io.pos,this._debug.memAddr={start:this._io.pos,ioOffset:this._io.byteOffset},this.memAddr=this._io.readBytes(this._root.hdr.psize),this._debug.memAddr.end=this._io.pos,this._debug.sdnaIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.sdnaIndex=this._io.readU4le(),this._debug.sdnaIndex.end=this._io.pos,this._debug.count={start:this._io.pos,ioOffset:this._io.byteOffset},this.count=this._io.readU4le(),this._debug.count.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.code){case"DNA1":this._raw_body=this._io.readBytes(this.lenBody);var t=new i(this._raw_body);this.body=new _(t,this,this._root);break;default:this.body=this._io.readBytes(this.lenBody);break}this._debug.body.end=this._io.pos},Object.defineProperty(s.prototype,"sdnaStruct",{get:function(){return this._m_sdnaStruct!==void 0?this._m_sdnaStruct:(this.sdnaIndex!=0&&(this._debug._m_sdnaStruct={},this._m_sdnaStruct=this._root.sdnaStructs[this.sdnaIndex]),this._m_sdnaStruct)}}),s})(),f=o.Header=(function(){function s(t,e,r){this._io=t,this._parent=e,this._root=r,this._debug={},this._read()}return s.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(7),this._debug.magic.end=this._io.pos,i.byteArrayCompare(this.magic,new Uint8Array([66,76,69,78,68,69,82]))!=0){var t=new i.ValidationNotEqualError(new Uint8Array([66,76,69,78,68,69,82]),this.magic,this._io,"/types/header/seq/0");throw this._debug.magic.validationError=t,t}this._debug.ptrSizeId={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"BlenderBlend.PtrSize"},this.ptrSizeId=this._io.readU1(),this._debug.ptrSizeId.end=this._io.pos,this._debug.endian={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"BlenderBlend.Endian"},this.endian=this._io.readU1(),this._debug.endian.end=this._io.pos,this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=i.bytesToStr(this._io.readBytes(3),"ASCII"),this._debug.version.end=this._io.pos},Object.defineProperty(s.prototype,"psize",{get:function(){return this._m_psize!==void 0?this._m_psize:(this._debug._m_psize={},this._m_psize=this.ptrSizeId==o.PtrSize.BITS_64?8:4,this._m_psize)}}),s})();return Object.defineProperty(o.prototype,"sdnaStructs",{get:function(){return this._m_sdnaStructs!==void 0?this._m_sdnaStructs:(this._debug._m_sdnaStructs={},this._m_sdnaStructs=this.blocks[this.blocks.length-2].body.structs,this._m_sdnaStructs)}}),o})();n.BlenderBlend=h})}});const m=l(),O={id:"blender_blend",title:"blender_blend",ksy:{meta:{id:"blender_blend",application:"Blender","file-extension":"blend",xref:{justsolve:"BLEND",mime:"application/x-blender",pronom:["fmt/902","fmt/903"],wikidata:"Q15671948"},license:"CC0-1.0",endian:"le"},doc:`Blender is an open source suite for 3D modelling, sculpting,
animation, compositing, rendering, preparation of assets for its own
game engine and exporting to others, etc. \`.blend\` is its own binary
format that saves whole state of suite: current scene, animations,
all software settings, extensions, etc.

Internally, .blend format is a hybrid semi-self-descriptive
format. On top level, it contains a simple header and a sequence of
file blocks, which more or less follow typical [TLV
pattern](https://en.wikipedia.org/wiki/Type-length-value). Pre-last
block would be a structure with code \`DNA1\`, which is a essentially
a machine-readable schema of all other structures used in this file.
`,seq:[{id:"hdr",type:"header"},{id:"blocks",type:"file_block",repeat:"eos"}],instances:{sdna_structs:{value:"blocks[blocks.size - 2].body.as<dna1_body>.structs"}},types:{header:{seq:[{id:"magic",contents:"BLENDER"},{id:"ptr_size_id",type:"u1",enum:"ptr_size",doc:"Size of a pointer; all pointers in the file are stored in this format"},{id:"endian",type:"u1",doc:"Type of byte ordering used",enum:"endian"},{id:"version",type:"str",size:3,encoding:"ASCII",doc:"Blender version used to save this file"}],instances:{psize:{value:"ptr_size_id == ptr_size::bits_64 ? 8 : 4",doc:"Number of bytes that a pointer occupies"}}},file_block:{seq:[{id:"code",type:"str",size:4,encoding:"ASCII",doc:"Identifier of the file block"},{id:"len_body",type:"u4",doc:"Total length of the data after the header of file block"},{id:"mem_addr",size:"_root.hdr.psize",doc:"Memory address the structure was located when written to disk"},{id:"sdna_index",type:"u4",doc:"Index of the SDNA structure"},{id:"count",type:"u4",doc:"Number of structure located in this file-block"},{id:"body",size:"len_body",type:{"switch-on":"code",cases:{'"DNA1"':"dna1_body"}}}],instances:{sdna_struct:{value:"_root.sdna_structs[sdna_index]",if:"sdna_index != 0"}}},dna1_body:{doc:`DNA1, also known as "Structure DNA", is a special block in
.blend file, which contains machine-readable specifications of
all other structures used in this .blend file.

Effectively, this block contains:

* a sequence of "names" (strings which represent field names)
* a sequence of "types" (strings which represent type name)
* a sequence of "type lengths"
* a sequence of "structs" (which describe contents of every
  structure, referring to types and names by index)
`,"doc-ref":"https://archive.blender.org/wiki/index.php/Dev:Source/Architecture/File_Format/#Structure_DNA",seq:[{id:"id",contents:"SDNA"},{id:"name_magic",contents:"NAME"},{id:"num_names",type:"u4"},{id:"names",type:"strz",encoding:"UTF-8",repeat:"expr","repeat-expr":"num_names"},{id:"padding_1",size:"(4 - _io.pos) % 4"},{id:"type_magic",contents:"TYPE"},{id:"num_types",type:"u4"},{id:"types",type:"strz",encoding:"UTF-8",repeat:"expr","repeat-expr":"num_types"},{id:"padding_2",size:"(4 - _io.pos) % 4"},{id:"tlen_magic",contents:"TLEN"},{id:"lengths",type:"u2",repeat:"expr","repeat-expr":"num_types"},{id:"padding_3",size:"(4 - _io.pos) % 4"},{id:"strc_magic",contents:"STRC"},{id:"num_structs",type:"u4"},{id:"structs",type:"dna_struct",repeat:"expr","repeat-expr":"num_structs"}]},dna_struct:{doc:"DNA struct contains a `type` (type name), which is specified as\nan index in types table, and sequence of fields.\n",seq:[{id:"idx_type",type:"u2"},{id:"num_fields",type:"u2"},{id:"fields",type:"dna_field",repeat:"expr","repeat-expr":"num_fields"}],instances:{type:{value:"_parent.types[idx_type]"}}},dna_field:{seq:[{id:"idx_type",type:"u2"},{id:"idx_name",type:"u2"}],instances:{type:{value:"_parent._parent.types[idx_type]"},name:{value:"_parent._parent.names[idx_name]"}}}},enums:{ptr_size:{45:"bits_64",95:"bits_32"},endian:{86:"be",118:"le"}}}};export{m as default,O as spec};
