import{k as b}from"./index-COmSdSC_.js";var p=Object.getOwnPropertyNames,u=(_,o)=>function(){return o||(0,_[p(_)[0]])((o={exports:{}}).exports,o),o.exports},c=u({"<stdin>"(_){(function(o,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof _=="object"&&_!==null&&typeof _.nodeType!="number"?s(_,b.KaitaiStream):s(o.MicrosoftCfb||(o.MicrosoftCfb={}),o.KaitaiStream)})(typeof self<"u"?self:_,function(o,s){var d=(function(){function r(i,t,e){this._io=i,this._parent=t,this._root=e||this,this._debug={},this._read()}r.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new f(this._io,this,this._root),this._debug.header.end=this._io.pos};var f=r.CfbHeader=(function(){function i(t,e,h){this._io=t,this._parent=e,this._root=h,this._debug={},this._read()}return i.prototype._read=function(){if(this._debug.signature={start:this._io.pos,ioOffset:this._io.byteOffset},this.signature=this._io.readBytes(8),this._debug.signature.end=this._io.pos,s.byteArrayCompare(this.signature,new Uint8Array([208,207,17,224,161,177,26,225]))!=0){var t=new s.ValidationNotEqualError(new Uint8Array([208,207,17,224,161,177,26,225]),this.signature,this._io,"/types/cfb_header/seq/0");throw this._debug.signature.validationError=t,t}if(this._debug.clsid={start:this._io.pos,ioOffset:this._io.byteOffset},this.clsid=this._io.readBytes(16),this._debug.clsid.end=this._io.pos,s.byteArrayCompare(this.clsid,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))!=0){var t=new s.ValidationNotEqualError(new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.clsid,this._io,"/types/cfb_header/seq/1");throw this._debug.clsid.validationError=t,t}if(this._debug.versionMinor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMinor=this._io.readU2le(),this._debug.versionMinor.end=this._io.pos,this._debug.versionMajor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMajor=this._io.readU2le(),this._debug.versionMajor.end=this._io.pos,this._debug.byteOrder={start:this._io.pos,ioOffset:this._io.byteOffset},this.byteOrder=this._io.readBytes(2),this._debug.byteOrder.end=this._io.pos,s.byteArrayCompare(this.byteOrder,new Uint8Array([254,255]))!=0){var t=new s.ValidationNotEqualError(new Uint8Array([254,255]),this.byteOrder,this._io,"/types/cfb_header/seq/4");throw this._debug.byteOrder.validationError=t,t}this._debug.sectorShift={start:this._io.pos,ioOffset:this._io.byteOffset},this.sectorShift=this._io.readU2le(),this._debug.sectorShift.end=this._io.pos,this._debug.miniSectorShift={start:this._io.pos,ioOffset:this._io.byteOffset},this.miniSectorShift=this._io.readU2le(),this._debug.miniSectorShift.end=this._io.pos,this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBytes(6),this._debug.reserved1.end=this._io.pos,this._debug.sizeDir={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeDir=this._io.readS4le(),this._debug.sizeDir.end=this._io.pos,this._debug.sizeFat={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeFat=this._io.readS4le(),this._debug.sizeFat.end=this._io.pos,this._debug.ofsDir={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsDir=this._io.readS4le(),this._debug.ofsDir.end=this._io.pos,this._debug.transactionSeq={start:this._io.pos,ioOffset:this._io.byteOffset},this.transactionSeq=this._io.readS4le(),this._debug.transactionSeq.end=this._io.pos,this._debug.miniStreamCutoffSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.miniStreamCutoffSize=this._io.readS4le(),this._debug.miniStreamCutoffSize.end=this._io.pos,this._debug.ofsMiniFat={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsMiniFat=this._io.readS4le(),this._debug.ofsMiniFat.end=this._io.pos,this._debug.sizeMiniFat={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeMiniFat=this._io.readS4le(),this._debug.sizeMiniFat.end=this._io.pos,this._debug.ofsDifat={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsDifat=this._io.readS4le(),this._debug.ofsDifat.end=this._io.pos,this._debug.sizeDifat={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeDifat=this._io.readS4le(),this._debug.sizeDifat.end=this._io.pos,this._debug.difat={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.difat.arr=[],this.difat=[];for(var e=0;e<109;e++)this._debug.difat.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.difat.push(this._io.readS4le()),this._debug.difat.arr[e].end=this._io.pos;this._debug.difat.end=this._io.pos},i})(),n=r.DirEntry=(function(){i.ObjType=Object.freeze({UNKNOWN:0,STORAGE:1,STREAM:2,ROOT_STORAGE:5,0:"UNKNOWN",1:"STORAGE",2:"STREAM",5:"ROOT_STORAGE"}),i.RbColor=Object.freeze({RED:0,BLACK:1,0:"RED",1:"BLACK"});function i(t,e,h){this._io=t,this._parent=e,this._root=h,this._debug={},this._read()}return i.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=s.bytesToStr(this._io.readBytes(64),"UTF-16LE"),this._debug.name.end=this._io.pos,this._debug.nameLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.nameLen=this._io.readU2le(),this._debug.nameLen.end=this._io.pos,this._debug.objectType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftCfb.DirEntry.ObjType"},this.objectType=this._io.readU1(),this._debug.objectType.end=this._io.pos,this._debug.colorFlag={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftCfb.DirEntry.RbColor"},this.colorFlag=this._io.readU1(),this._debug.colorFlag.end=this._io.pos,this._debug.leftSiblingId={start:this._io.pos,ioOffset:this._io.byteOffset},this.leftSiblingId=this._io.readS4le(),this._debug.leftSiblingId.end=this._io.pos,this._debug.rightSiblingId={start:this._io.pos,ioOffset:this._io.byteOffset},this.rightSiblingId=this._io.readS4le(),this._debug.rightSiblingId.end=this._io.pos,this._debug.childId={start:this._io.pos,ioOffset:this._io.byteOffset},this.childId=this._io.readS4le(),this._debug.childId.end=this._io.pos,this._debug.clsid={start:this._io.pos,ioOffset:this._io.byteOffset},this.clsid=this._io.readBytes(16),this._debug.clsid.end=this._io.pos,this._debug.state={start:this._io.pos,ioOffset:this._io.byteOffset},this.state=this._io.readU4le(),this._debug.state.end=this._io.pos,this._debug.timeCreate={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeCreate=this._io.readU8le(),this._debug.timeCreate.end=this._io.pos,this._debug.timeMod={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeMod=this._io.readU8le(),this._debug.timeMod.end=this._io.pos,this._debug.ofs={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofs=this._io.readS4le(),this._debug.ofs.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readU8le(),this._debug.size.end=this._io.pos},Object.defineProperty(i.prototype,"child",{get:function(){if(this._m_child!==void 0)return this._m_child;if(this.childId!=-1){var t=this._root._io,e=t.pos;t.seek((this._root.header.ofsDir+1)*this._root.sectorSize+this.childId*128),this._debug._m_child={start:t.pos,ioOffset:t.byteOffset},this._m_child=new i(t,this,this._root),this._debug._m_child.end=t.pos,t.seek(e)}return this._m_child}}),Object.defineProperty(i.prototype,"leftSibling",{get:function(){if(this._m_leftSibling!==void 0)return this._m_leftSibling;if(this.leftSiblingId!=-1){var t=this._root._io,e=t.pos;t.seek((this._root.header.ofsDir+1)*this._root.sectorSize+this.leftSiblingId*128),this._debug._m_leftSibling={start:t.pos,ioOffset:t.byteOffset},this._m_leftSibling=new i(t,this,this._root),this._debug._m_leftSibling.end=t.pos,t.seek(e)}return this._m_leftSibling}}),Object.defineProperty(i.prototype,"miniStream",{get:function(){if(this._m_miniStream!==void 0)return this._m_miniStream;if(this.objectType==r.DirEntry.ObjType.ROOT_STORAGE){var t=this._root._io,e=t.pos;t.seek((this.ofs+1)*this._root.sectorSize),this._debug._m_miniStream={start:t.pos,ioOffset:t.byteOffset},this._m_miniStream=t.readBytes(this.size),this._debug._m_miniStream.end=t.pos,t.seek(e)}return this._m_miniStream}}),Object.defineProperty(i.prototype,"rightSibling",{get:function(){if(this._m_rightSibling!==void 0)return this._m_rightSibling;if(this.rightSiblingId!=-1){var t=this._root._io,e=t.pos;t.seek((this._root.header.ofsDir+1)*this._root.sectorSize+this.rightSiblingId*128),this._debug._m_rightSibling={start:t.pos,ioOffset:t.byteOffset},this._m_rightSibling=new i(t,this,this._root),this._debug._m_rightSibling.end=t.pos,t.seek(e)}return this._m_rightSibling}}),i})(),a=r.FatEntries=(function(){function i(t,e,h){this._io=t,this._parent=e,this._root=h,this._debug={},this._read()}return i.prototype._read=function(){for(this._debug.entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.entries.arr=[],this.entries=[];!this._io.isEof();)this._debug.entries.arr[this.entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.entries.push(this._io.readS4le()),this._debug.entries.arr[this.entries.length-1].end=this._io.pos;this._debug.entries.end=this._io.pos},i})();return Object.defineProperty(r.prototype,"dir",{get:function(){if(this._m_dir!==void 0)return this._m_dir;var i=this._io.pos;return this._io.seek((this.header.ofsDir+1)*this.sectorSize),this._debug._m_dir={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_dir=new n(this._io,this,this._root),this._debug._m_dir.end=this._io.pos,this._io.seek(i),this._m_dir}}),Object.defineProperty(r.prototype,"fat",{get:function(){if(this._m_fat!==void 0)return this._m_fat;var i=this._io.pos;this._io.seek(this.sectorSize),this._debug._m_fat={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_fat=this._io.readBytes(this.header.sizeFat*this.sectorSize);var t=new s(this._raw__m_fat);return this._m_fat=new a(t,this,this._root),this._debug._m_fat.end=this._io.pos,this._io.seek(i),this._m_fat}}),Object.defineProperty(r.prototype,"sectorSize",{get:function(){return this._m_sectorSize!==void 0?this._m_sectorSize:(this._debug._m_sectorSize={},this._m_sectorSize=1<<this.header.sectorShift,this._m_sectorSize)}}),r})();o.MicrosoftCfb=d})}});const y=c(),l={id:"microsoft_cfb",title:"Microsoft Compound File Binary (CFB), AKA OLE (Object Linking and Embedding) file format",ksy:{meta:{id:"microsoft_cfb",title:"Microsoft Compound File Binary (CFB), AKA OLE (Object Linking and Embedding) file format",xref:{justsolve:"Microsoft_Compound_File",loc:["fdd000380","fdd000392"],wikidata:"Q5156830"},license:"CC0-1.0",endian:"le"},seq:[{id:"header",type:"cfb_header"}],instances:{sector_size:{value:"1 << header.sector_shift"},fat:{pos:"sector_size",size:"header.size_fat * sector_size",type:"fat_entries"},dir:{pos:"(header.ofs_dir + 1) * sector_size",type:"dir_entry"}},types:{cfb_header:{seq:[{id:"signature",contents:[208,207,17,224,161,177,26,225],doc:"Magic bytes that confirm that this is a CFB file"},{id:"clsid",contents:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],doc:"Reserved class ID field, must be all 0"},{id:"version_minor",type:"u2"},{id:"version_major",type:"u2"},{id:"byte_order",contents:[254,255],doc:"In theory, specifies a byte order. In practice, no other values besides FE FF (which imply little endian order) are used."},{id:"sector_shift",type:"u2",doc:"For major version 3, must be 0x9 (sector size = 512 bytes). For major version 4, must be 0xc (sector size = 4096 bytes)."},{id:"mini_sector_shift",type:"u2"},{id:"reserved1",size:6},{id:"size_dir",type:"s4",doc:"Number of directory sectors in this file. For major version 3, must be 0."},{id:"size_fat",type:"s4",doc:"Number of FAT sectors in this file."},{id:"ofs_dir",type:"s4",doc:"Starting sector number for directory stream."},{id:"transaction_seq",type:"s4",doc:"A transaction sequence number, which is incremented each time the file is saved if transactions are implemented, 0 otherwise."},{id:"mini_stream_cutoff_size",type:"s4"},{id:"ofs_mini_fat",type:"s4",doc:"Starting sector number for mini FAT."},{id:"size_mini_fat",type:"s4",doc:"Number of mini FAT sectors in this file."},{id:"ofs_difat",type:"s4",doc:"Starting sector number for DIFAT."},{id:"size_difat",type:"s4",doc:"Number of DIFAT sectors in this file."},{id:"difat",repeat:"expr","repeat-expr":109,type:"s4"}]},fat_entries:{seq:[{id:"entries",type:"s4",repeat:"eos"}]},dir_entry:{seq:[{id:"name",type:"str",size:64,encoding:"UTF-16LE"},{id:"name_len",type:"u2"},{id:"object_type",type:"u1",enum:"obj_type"},{id:"color_flag",type:"u1",enum:"rb_color"},{id:"left_sibling_id",type:"s4"},{id:"right_sibling_id",type:"s4"},{id:"child_id",type:"s4"},{id:"clsid",size:16},{id:"state",type:"u4",doc:"User-defined flags for storage or root storage objects"},{id:"time_create",type:"u8",doc:"Creation time, in Windows FILETIME format (number of 100-nanosecond intervals since January 1, 1601, UTC)"},{id:"time_mod",type:"u8",doc:"Modification time, in Windows FILETIME format (number of 100-nanosecond intervals since January 1, 1601, UTC)."},{id:"ofs",type:"s4",doc:"For stream object, number of starting sector. For a root storage object, first sector of the mini stream, if the mini stream exists."},{id:"size",type:"u8",doc:"For stream object, size of user-defined data in bytes. For a root storage object, size of the mini stream."}],instances:{mini_stream:{io:"_root._io",pos:"(ofs + 1) * _root.sector_size",size:"size",if:"object_type == obj_type::root_storage"},child:{io:"_root._io",pos:"(_root.header.ofs_dir + 1) * _root.sector_size + child_id * 0x80",type:"dir_entry",if:"child_id != -1"},left_sibling:{io:"_root._io",pos:"(_root.header.ofs_dir + 1) * _root.sector_size + left_sibling_id * 0x80",type:"dir_entry",if:"left_sibling_id != -1"},right_sibling:{io:"_root._io",pos:"(_root.header.ofs_dir + 1) * _root.sector_size + right_sibling_id * 0x80",type:"dir_entry",if:"right_sibling_id != -1"}},enums:{obj_type:{0:"unknown",1:"storage",2:"stream",5:"root_storage"},rb_color:{0:"red",1:"black"}}}}}};export{y as default,l as spec};
