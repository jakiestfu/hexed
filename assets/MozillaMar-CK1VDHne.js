import{k as p}from"./index-COA_x_BK.js";var g=Object.getOwnPropertyNames,c=(_,r)=>function(){return r||(0,_[g(_)[0]])((r={exports:{}}).exports,r),r.exports},y=c({"<stdin>"(_){(function(r,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof _=="object"&&_!==null&&typeof _.nodeType!="number"?s(_,p.KaitaiStream):s(r.MozillaMar||(r.MozillaMar={}),r.KaitaiStream)})(typeof self<"u"?self:_,function(r,s){var d=(function(){o.BlockIdentifiers=Object.freeze({PRODUCT_INFORMATION:1,1:"PRODUCT_INFORMATION"}),o.SignatureAlgorithms=Object.freeze({RSA_PKCS1_SHA1:1,RSA_PKCS1_SHA384:2,1:"RSA_PKCS1_SHA1",2:"RSA_PKCS1_SHA384"});function o(t,i,e){this._io=t,this._parent=i,this._root=e||this,this._debug={},this._read()}o.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,s.byteArrayCompare(this.magic,new Uint8Array([77,65,82,49]))!=0){var t=new s.ValidationNotEqualError(new Uint8Array([77,65,82,49]),this.magic,this._io,"/seq/0");throw this._debug.magic.validationError=t,t}this._debug.ofsIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsIndex=this._io.readU4be(),this._debug.ofsIndex.end=this._io.pos,this._debug.fileSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileSize=this._io.readU8be(),this._debug.fileSize.end=this._io.pos,this._debug.lenSignatures={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenSignatures=this._io.readU4be(),this._debug.lenSignatures.end=this._io.pos,this._debug.signatures={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.signatures.arr=[],this.signatures=[];for(var i=0;i<this.lenSignatures;i++)this._debug.signatures.arr[i]={start:this._io.pos,ioOffset:this._io.byteOffset},this.signatures.push(new b(this._io,this,this._root)),this._debug.signatures.arr[i].end=this._io.pos;this._debug.signatures.end=this._io.pos,this._debug.lenAdditionalSections={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenAdditionalSections=this._io.readU4be(),this._debug.lenAdditionalSections.end=this._io.pos,this._debug.additionalSections={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.additionalSections.arr=[],this.additionalSections=[];for(var i=0;i<this.lenAdditionalSections;i++)this._debug.additionalSections.arr[i]={start:this._io.pos,ioOffset:this._io.byteOffset},this.additionalSections.push(new h(this._io,this,this._root)),this._debug.additionalSections.arr[i].end=this._io.pos;this._debug.additionalSections.end=this._io.pos};var h=o.AdditionalSection=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.lenBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenBlock=this._io.readU4be(),this._debug.lenBlock.end=this._io.pos,this._debug.blockIdentifier={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MozillaMar.BlockIdentifiers"},this.blockIdentifier=this._io.readU4be(),this._debug.blockIdentifier.end=this._io.pos,this._debug.bytes={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockIdentifier){case o.BlockIdentifiers.PRODUCT_INFORMATION:this._raw_bytes=this._io.readBytes(this.lenBlock-4-4);var i=new s(this._raw_bytes);this.bytes=new l(i,this,this._root);break;default:this.bytes=this._io.readBytes(this.lenBlock-4-4);break}this._debug.bytes.end=this._io.pos},t})(),a=o.IndexEntries=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.indexEntry={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.indexEntry.arr=[],this.indexEntry=[];!this._io.isEof();)this._debug.indexEntry.arr[this.indexEntry.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.indexEntry.push(new f(this._io,this,this._root)),this._debug.indexEntry.arr[this.indexEntry.length-1].end=this._io.pos;this._debug.indexEntry.end=this._io.pos},t})(),f=o.IndexEntry=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){this._debug.ofsContent={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsContent=this._io.readU4be(),this._debug.ofsContent.end=this._io.pos,this._debug.lenContent={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenContent=this._io.readU4be(),this._debug.lenContent.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=this._io.readU4be(),this._debug.flags.end=this._io.pos,this._debug.fileName={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileName=s.bytesToStr(this._io.readBytesTerm(0,!1,!0,!0),"UTF-8"),this._debug.fileName.end=this._io.pos},Object.defineProperty(t.prototype,"body",{get:function(){if(this._m_body!==void 0)return this._m_body;var i=this._root._io,e=i.pos;return i.seek(this.ofsContent),this._debug._m_body={start:i.pos,ioOffset:i.byteOffset},this._m_body=i.readBytes(this.lenContent),this._debug._m_body.end=i.pos,i.seek(e),this._m_body}}),t})(),u=o.MarIndex=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){this._debug.lenIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenIndex=this._io.readU4be(),this._debug.lenIndex.end=this._io.pos,this._debug.indexEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_indexEntries=this._io.readBytes(this.lenIndex);var i=new s(this._raw_indexEntries);this.indexEntries=new a(i,this,this._root),this._debug.indexEntries.end=this._io.pos},t})(),l=o.ProductInformationBlock=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){this._debug.marChannelName={start:this._io.pos,ioOffset:this._io.byteOffset},this.marChannelName=s.bytesToStr(s.bytesTerminate(this._io.readBytes(64),0,!1),"UTF-8"),this._debug.marChannelName.end=this._io.pos,this._debug.productVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.productVersion=s.bytesToStr(s.bytesTerminate(this._io.readBytes(32),0,!1),"UTF-8"),this._debug.productVersion.end=this._io.pos},t})(),b=o.Signature=(function(){function t(i,e,n){this._io=i,this._parent=e,this._root=n,this._debug={},this._read()}return t.prototype._read=function(){this._debug.algorithm={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MozillaMar.SignatureAlgorithms"},this.algorithm=this._io.readU4be(),this._debug.algorithm.end=this._io.pos,this._debug.lenSignature={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenSignature=this._io.readU4be(),this._debug.lenSignature.end=this._io.pos,this._debug.signature={start:this._io.pos,ioOffset:this._io.byteOffset},this.signature=this._io.readBytes(this.lenSignature),this._debug.signature.end=this._io.pos},t})();return Object.defineProperty(o.prototype,"index",{get:function(){if(this._m_index!==void 0)return this._m_index;var t=this._io.pos;return this._io.seek(this.ofsIndex),this._debug._m_index={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_index=new u(this._io,this,this._root),this._debug._m_index.end=this._io.pos,this._io.seek(t),this._m_index}}),o})();r.MozillaMar=d})}});const O=y(),x={id:"mozilla_mar",title:"Mozilla ARchive",ksy:{meta:{id:"mozilla_mar",title:"Mozilla ARchive","file-extension":"mar",xref:{justsolve:"Mozilla_Archive",wikidata:"Q28777700"},license:"CC0-1.0",endian:"be"},doc:`Mozilla ARchive file is Mozilla's own archive format to distribute software updates.
Test files can be found on Mozilla's FTP site, for example:

<http://ftp.mozilla.org/pub/firefox/nightly/partials/>
`,"doc-ref":"https://wiki.mozilla.org/Software_Update:MAR",seq:[{id:"magic",contents:"MAR1"},{id:"ofs_index","-orig-id":"OffsetToIndex",type:"u4"},{id:"file_size","-orig-id":"FileSize",type:"u8"},{id:"len_signatures","-orig-id":"NumSignatures",type:"u4"},{id:"signatures",type:"signature",repeat:"expr","repeat-expr":"len_signatures"},{id:"len_additional_sections","-orig-id":"NumAdditionalSections",type:"u4"},{id:"additional_sections",type:"additional_section",repeat:"expr","repeat-expr":"len_additional_sections"}],instances:{index:{pos:"ofs_index",type:"mar_index"}},types:{signature:{seq:[{id:"algorithm","-orig-id":"SignatureAlgorithmID",type:"u4",enum:"signature_algorithms"},{id:"len_signature","-orig-id":"SignatureSize",type:"u4"},{id:"signature",size:"len_signature"}]},additional_section:{seq:[{id:"len_block",type:"u4"},{id:"block_identifier","-orig-id":"BlockIdentifier",type:"u4",enum:"block_identifiers"},{id:"bytes",size:"len_block - len_block._sizeof - block_identifier._sizeof",type:{"switch-on":"block_identifier",cases:{"block_identifiers::product_information":"product_information_block"}}}]},mar_index:{seq:[{id:"len_index","-orig-id":"IndexSize",type:"u4"},{id:"index_entries",type:"index_entries",size:"len_index"}]},index_entries:{seq:[{id:"index_entry",type:"index_entry",repeat:"eos"}]},index_entry:{seq:[{id:"ofs_content","-orig-id":"OffsetToContent",type:"u4"},{id:"len_content","-orig-id":"ContentSize",type:"u4"},{id:"flags",type:"u4",doc:"File permission bits (in standard unix-style format)."},{id:"file_name","-orig-id":"FileName",type:"strz",encoding:"UTF-8"}],instances:{body:{pos:"ofs_content",io:"_root._io",size:"len_content"}}},product_information_block:{seq:[{id:"mar_channel_name","-orig-id":"MARChannelName",size:64,type:"strz",encoding:"UTF-8"},{id:"product_version","-orig-id":"ProductVersion",size:32,type:"strz",encoding:"UTF-8"}]}},enums:{signature_algorithms:{1:"rsa_pkcs1_sha1",2:"rsa_pkcs1_sha384"},block_identifiers:{1:"product_information"}}}};export{O as default,x as spec};
