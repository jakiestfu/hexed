import{k as T}from"./index-Cy_iKu7E.js";var k=Object.getOwnPropertyNames,N=(r,n)=>function(){return n||(0,r[k(r)[0]])((n={exports:{}}).exports,n),n.exports},B=N({"<stdin>"(r){(function(n,_){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream","./VlqBase128Be"],_):typeof r=="object"&&r!==null&&typeof r.nodeType!="number"?_(r,T.KaitaiStream,require("./VlqBase128Be")):_(n.StandardMidiFile||(n.StandardMidiFile={}),n.KaitaiStream,n.VlqBase128Be||(n.VlqBase128Be={}))})(typeof self<"u"?self:r,function(n,_,h){var a=(function(){function o(e,t,i){this._io=e,this._parent=t,this._root=i||this,this._debug={},this._read()}o.prototype._read=function(){this._debug.hdr={start:this._io.pos,ioOffset:this._io.byteOffset},this.hdr=new f(this._io,this,this._root),this._debug.hdr.end=this._io.pos,this._debug.tracks={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.tracks.arr=[],this.tracks=[];for(var e=0;e<this.hdr.numTracks;e++)this._debug.tracks.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.tracks.push(new m(this._io,this,this._root)),this._debug.tracks.arr[e].end=this._io.pos;this._debug.tracks.end=this._io.pos};var d=o.ChannelPressureEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.pressure={start:this._io.pos,ioOffset:this._io.byteOffset},this.pressure=this._io.readU1(),this._debug.pressure.end=this._io.pos},e})(),u=o.ControllerEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.controller={start:this._io.pos,ioOffset:this._io.byteOffset},this.controller=this._io.readU1(),this._debug.controller.end=this._io.pos,this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.value=this._io.readU1(),this._debug.value.end=this._io.pos},e})(),f=o.Header=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,_.byteArrayCompare(this.magic,new Uint8Array([77,84,104,100]))!=0){var t=new _.ValidationNotEqualError(new Uint8Array([77,84,104,100]),this.magic,this._io,"/types/header/seq/0");throw this._debug.magic.validationError=t,t}this._debug.lenHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenHeader=this._io.readU4be(),this._debug.lenHeader.end=this._io.pos,this._debug.format={start:this._io.pos,ioOffset:this._io.byteOffset},this.format=this._io.readU2be(),this._debug.format.end=this._io.pos,this._debug.numTracks={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTracks=this._io.readU2be(),this._debug.numTracks.end=this._io.pos,this._debug.division={start:this._io.pos,ioOffset:this._io.byteOffset},this.division=this._io.readS2be(),this._debug.division.end=this._io.pos},e})(),p=o.MetaEventBody=(function(){e.MetaTypeEnum=Object.freeze({SEQUENCE_NUMBER:0,TEXT_EVENT:1,COPYRIGHT:2,SEQUENCE_TRACK_NAME:3,INSTRUMENT_NAME:4,LYRIC_TEXT:5,MARKER_TEXT:6,CUE_POINT:7,MIDI_CHANNEL_PREFIX_ASSIGNMENT:32,END_OF_TRACK:47,TEMPO:81,SMPTE_OFFSET:84,TIME_SIGNATURE:88,KEY_SIGNATURE:89,SEQUENCER_SPECIFIC_EVENT:127,0:"SEQUENCE_NUMBER",1:"TEXT_EVENT",2:"COPYRIGHT",3:"SEQUENCE_TRACK_NAME",4:"INSTRUMENT_NAME",5:"LYRIC_TEXT",6:"MARKER_TEXT",7:"CUE_POINT",32:"MIDI_CHANNEL_PREFIX_ASSIGNMENT",47:"END_OF_TRACK",81:"TEMPO",84:"SMPTE_OFFSET",88:"TIME_SIGNATURE",89:"KEY_SIGNATURE",127:"SEQUENCER_SPECIFIC_EVENT"});function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.metaType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"StandardMidiFile.MetaEventBody.MetaTypeEnum"},this.metaType=this._io.readU1(),this._debug.metaType.end=this._io.pos,this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=new h.VlqBase128Be(this._io,null,null),this._debug.len.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.body=this._io.readBytes(this.len.value),this._debug.body.end=this._io.pos},e})(),b=o.NoteOffEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.note={start:this._io.pos,ioOffset:this._io.byteOffset},this.note=this._io.readU1(),this._debug.note.end=this._io.pos,this._debug.velocity={start:this._io.pos,ioOffset:this._io.byteOffset},this.velocity=this._io.readU1(),this._debug.velocity.end=this._io.pos},e})(),y=o.NoteOnEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.note={start:this._io.pos,ioOffset:this._io.byteOffset},this.note=this._io.readU1(),this._debug.note.end=this._io.pos,this._debug.velocity={start:this._io.pos,ioOffset:this._io.byteOffset},this.velocity=this._io.readU1(),this._debug.velocity.end=this._io.pos},e})(),v=o.PitchBendEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.b1={start:this._io.pos,ioOffset:this._io.byteOffset},this.b1=this._io.readU1(),this._debug.b1.end=this._io.pos,this._debug.b2={start:this._io.pos,ioOffset:this._io.byteOffset},this.b2=this._io.readU1(),this._debug.b2.end=this._io.pos},Object.defineProperty(e.prototype,"adjBendValue",{get:function(){return this._m_adjBendValue!==void 0?this._m_adjBendValue:(this._debug._m_adjBendValue={},this._m_adjBendValue=this.bendValue-16384,this._m_adjBendValue)}}),Object.defineProperty(e.prototype,"bendValue",{get:function(){return this._m_bendValue!==void 0?this._m_bendValue:(this._debug._m_bendValue={},this._m_bendValue=(this.b2<<7)+this.b1-16384,this._m_bendValue)}}),e})(),c=o.PolyphonicPressureEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.note={start:this._io.pos,ioOffset:this._io.byteOffset},this.note=this._io.readU1(),this._debug.note.end=this._io.pos,this._debug.pressure={start:this._io.pos,ioOffset:this._io.byteOffset},this.pressure=this._io.readU1(),this._debug.pressure.end=this._io.pos},e})(),l=o.ProgramChangeEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.program={start:this._io.pos,ioOffset:this._io.byteOffset},this.program=this._io.readU1(),this._debug.program.end=this._io.pos},e})(),g=o.SysexEventBody=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=new h.VlqBase128Be(this._io,null,null),this._debug.len.end=this._io.pos,this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this.data=this._io.readBytes(this.len.value),this._debug.data.end=this._io.pos},e})(),m=o.Track=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,_.byteArrayCompare(this.magic,new Uint8Array([77,84,114,107]))!=0){var t=new _.ValidationNotEqualError(new Uint8Array([77,84,114,107]),this.magic,this._io,"/types/track/seq/0");throw this._debug.magic.validationError=t,t}this._debug.lenEvents={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenEvents=this._io.readU4be(),this._debug.lenEvents.end=this._io.pos,this._debug.events={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_events=this._io.readBytes(this.lenEvents);var i=new _(this._raw_events);this.events=new O(i,this,this._root),this._debug.events.end=this._io.pos},e})(),E=o.TrackEvent=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){switch(this._debug.vTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.vTime=new h.VlqBase128Be(this._io,null,null),this._debug.vTime.end=this._io.pos,this._debug.eventHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.eventHeader=this._io.readU1(),this._debug.eventHeader.end=this._io.pos,this.eventHeader==255&&(this._debug.metaEventBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.metaEventBody=new p(this._io,this,this._root),this._debug.metaEventBody.end=this._io.pos),this.eventHeader==240&&(this._debug.sysexBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.sysexBody=new g(this._io,this,this._root),this._debug.sysexBody.end=this._io.pos),this._debug.eventBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.eventType){case 128:this.eventBody=new b(this._io,this,this._root);break;case 144:this.eventBody=new y(this._io,this,this._root);break;case 160:this.eventBody=new c(this._io,this,this._root);break;case 176:this.eventBody=new u(this._io,this,this._root);break;case 192:this.eventBody=new l(this._io,this,this._root);break;case 208:this.eventBody=new d(this._io,this,this._root);break;case 224:this.eventBody=new v(this._io,this,this._root);break}this._debug.eventBody.end=this._io.pos},Object.defineProperty(e.prototype,"channel",{get:function(){return this._m_channel!==void 0?this._m_channel:(this.eventType!=240&&(this._debug._m_channel={},this._m_channel=this.eventHeader&15),this._m_channel)}}),Object.defineProperty(e.prototype,"eventType",{get:function(){return this._m_eventType!==void 0?this._m_eventType:(this._debug._m_eventType={},this._m_eventType=this.eventHeader&240,this._m_eventType)}}),e})(),O=o.TrackEvents=(function(){function e(t,i,s){this._io=t,this._parent=i,this._root=s,this._debug={},this._read()}return e.prototype._read=function(){for(this._debug.event={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.event.arr=[],this.event=[];!this._io.isEof();)this._debug.event.arr[this.event.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.event.push(new E(this._io,this,this._root)),this._debug.event.arr[this.event.length-1].end=this._io.pos;this._debug.event.end=this._io.pos},e})();return o})();n.StandardMidiFile=a})}});const I=B(),w={id:"standard_midi_file",title:"Standard MIDI file",ksy:{meta:{id:"standard_midi_file",title:"Standard MIDI file","file-extension":["mid","midi","smf"],xref:{justsolve:"MIDI",loc:["fdd000102","fdd000119"],mime:"audio/midi",pronom:"x-fmt/230",wikidata:"Q10610388"},license:"CC0-1.0",imports:["/common/vlq_base128_be"],endian:"be"},doc:`Standard MIDI file, typically known just as "MID", is a standard way
to serialize series of MIDI events, which is a protocol used in many
music synthesizers to transfer music data: notes being played,
effects being applied, etc.

Internally, file consists of a header and series of tracks, every
track listing MIDI events with certain header designating time these
events are happening.

NOTE: Rarely, MIDI files employ certain stateful compression scheme
to avoid storing certain elements of further elements, instead
reusing them from events which happened earlier in the
stream. Kaitai Struct (as of v0.9) is currently unable to parse
these, but files employing this mechanism are relatively rare.
`,seq:[{id:"hdr",type:"header"},{id:"tracks",type:"track",repeat:"expr","repeat-expr":"hdr.num_tracks"}],types:{header:{seq:[{id:"magic",contents:"MThd"},{id:"len_header",type:"u4"},{id:"format",type:"u2"},{id:"num_tracks",type:"u2"},{id:"division",type:"s2"}]},track:{seq:[{id:"magic",contents:"MTrk"},{id:"len_events",type:"u4"},{id:"events",type:"track_events",size:"len_events"}]},track_events:{seq:[{id:"event",type:"track_event",repeat:"eos"}]},track_event:{seq:[{id:"v_time",type:"vlq_base128_be"},{id:"event_header",type:"u1"},{id:"meta_event_body",type:"meta_event_body",if:"event_header == 0xff"},{id:"sysex_body",type:"sysex_event_body",if:"event_header == 0xf0"},{id:"event_body",type:{"switch-on":"event_type",cases:{128:"note_off_event",144:"note_on_event",160:"polyphonic_pressure_event",176:"controller_event",192:"program_change_event",208:"channel_pressure_event",224:"pitch_bend_event"}}}],instances:{event_type:{value:"event_header & 0xf0"},channel:{value:"event_header & 0xf",if:"event_type != 0xf0"}}},meta_event_body:{seq:[{id:"meta_type",type:"u1",enum:"meta_type_enum"},{id:"len",type:"vlq_base128_be"},{id:"body",size:"len.value"}],enums:{meta_type_enum:{0:"sequence_number",1:"text_event",2:"copyright",3:"sequence_track_name",4:"instrument_name",5:"lyric_text",6:"marker_text",7:"cue_point",32:"midi_channel_prefix_assignment",47:"end_of_track",81:"tempo",84:"smpte_offset",88:"time_signature",89:"key_signature",127:"sequencer_specific_event"}}},note_off_event:{seq:[{id:"note",type:"u1"},{id:"velocity",type:"u1"}]},note_on_event:{seq:[{id:"note",type:"u1"},{id:"velocity",type:"u1"}]},polyphonic_pressure_event:{seq:[{id:"note",type:"u1"},{id:"pressure",type:"u1"}]},controller_event:{seq:[{id:"controller",type:"u1"},{id:"value",type:"u1"}]},program_change_event:{seq:[{id:"program",type:"u1"}]},channel_pressure_event:{seq:[{id:"pressure",type:"u1"}]},pitch_bend_event:{seq:[{id:"b1",type:"u1"},{id:"b2",type:"u1"}],instances:{bend_value:{value:"(b2 << 7) + b1 - 0x4000"},adj_bend_value:{value:"bend_value - 0x4000"}}},sysex_event_body:{seq:[{id:"len",type:"vlq_base128_be"},{id:"data",size:"len.value"}]}}}};export{I as default,w as spec};
