import{k as p}from"./index-C9sUxlHS.js";var c=Object.getOwnPropertyNames,b=(a,t)=>function(){return t||(0,a[c(a)[0]])((t={exports:{}}).exports,t),t.exports},l=b({"<stdin>"(a){(function(t,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof a=="object"&&a!==null&&typeof a.nodeType!="number"?s(a,p.KaitaiStream):s(t.UefiTe||(t.UefiTe={}),t.KaitaiStream)})(typeof self<"u"?self:a,function(t,s){var n=(function(){function r(e,i,o){this._io=e,this._parent=i,this._root=o||this,this._debug={},this._read()}r.prototype._read=function(){this._debug.teHdr={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_teHdr=this._io.readBytes(40);var e=new s(this._raw_teHdr);this.teHdr=new u(e,this,this._root),this._debug.teHdr.end=this._io.pos,this._debug.sections={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.sections.arr=[],this.sections=[];for(var i=0;i<this.teHdr.numSections;i++)this._debug.sections.arr[i]={start:this._io.pos,ioOffset:this._io.byteOffset},this.sections.push(new f(this._io,this,this._root)),this._debug.sections.arr[i].end=this._io.pos;this._debug.sections.end=this._io.pos};var d=r.DataDir=(function(){function e(i,o,_){this._io=i,this._parent=o,this._root=_,this._debug={},this._read()}return e.prototype._read=function(){this._debug.virtualAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualAddress=this._io.readU4le(),this._debug.virtualAddress.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readU4le(),this._debug.size.end=this._io.pos},e})(),h=r.HeaderDataDirs=(function(){function e(i,o,_){this._io=i,this._parent=o,this._root=_,this._debug={},this._read()}return e.prototype._read=function(){this._debug.baseRelocationTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.baseRelocationTable=new d(this._io,this,this._root),this._debug.baseRelocationTable.end=this._io.pos,this._debug.debug={start:this._io.pos,ioOffset:this._io.byteOffset},this.debug=new d(this._io,this,this._root),this._debug.debug.end=this._io.pos},e})(),f=r.Section=(function(){function e(i,o,_){this._io=i,this._parent=o,this._root=_,this._debug={},this._read()}return e.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=s.bytesToStr(s.bytesStripRight(this._io.readBytes(8),0),"UTF-8"),this._debug.name.end=this._io.pos,this._debug.virtualSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualSize=this._io.readU4le(),this._debug.virtualSize.end=this._io.pos,this._debug.virtualAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualAddress=this._io.readU4le(),this._debug.virtualAddress.end=this._io.pos,this._debug.sizeOfRawData={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfRawData=this._io.readU4le(),this._debug.sizeOfRawData.end=this._io.pos,this._debug.pointerToRawData={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToRawData=this._io.readU4le(),this._debug.pointerToRawData.end=this._io.pos,this._debug.pointerToRelocations={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToRelocations=this._io.readU4le(),this._debug.pointerToRelocations.end=this._io.pos,this._debug.pointerToLinenumbers={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToLinenumbers=this._io.readU4le(),this._debug.pointerToLinenumbers.end=this._io.pos,this._debug.numRelocations={start:this._io.pos,ioOffset:this._io.byteOffset},this.numRelocations=this._io.readU2le(),this._debug.numRelocations.end=this._io.pos,this._debug.numLinenumbers={start:this._io.pos,ioOffset:this._io.byteOffset},this.numLinenumbers=this._io.readU2le(),this._debug.numLinenumbers.end=this._io.pos,this._debug.characteristics={start:this._io.pos,ioOffset:this._io.byteOffset},this.characteristics=this._io.readU4le(),this._debug.characteristics.end=this._io.pos},Object.defineProperty(e.prototype,"body",{get:function(){if(this._m_body!==void 0)return this._m_body;var i=this._io.pos;return this._io.seek(this.pointerToRawData-this._root.teHdr.strippedSize+this._root.teHdr._io.size),this._debug._m_body={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_body=this._io.readBytes(this.sizeOfRawData),this._debug._m_body.end=this._io.pos,this._io.seek(i),this._m_body}}),e})(),u=r.TeHeader=(function(){e.MachineType=Object.freeze({UNKNOWN:0,I386:332,R4000:358,WCE_MIPS_V2:361,ALPHA:388,SH3:418,SH3_DSP:419,SH4:422,SH5:424,ARM:448,THUMB:450,ARM_NT:452,AM33:467,POWERPC:496,POWERPC_FP:497,IA64:512,MIPS16:614,ALPHA64_OR_AXP64:644,MIPS_FPU:870,MIPS16_FPU:1126,EBC:3772,RISCV32:20530,RISCV64:20580,RISCV128:20776,LOONGARCH32:25138,LOONGARCH64:25188,AMD64:34404,M32R:36929,ARM64:43620,0:"UNKNOWN",332:"I386",358:"R4000",361:"WCE_MIPS_V2",388:"ALPHA",418:"SH3",419:"SH3_DSP",422:"SH4",424:"SH5",448:"ARM",450:"THUMB",452:"ARM_NT",467:"AM33",496:"POWERPC",497:"POWERPC_FP",512:"IA64",614:"MIPS16",644:"ALPHA64_OR_AXP64",870:"MIPS_FPU",1126:"MIPS16_FPU",3772:"EBC",20530:"RISCV32",20580:"RISCV64",20776:"RISCV128",25138:"LOONGARCH32",25188:"LOONGARCH64",34404:"AMD64",36929:"M32R",43620:"ARM64"}),e.SubsystemEnum=Object.freeze({UNKNOWN:0,NATIVE:1,WINDOWS_GUI:2,WINDOWS_CUI:3,POSIX_CUI:7,WINDOWS_CE_GUI:9,EFI_APPLICATION:10,EFI_BOOT_SERVICE_DRIVER:11,EFI_RUNTIME_DRIVER:12,EFI_ROM:13,XBOX:14,WINDOWS_BOOT_APPLICATION:16,0:"UNKNOWN",1:"NATIVE",2:"WINDOWS_GUI",3:"WINDOWS_CUI",7:"POSIX_CUI",9:"WINDOWS_CE_GUI",10:"EFI_APPLICATION",11:"EFI_BOOT_SERVICE_DRIVER",12:"EFI_RUNTIME_DRIVER",13:"EFI_ROM",14:"XBOX",16:"WINDOWS_BOOT_APPLICATION"});function e(i,o,_){this._io=i,this._parent=o,this._root=_,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(2),this._debug.magic.end=this._io.pos,s.byteArrayCompare(this.magic,new Uint8Array([86,90]))!=0){var i=new s.ValidationNotEqualError(new Uint8Array([86,90]),this.magic,this._io,"/types/te_header/seq/0");throw this._debug.magic.validationError=i,i}this._debug.machine={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"UefiTe.TeHeader.MachineType"},this.machine=this._io.readU2le(),this._debug.machine.end=this._io.pos,this._debug.numSections={start:this._io.pos,ioOffset:this._io.byteOffset},this.numSections=this._io.readU1(),this._debug.numSections.end=this._io.pos,this._debug.subsystem={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"UefiTe.TeHeader.SubsystemEnum"},this.subsystem=this._io.readU1(),this._debug.subsystem.end=this._io.pos,this._debug.strippedSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.strippedSize=this._io.readU2le(),this._debug.strippedSize.end=this._io.pos,this._debug.entryPointAddr={start:this._io.pos,ioOffset:this._io.byteOffset},this.entryPointAddr=this._io.readU4le(),this._debug.entryPointAddr.end=this._io.pos,this._debug.baseOfCode={start:this._io.pos,ioOffset:this._io.byteOffset},this.baseOfCode=this._io.readU4le(),this._debug.baseOfCode.end=this._io.pos,this._debug.imageBase={start:this._io.pos,ioOffset:this._io.byteOffset},this.imageBase=this._io.readU8le(),this._debug.imageBase.end=this._io.pos,this._debug.dataDirs={start:this._io.pos,ioOffset:this._io.byteOffset},this.dataDirs=new h(this._io,this,this._root),this._debug.dataDirs.end=this._io.pos},e})();return r})();t.UefiTe=n})}});const y=l(),O={id:"uefi_te",title:"TE (Terse Executable) file",ksy:{meta:{id:"uefi_te",title:"TE (Terse Executable) file",application:"UEFI","file-extension":["efi","te"],xref:{wikidata:"Q83443959"},tags:["executable","firmware"],license:"CC0-1.0","ks-version":.7,endian:"le"},doc:`This type of executables could be found inside the UEFI firmware. The UEFI
firmware is stored in SPI flash memory, which is a chip soldered on a
system's motherboard. UEFI firmware is very modular: it usually contains
dozens, if not hundreds, of executables. To store all these separates files,
the firmware is laid out in volumes using the Firmware File System (FFS), a
file system specifically designed to store firmware images. The volumes
contain files that are identified by GUIDs and each of these files contain
one or more sections holding the data. One of these sections contains the
actual executable image. Most of the executable images follow the PE format.
However, some of them follow the TE format.

The Terse Executable (TE) image format was created as a mechanism to reduce
the overhead of the PE/COFF headers in PE32/PE32+ images, resulting in a
corresponding reduction of image sizes for executables running in the PI
(Platform Initialization) Architecture environment. Reducing image size
provides an opportunity for use of a smaller system flash part.

So the TE format is basically a stripped version of PE.
`,"doc-ref":"https://uefi.org/sites/default/files/resources/PI_Spec_1_6.pdf",seq:[{id:"te_hdr",size:40,type:"te_header"},{id:"sections",type:"section",repeat:"expr","repeat-expr":"te_hdr.num_sections"}],types:{te_header:{seq:[{id:"magic",contents:"VZ"},{id:"machine",type:"u2",enum:"machine_type"},{id:"num_sections",type:"u1"},{id:"subsystem",type:"u1",enum:"subsystem_enum"},{id:"stripped_size",type:"u2"},{id:"entry_point_addr",type:"u4"},{id:"base_of_code",type:"u4"},{id:"image_base",type:"u8"},{id:"data_dirs",type:"header_data_dirs"}],enums:{machine_type:{0:{id:"unknown",doc:"The content of this field is assumed to be applicable to any machine type"},332:{id:"i386",doc:"Intel 386 or later processors and compatible processors"},358:{id:"r4000",doc:"MIPS little endian"},361:{id:"wce_mips_v2","-orig-id":"IMAGE_FILE_MACHINE_WCEMIPSV2",doc:"MIPS little-endian WCE v2"},388:{id:"alpha",doc:"Alpha AXP, 32-bit address space"},418:{id:"sh3",doc:"Hitachi SH3"},419:{id:"sh3_dsp","-orig-id":"IMAGE_FILE_MACHINE_SH3DSP",doc:"Hitachi SH3 DSP"},422:{id:"sh4",doc:"Hitachi SH4"},424:{id:"sh5",doc:"Hitachi SH5"},448:{id:"arm",doc:"ARM little endian"},450:{id:"thumb",doc:"Thumb"},452:{id:"arm_nt","-orig-id":"IMAGE_FILE_MACHINE_ARMNT",doc:"ARM Thumb-2 little endian"},467:{id:"am33",doc:"Matsushita AM33"},496:{id:"powerpc",doc:"Power PC little endian"},497:{id:"powerpc_fp","-orig-id":"IMAGE_FILE_MACHINE_POWERPCFP",doc:"Power PC with floating point support"},512:{id:"ia64",doc:"Intel Itanium processor family"},614:{id:"mips16",doc:"MIPS16"},644:{id:"alpha64_or_axp64","-orig-id":["IMAGE_FILE_MACHINE_ALPHA64","IMAGE_FILE_MACHINE_AXP64"],doc:`> Alpha 64, 64-bit address space
or
> AXP 64 (Same as Alpha 64)
`},870:{id:"mips_fpu","-orig-id":"IMAGE_FILE_MACHINE_MIPSFPU",doc:"MIPS with FPU"},1126:{id:"mips16_fpu","-orig-id":"IMAGE_FILE_MACHINE_MIPSFPU16",doc:"MIPS16 with FPU"},3772:{id:"ebc",doc:"EFI byte code"},20530:{id:"riscv32",doc:"RISC-V 32-bit address space"},20580:{id:"riscv64",doc:"RISC-V 64-bit address space"},20776:{id:"riscv128",doc:"RISC-V 128-bit address space"},25138:{id:"loongarch32",doc:"LoongArch 32-bit processor family"},25188:{id:"loongarch64",doc:"LoongArch 64-bit processor family"},34404:{id:"amd64",doc:"x64"},36929:{id:"m32r",doc:"Mitsubishi M32R little endian"},43620:{id:"arm64",doc:"ARM64 little endian"}},subsystem_enum:{0:"unknown",1:"native",2:"windows_gui",3:"windows_cui",7:"posix_cui",9:"windows_ce_gui",10:"efi_application",11:"efi_boot_service_driver",12:"efi_runtime_driver",13:"efi_rom",14:"xbox",16:"windows_boot_application"}}},header_data_dirs:{seq:[{id:"base_relocation_table",type:"data_dir"},{id:"debug",type:"data_dir"}]},data_dir:{seq:[{id:"virtual_address",type:"u4"},{id:"size",type:"u4"}]},section:{seq:[{id:"name",type:"str",encoding:"UTF-8",size:8,"pad-right":0},{id:"virtual_size",type:"u4"},{id:"virtual_address",type:"u4"},{id:"size_of_raw_data",type:"u4"},{id:"pointer_to_raw_data",type:"u4"},{id:"pointer_to_relocations",type:"u4"},{id:"pointer_to_linenumbers",type:"u4"},{id:"num_relocations",type:"u2"},{id:"num_linenumbers",type:"u2"},{id:"characteristics",type:"u4"}],instances:{body:{pos:"pointer_to_raw_data - _root.te_hdr.stripped_size + _root.te_hdr._io.size",size:"size_of_raw_data"}}}}}};export{y as default,O as spec};
