import{k as c}from"./index-LM5QM2-c.js";var y=Object.getOwnPropertyNames,b=(r,o)=>function(){return o||(0,r[y(r)[0]])((o={exports:{}}).exports,o),o.exports},g=b({"<stdin>"(r){(function(o,h){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],h):typeof r=="object"&&r!==null&&typeof r.nodeType!="number"?h(r,c.KaitaiStream):h(o.SudoersTs||(o.SudoersTs={}),o.KaitaiStream)})(typeof self<"u"?self:r,function(o,h){var p=(function(){e.TsType=Object.freeze({GLOBAL:1,TTY:2,PPID:3,LOCKEXCL:4,1:"GLOBAL",2:"TTY",3:"PPID",4:"LOCKEXCL"});function e(t,s,i){this._io=t,this._parent=s,this._root=i||this,this._debug={},this._read()}e.prototype._read=function(){for(this._debug.records={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.records.arr=[],this.records=[];!this._io.isEof();)this._debug.records.arr[this.records.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.records.push(new n(this._io,this,this._root)),this._debug.records.arr[this.records.length-1].end=this._io.pos;this._debug.records.end=this._io.pos};var n=e.Record=(function(){function t(s,i,d){this._io=s,this._parent=i,this._root=d,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU2le(),this._debug.version.end=this._io.pos,this._debug.lenRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenRecord=this._io.readU2le(),this._debug.lenRecord.end=this._io.pos,this._debug.payload={start:this._io.pos,ioOffset:this._io.byteOffset},this.version){case 1:this._raw_payload=this._io.readBytes(this.lenRecord-4);var s=new h(this._raw_payload);this.payload=new f(s,this,this._root);break;case 2:this._raw_payload=this._io.readBytes(this.lenRecord-4);var s=new h(this._raw_payload);this.payload=new u(s,this,this._root);break;default:this.payload=this._io.readBytes(this.lenRecord-4);break}this._debug.payload.end=this._io.pos},t})(),f=e.RecordV1=(function(){function t(s,i,d){this._io=s,this._parent=i,this._root=d,this._debug={},this._read()}return t.prototype._read=function(){this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"SudoersTs.TsType"},this.type=this._io.readU2le(),this._debug.type.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=new a(this._io,this,this._root),this._debug.flags.end=this._io.pos,this._debug.authUid={start:this._io.pos,ioOffset:this._io.byteOffset},this.authUid=this._io.readU4le(),this._debug.authUid.end=this._io.pos,this._debug.sid={start:this._io.pos,ioOffset:this._io.byteOffset},this.sid=this._io.readU4le(),this._debug.sid.end=this._io.pos,this._debug.ts={start:this._io.pos,ioOffset:this._io.byteOffset},this.ts=new _(this._io,this,this._root),this._debug.ts.end=this._io.pos,this.type==e.TsType.TTY&&(this._debug.ttydev={start:this._io.pos,ioOffset:this._io.byteOffset},this.ttydev=this._io.readU4le(),this._debug.ttydev.end=this._io.pos),this.type==e.TsType.PPID&&(this._debug.ppid={start:this._io.pos,ioOffset:this._io.byteOffset},this.ppid=this._io.readU4le(),this._debug.ppid.end=this._io.pos)},t})(),u=e.RecordV2=(function(){function t(s,i,d){this._io=s,this._parent=i,this._root=d,this._debug={},this._read()}return t.prototype._read=function(){this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"SudoersTs.TsType"},this.type=this._io.readU2le(),this._debug.type.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=new a(this._io,this,this._root),this._debug.flags.end=this._io.pos,this._debug.authUid={start:this._io.pos,ioOffset:this._io.byteOffset},this.authUid=this._io.readU4le(),this._debug.authUid.end=this._io.pos,this._debug.sid={start:this._io.pos,ioOffset:this._io.byteOffset},this.sid=this._io.readU4le(),this._debug.sid.end=this._io.pos,this._debug.startTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.startTime=new _(this._io,this,this._root),this._debug.startTime.end=this._io.pos,this._debug.ts={start:this._io.pos,ioOffset:this._io.byteOffset},this.ts=new _(this._io,this,this._root),this._debug.ts.end=this._io.pos,this.type==e.TsType.TTY&&(this._debug.ttydev={start:this._io.pos,ioOffset:this._io.byteOffset},this.ttydev=this._io.readU4le(),this._debug.ttydev.end=this._io.pos),this.type==e.TsType.PPID&&(this._debug.ppid={start:this._io.pos,ioOffset:this._io.byteOffset},this.ppid=this._io.readU4le(),this._debug.ppid.end=this._io.pos)},t})(),_=e.Timespec=(function(){function t(s,i,d){this._io=s,this._parent=i,this._root=d,this._debug={},this._read()}return t.prototype._read=function(){this._debug.sec={start:this._io.pos,ioOffset:this._io.byteOffset},this.sec=this._io.readS8le(),this._debug.sec.end=this._io.pos,this._debug.nsec={start:this._io.pos,ioOffset:this._io.byteOffset},this.nsec=this._io.readS8le(),this._debug.nsec.end=this._io.pos},t})(),a=e.TsFlag=(function(){function t(s,i,d){this._io=s,this._parent=i,this._root=d,this._debug={},this._read()}return t.prototype._read=function(){this._debug.reserved0={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved0=this._io.readBitsIntBe(6),this._debug.reserved0.end=this._io.pos,this._debug.anyuid={start:this._io.pos,ioOffset:this._io.byteOffset},this.anyuid=this._io.readBitsIntBe(1)!=0,this._debug.anyuid.end=this._io.pos,this._debug.disabled={start:this._io.pos,ioOffset:this._io.byteOffset},this.disabled=this._io.readBitsIntBe(1)!=0,this._debug.disabled.end=this._io.pos,this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBitsIntBe(8),this._debug.reserved1.end=this._io.pos},t})();return e})();o.SudoersTs=p})}});const O=g(),m={id:"sudoers_ts",title:"Sudoers Time Stamp file",ksy:{meta:{id:"sudoers_ts",title:"Sudoers Time Stamp file",license:"CC0-1.0",tags:["linux"],endian:"le"},doc:`This spec can be used to parse sudo time stamp files located in directories
such as /run/sudo/ts/$USER or /var/lib/sudo/ts/$USER.
`,"doc-ref":"https://www.sudo.ws/docs/man/1.8.27/sudoers_timestamp.man/",seq:[{id:"records",type:"record",repeat:"eos"}],types:{record:{seq:[{id:"version",doc:"version number of the timestamp_entry struct",type:"u2"},{id:"len_record",doc:"size of the record in bytes",type:"u2","-orig-id":"size"},{id:"payload",size:"len_record - 4",type:{"switch-on":"version",cases:{1:"record_v1",2:"record_v2"}}}]},record_v1:{seq:[{id:"type",doc:"record type",type:"u2",enum:"ts_type"},{id:"flags",doc:"record flags",type:"ts_flag"},{id:"auth_uid",doc:"user ID that was used for authentication",type:"u4"},{id:"sid",doc:"session ID associated with tty/ppid",type:"u4"},{id:"ts",doc:"time stamp, from a monotonic time source",type:"timespec"},{id:"ttydev",doc:"device number of the terminal associated with the session",if:"type == ts_type::tty",type:"u4"},{id:"ppid",doc:"ID of the parent process",if:"type == ts_type::ppid",type:"u4"}]},record_v2:{seq:[{id:"type",doc:"record type",type:"u2",enum:"ts_type"},{id:"flags",doc:"record flags",type:"ts_flag"},{id:"auth_uid",doc:"user ID that was used for authentication",type:"u4"},{id:"sid",doc:"ID of the user's terminal session, if present (when type is TS_TTY)",type:"u4"},{id:"start_time",doc:"start time of the session leader for records of type TS_TTY or of the parent process for records of type TS_PPID",type:"timespec"},{id:"ts",doc:"actual time stamp, from a monotonic time source",type:"timespec"},{id:"ttydev",doc:"device number of the terminal associated with the session",if:"type == ts_type::tty",type:"u4"},{id:"ppid",doc:"ID of the parent process",if:"type == ts_type::ppid",type:"u4"}]},timespec:{seq:[{id:"sec",type:"s8",doc:"seconds"},{id:"nsec",type:"s8",doc:"nanoseconds"}]},ts_flag:{seq:[{id:"reserved0",doc:"Reserved (unused) bits",type:"b6"},{id:"anyuid",doc:"ignore uid",type:"b1","-orig-id":"TS_ANYUID"},{id:"disabled",doc:"entry disabled",type:"b1","-orig-id":"TS_DISABLED"},{id:"reserved1",doc:"Reserved (unused) bits",type:"b8"}]}},enums:{ts_type:{1:"global",2:"tty",3:"ppid",4:"lockexcl"}}}};export{O as default,m as spec};
