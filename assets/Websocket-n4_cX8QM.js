import{k as f}from"./index-CMEpbKl5.js";var p=Object.getOwnPropertyNames,y=(s,t)=>function(){return t||(0,s[p(s)[0]])((t={exports:{}}).exports,t),t.exports},b=y({"<stdin>"(s){(function(t,a){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],a):typeof s=="object"&&s!==null&&typeof s.nodeType!="number"?a(s,f.KaitaiStream):a(t.Websocket||(t.Websocket={}),t.KaitaiStream)})(typeof self<"u"?self:s,function(t,a){var h=(function(){i.Opcode=Object.freeze({CONTINUATION:0,TEXT:1,BINARY:2,RESERVED_3:3,RESERVED_4:4,RESERVED_5:5,RESERVED_6:6,RESERVED_7:7,CLOSE:8,PING:9,PONG:10,RESERVED_CONTROL_B:11,RESERVED_CONTROL_C:12,RESERVED_CONTROL_D:13,RESERVED_CONTROL_E:14,RESERVED_CONTROL_F:15,0:"CONTINUATION",1:"TEXT",2:"BINARY",3:"RESERVED_3",4:"RESERVED_4",5:"RESERVED_5",6:"RESERVED_6",7:"RESERVED_7",8:"CLOSE",9:"PING",10:"PONG",11:"RESERVED_CONTROL_B",12:"RESERVED_CONTROL_C",13:"RESERVED_CONTROL_D",14:"RESERVED_CONTROL_E",15:"RESERVED_CONTROL_F"});function i(e,o,d){this._io=e,this._parent=o,this._root=d||this,this._debug={},this._read()}i.prototype._read=function(){if(this._debug.initialFrame={start:this._io.pos,ioOffset:this._io.byteOffset},this.initialFrame=new l(this._io,this,this._root),this._debug.initialFrame.end=this._io.pos,this.initialFrame.header.finished!=!0){this._debug.trailingFrames={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.trailingFrames.arr=[],this.trailingFrames=[];do{this._debug.trailingFrames.arr[this.trailingFrames.length]={start:this._io.pos,ioOffset:this._io.byteOffset};var e=new n(this._io,this,this._root);this.trailingFrames.push(e),this._debug.trailingFrames.arr[this.trailingFrames.length-1].end=this._io.pos}while(!e.header.finished);this._debug.trailingFrames.end=this._io.pos}};var n=i.Dataframe=(function(){function e(o,d,r){this._io=o,this._parent=d,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new _(this._io,this,this._root),this._debug.header.end=this._io.pos,this._root.initialFrame.header.opcode!=i.Opcode.TEXT&&(this._debug.payloadBytes={start:this._io.pos,ioOffset:this._io.byteOffset},this.payloadBytes=this._io.readBytes(this.header.lenPayload),this._debug.payloadBytes.end=this._io.pos),this._root.initialFrame.header.opcode==i.Opcode.TEXT&&(this._debug.payloadText={start:this._io.pos,ioOffset:this._io.byteOffset},this.payloadText=a.bytesToStr(this._io.readBytes(this.header.lenPayload),"UTF-8"),this._debug.payloadText.end=this._io.pos)},e})(),_=i.FrameHeader=(function(){function e(o,d,r){this._io=o,this._parent=d,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.finished={start:this._io.pos,ioOffset:this._io.byteOffset},this.finished=this._io.readBitsIntBe(1)!=0,this._debug.finished.end=this._io.pos,this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBitsIntBe(3),this._debug.reserved.end=this._io.pos,this._debug.opcode={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Websocket.Opcode"},this.opcode=this._io.readBitsIntBe(4),this._debug.opcode.end=this._io.pos,this._debug.isMasked={start:this._io.pos,ioOffset:this._io.byteOffset},this.isMasked=this._io.readBitsIntBe(1)!=0,this._debug.isMasked.end=this._io.pos,this._debug.lenPayloadPrimary={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenPayloadPrimary=this._io.readBitsIntBe(7),this._debug.lenPayloadPrimary.end=this._io.pos,this._io.alignToByte(),this.lenPayloadPrimary==126&&(this._debug.lenPayloadExtended1={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenPayloadExtended1=this._io.readU2be(),this._debug.lenPayloadExtended1.end=this._io.pos),this.lenPayloadPrimary==127&&(this._debug.lenPayloadExtended2={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenPayloadExtended2=this._io.readU4be(),this._debug.lenPayloadExtended2.end=this._io.pos),this.isMasked&&(this._debug.maskKey={start:this._io.pos,ioOffset:this._io.byteOffset},this.maskKey=this._io.readU4be(),this._debug.maskKey.end=this._io.pos)},Object.defineProperty(e.prototype,"lenPayload",{get:function(){return this._m_lenPayload!==void 0?this._m_lenPayload:(this._debug._m_lenPayload={},this._m_lenPayload=this.lenPayloadPrimary<=125?this.lenPayloadPrimary:this.lenPayloadPrimary==126?this.lenPayloadExtended1:this.lenPayloadExtended2,this._m_lenPayload)}}),e})(),l=i.InitialFrame=(function(){function e(o,d,r){this._io=o,this._parent=d,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new _(this._io,this,this._root),this._debug.header.end=this._io.pos,this.header.opcode!=i.Opcode.TEXT&&(this._debug.payloadBytes={start:this._io.pos,ioOffset:this._io.byteOffset},this.payloadBytes=this._io.readBytes(this.header.lenPayload),this._debug.payloadBytes.end=this._io.pos),this.header.opcode==i.Opcode.TEXT&&(this._debug.payloadText={start:this._io.pos,ioOffset:this._io.byteOffset},this.payloadText=a.bytesToStr(this._io.readBytes(this.header.lenPayload),"UTF-8"),this._debug.payloadText.end=this._io.pos)},e})();return i})();t.Websocket=h})}});const m=b(),E={id:"websocket",title:"WebSocket",ksy:{meta:{id:"websocket",title:"WebSocket",xref:{rfc:6455,wikidata:"Q859938"},license:"CC0-1.0",endian:"be"},doc:`The WebSocket protocol establishes a two-way communication channel via TCP.
Messages are made up of one or more dataframes, and are delineated by
frames with the \`fin\` bit set.
`,seq:[{id:"initial_frame",type:"initial_frame"},{id:"trailing_frames",type:"dataframe",if:"initial_frame.header.finished != true",repeat:"until","repeat-until":"_.header.finished"}],types:{frame_header:{seq:[{id:"finished","-orig-id":"fin",type:"b1"},{id:"reserved","-orig-id":"rsv1, rsv2, rsv3",type:"b3"},{id:"opcode",enum:"opcode",type:"b4"},{id:"is_masked",type:"b1"},{id:"len_payload_primary",type:"b7"},{id:"len_payload_extended_1",type:"u2",if:"len_payload_primary == 126"},{id:"len_payload_extended_2",type:"u4",if:"len_payload_primary == 127"},{id:"mask_key",type:"u4",if:"is_masked"}],instances:{len_payload:{value:`len_payload_primary <= 125 ? len_payload_primary : (
  len_payload_primary == 126 ? len_payload_extended_1 : len_payload_extended_2
)
`}}},initial_frame:{seq:[{id:"header",type:"frame_header"},{id:"payload_bytes",size:"header.len_payload",if:"header.opcode != opcode::text"},{id:"payload_text",size:"header.len_payload",type:"str",encoding:"UTF-8",if:"header.opcode == opcode::text"}]},dataframe:{seq:[{id:"header",type:"frame_header"},{id:"payload_bytes",size:"header.len_payload",if:"_root.initial_frame.header.opcode != opcode::text"},{id:"payload_text",size:"header.len_payload",type:"str",encoding:"UTF-8",if:"_root.initial_frame.header.opcode == opcode::text"}]}},enums:{opcode:{0:"continuation",1:"text",2:"binary",3:"reserved_3",4:"reserved_4",5:"reserved_5",6:"reserved_6",7:"reserved_7",8:"close",9:"ping",10:"pong",11:"reserved_control_b",12:"reserved_control_c",13:"reserved_control_d",14:"reserved_control_e",15:"reserved_control_f"}}}};export{m as default,E as spec};
