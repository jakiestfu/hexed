import{k as p}from"./index-COA_x_BK.js";var m=Object.getOwnPropertyNames,l=(i,t)=>function(){return t||(0,i[m(i)[0]])((t={exports:{}}).exports,t),t.exports},y=l({"<stdin>"(i){(function(t,r){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],r):typeof i=="object"&&i!==null&&typeof i.nodeType!="number"?r(i,p.KaitaiStream):r(t.ChromePak||(t.ChromePak={}),t.KaitaiStream)})(typeof self<"u"?self:i,function(t,r){var h=(function(){o.Encodings=Object.freeze({BINARY:0,UTF8:1,UTF16:2,0:"BINARY",1:"UTF8",2:"UTF16"});function o(s,e,n){this._io=s,this._parent=e,this._root=n||this,this._debug={},this._read()}o.prototype._read=function(){if(this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU4le(),this._debug.version.end=this._io.pos,!(this.version==4||this.version==5)){var s=new r.ValidationNotAnyOfError(this.version,this._io,"/seq/0");throw this._debug.version.validationError=s,s}this.version==4&&(this._debug.numResourcesV4={start:this._io.pos,ioOffset:this._io.byteOffset},this.numResourcesV4=this._io.readU4le(),this._debug.numResourcesV4.end=this._io.pos),this._debug.encoding={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"ChromePak.Encodings"},this.encoding=this._io.readU1(),this._debug.encoding.end=this._io.pos,this.version==5&&(this._debug.v5Part={start:this._io.pos,ioOffset:this._io.byteOffset},this.v5Part=new u(this._io,this,this._root),this._debug.v5Part.end=this._io.pos),this._debug.resources={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.resources.arr=[],this.resources=[];for(var e=0;e<this.numResources+1;e++)this._debug.resources.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.resources.push(new _(this._io,this,this._root,e,e<this.numResources)),this._debug.resources.arr[e].end=this._io.pos;this._debug.resources.end=this._io.pos,this._debug.aliases={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.aliases.arr=[],this.aliases=[];for(var e=0;e<this.numAliases;e++)this._debug.aliases.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.aliases.push(new d(this._io,this,this._root)),this._debug.aliases.arr[e].end=this._io.pos;this._debug.aliases.end=this._io.pos};var d=o.Alias=(function(){function s(e,n,a){this._io=e,this._parent=n,this._root=a,this._debug={},this._read()}return s.prototype._read=function(){if(this._debug.id={start:this._io.pos,ioOffset:this._io.byteOffset},this.id=this._io.readU2le(),this._debug.id.end=this._io.pos,this._debug.resourceIdx={start:this._io.pos,ioOffset:this._io.byteOffset},this.resourceIdx=this._io.readU2le(),this._debug.resourceIdx.end=this._io.pos,!(this.resourceIdx<=this._parent.numResources-1)){var e=new r.ValidationGreaterThanError(this._parent.numResources-1,this.resourceIdx,this._io,"/types/alias/seq/1");throw this._debug.resourceIdx.validationError=e,e}},Object.defineProperty(s.prototype,"resource",{get:function(){return this._m_resource!==void 0?this._m_resource:(this._debug._m_resource={},this._m_resource=this._parent.resources[this.resourceIdx],this._m_resource)}}),s})(),u=o.HeaderV5Part=(function(){function s(e,n,a){this._io=e,this._parent=n,this._root=a,this._debug={},this._read()}return s.prototype._read=function(){this._debug.encodingPadding={start:this._io.pos,ioOffset:this._io.byteOffset},this.encodingPadding=this._io.readBytes(3),this._debug.encodingPadding.end=this._io.pos,this._debug.numResources={start:this._io.pos,ioOffset:this._io.byteOffset},this.numResources=this._io.readU2le(),this._debug.numResources.end=this._io.pos,this._debug.numAliases={start:this._io.pos,ioOffset:this._io.byteOffset},this.numAliases=this._io.readU2le(),this._debug.numAliases.end=this._io.pos},s})(),_=o.Resource=(function(){function s(e,n,a,c,f){this._io=e,this._parent=n,this._root=a,this.idx=c,this.hasBody=f,this._debug={},this._read()}return s.prototype._read=function(){this._debug.id={start:this._io.pos,ioOffset:this._io.byteOffset},this.id=this._io.readU2le(),this._debug.id.end=this._io.pos,this._debug.ofsBody={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsBody=this._io.readU4le(),this._debug.ofsBody.end=this._io.pos},Object.defineProperty(s.prototype,"body",{get:function(){if(this._m_body!==void 0)return this._m_body;if(this.hasBody){var e=this._io.pos;this._io.seek(this.ofsBody),this._debug._m_body={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_body=this._io.readBytes(this.lenBody),this._debug._m_body.end=this._io.pos,this._io.seek(e)}return this._m_body}}),Object.defineProperty(s.prototype,"lenBody",{get:function(){return this._m_lenBody!==void 0?this._m_lenBody:(this.hasBody&&(this._debug._m_lenBody={},this._m_lenBody=this._parent.resources[this.idx+1].ofsBody-this.ofsBody),this._m_lenBody)}}),s})();return Object.defineProperty(o.prototype,"numAliases",{get:function(){return this._m_numAliases!==void 0?this._m_numAliases:(this._debug._m_numAliases={},this._m_numAliases=this.version==5?this.v5Part.numAliases:0,this._m_numAliases)}}),Object.defineProperty(o.prototype,"numResources",{get:function(){return this._m_numResources!==void 0?this._m_numResources:(this._debug._m_numResources={},this._m_numResources=this.version==5?this.v5Part.numResources:this.numResourcesV4,this._m_numResources)}}),o})();t.ChromePak=h})}});const g=y(),v={id:"chrome_pak",title:"Chrome PAK serialization format",ksy:{meta:{id:"chrome_pak",title:"Chrome PAK serialization format","file-extension":"pak",tags:["archive","serialization"],license:"CC0-1.0",endian:"le"},doc:`Format mostly used by Google Chrome and various Android apps to store
resources such as translated strings, help messages and images.
`,"doc-ref":["https://web.archive.org/web/20220126211447/https://dev.chromium.org/developers/design-documents/linuxresourcesandlocalizedstrings","https://chromium.googlesource.com/chromium/src/tools/grit/+/3c36f27/grit/format/data_pack.py","https://chromium.googlesource.com/chromium/src/tools/grit/+/8a23eae/grit/format/data_pack.py"],seq:[{id:"version",type:"u4",valid:{"any-of":[4,5]},doc:"only versions 4 and 5 are supported"},{id:"num_resources_v4",type:"u4",if:"version == 4"},{id:"encoding",type:"u1",enum:"encodings",doc:`Character encoding of all text resources in the PAK file. Note that
the file can **always** contain binary resources, this only applies to
those that are supposed to hold text.

In practice, this will probably always be \`encodings::utf8\` - I haven't
seen any organic file that would state otherwise. \`UTF8\` is also usually
hardcoded in Python scripts from the GRIT repository that generate .pak
files (for example
[\`pak_util.py:79\`](https://chromium.googlesource.com/chromium/src/tools/grit/+/8a23eae/pak_util.py#79)).
`},{id:"v5_part",type:"header_v5_part",if:"version == 5"},{id:"resources",type:"resource(_index, _index < num_resources)",repeat:"expr","repeat-expr":"num_resources + 1",doc:`The length is calculated by looking at the offset of
the next item, so an extra entry is stored with id 0
and offset pointing to the end of the resources.
`},{id:"aliases",type:"alias",repeat:"expr","repeat-expr":"num_aliases"}],instances:{num_resources:{value:"version == 5 ? v5_part.num_resources : num_resources_v4"},num_aliases:{value:"version == 5 ? v5_part.num_aliases : 0"}},types:{header_v5_part:{seq:[{id:"encoding_padding",size:3},{id:"num_resources",type:"u2"},{id:"num_aliases",type:"u2"}]},resource:{"-webide-representation":"{id:dec} - o:{ofs_body} s:{len_body}",params:[{id:"idx",type:"s4"},{id:"has_body",type:"bool"}],seq:[{id:"id",type:"u2"},{id:"ofs_body",type:"u4"}],instances:{len_body:{value:"_parent.resources[idx + 1].ofs_body - ofs_body",if:"has_body",doc:"MUST NOT be accessed until the next `resource` is parsed"},body:{pos:"ofs_body",size:"len_body",if:"has_body",doc:"MUST NOT be accessed until the next `resource` is parsed"}}},alias:{"-webide-representation":"{id:dec} -> resources[{resource_idx:dec}] ({resource})",seq:[{id:"id",type:"u2"},{id:"resource_idx",type:"u2",valid:{max:"_parent.num_resources - 1"}}],instances:{resource:{value:"_parent.resources[resource_idx]"}}}},enums:{encodings:{0:{id:"binary",doc:"file is not expected to contain any text resources"},1:{id:"utf8",doc:"all text resources are encoded in UTF-8"},2:{id:"utf16",doc:"all text resources are encoded in UTF-16"}}}}};export{g as default,v as spec};
