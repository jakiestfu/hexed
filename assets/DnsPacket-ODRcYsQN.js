import{k as w}from"./index-COA_x_BK.js";var T=Object.getOwnPropertyNames,q=(a,h)=>function(){return h||(0,a[T(a)[0]])((h={exports:{}}).exports,h),h.exports},x=q({"<stdin>"(a){(function(h,_){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],_):typeof a=="object"&&a!==null&&typeof a.nodeType!="number"?_(a,w.KaitaiStream):_(h.DnsPacket||(h.DnsPacket={}),h.KaitaiStream)})(typeof self<"u"?self:a,function(h,_){var d=(function(){s.ClassType=Object.freeze({IN_CLASS:1,CS:2,CH:3,HS:4,1:"IN_CLASS",2:"CS",3:"CH",4:"HS"}),s.TypeType=Object.freeze({A:1,NS:2,MD:3,MF:4,CNAME:5,SOA:6,MB:7,MG:8,MR:9,NULL:10,WKS:11,PTR:12,HINFO:13,MINFO:14,MX:15,TXT:16,AAAA:28,SRV:33,1:"A",2:"NS",3:"MD",4:"MF",5:"CNAME",6:"SOA",7:"MB",8:"MG",9:"MR",10:"NULL",11:"WKS",12:"PTR",13:"HINFO",14:"MINFO",15:"MX",16:"TXT",28:"AAAA",33:"SRV"});function s(t,i,e){this._io=t,this._parent=i,this._root=e||this,this._debug={},this._read()}s.prototype._read=function(){if(this._debug.transactionId={start:this._io.pos,ioOffset:this._io.byteOffset},this.transactionId=this._io.readU2be(),this._debug.transactionId.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=new c(this._io,this,this._root),this._debug.flags.end=this._io.pos,this.flags.isOpcodeValid&&(this._debug.qdcount={start:this._io.pos,ioOffset:this._io.byteOffset},this.qdcount=this._io.readU2be(),this._debug.qdcount.end=this._io.pos),this.flags.isOpcodeValid&&(this._debug.ancount={start:this._io.pos,ioOffset:this._io.byteOffset},this.ancount=this._io.readU2be(),this._debug.ancount.end=this._io.pos),this.flags.isOpcodeValid&&(this._debug.nscount={start:this._io.pos,ioOffset:this._io.byteOffset},this.nscount=this._io.readU2be(),this._debug.nscount.end=this._io.pos),this.flags.isOpcodeValid&&(this._debug.arcount={start:this._io.pos,ioOffset:this._io.byteOffset},this.arcount=this._io.readU2be(),this._debug.arcount.end=this._io.pos),this.flags.isOpcodeValid){this._debug.queries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.queries.arr=[],this.queries=[];for(var t=0;t<this.qdcount;t++)this._debug.queries.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.queries.push(new l(this._io,this,this._root)),this._debug.queries.arr[t].end=this._io.pos;this._debug.queries.end=this._io.pos}if(this.flags.isOpcodeValid){this._debug.answers={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.answers.arr=[],this.answers=[];for(var t=0;t<this.ancount;t++)this._debug.answers.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.answers.push(new n(this._io,this,this._root)),this._debug.answers.arr[t].end=this._io.pos;this._debug.answers.end=this._io.pos}if(this.flags.isOpcodeValid){this._debug.authorities={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.authorities.arr=[],this.authorities=[];for(var t=0;t<this.nscount;t++)this._debug.authorities.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.authorities.push(new n(this._io,this,this._root)),this._debug.authorities.arr[t].end=this._io.pos;this._debug.authorities.end=this._io.pos}if(this.flags.isOpcodeValid){this._debug.additionals={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.additionals.arr=[],this.additionals=[];for(var t=0;t<this.arcount;t++)this._debug.additionals.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.additionals.push(new n(this._io,this,this._root)),this._debug.additionals.arr[t].end=this._io.pos;this._debug.additionals.end=this._io.pos}};var p=s.Address=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.ip={start:this._io.pos,ioOffset:this._io.byteOffset},this.ip=this._io.readBytes(4),this._debug.ip.end=this._io.pos},t})(),f=s.AddressV6=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.ipV6={start:this._io.pos,ioOffset:this._io.byteOffset},this.ipV6=this._io.readBytes(16),this._debug.ipV6.end=this._io.pos},t})(),n=s.Answer=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=new r(this._io,this,this._root),this._debug.name.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"DnsPacket.TypeType"},this.type=this._io.readU2be(),this._debug.type.end=this._io.pos,this._debug.answerClass={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"DnsPacket.ClassType"},this.answerClass=this._io.readU2be(),this._debug.answerClass.end=this._io.pos,this._debug.ttl={start:this._io.pos,ioOffset:this._io.byteOffset},this.ttl=this._io.readS4be(),this._debug.ttl.end=this._io.pos,this._debug.rdlength={start:this._io.pos,ioOffset:this._io.byteOffset},this.rdlength=this._io.readU2be(),this._debug.rdlength.end=this._io.pos,this._debug.payload={start:this._io.pos,ioOffset:this._io.byteOffset},this.type){case s.TypeType.A:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new p(i,this,this._root);break;case s.TypeType.AAAA:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new f(i,this,this._root);break;case s.TypeType.CNAME:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new r(i,this,this._root);break;case s.TypeType.MX:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new b(i,this,this._root);break;case s.TypeType.NS:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new r(i,this,this._root);break;case s.TypeType.PTR:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new r(i,this,this._root);break;case s.TypeType.SOA:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new u(i,this,this._root);break;case s.TypeType.SRV:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new m(i,this,this._root);break;case s.TypeType.TXT:this._raw_payload=this._io.readBytes(this.rdlength);var i=new _(this._raw_payload);this.payload=new v(i,this,this._root);break;default:this.payload=this._io.readBytes(this.rdlength);break}this._debug.payload.end=this._io.pos},t})(),u=s.AuthorityInfo=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.primaryNs={start:this._io.pos,ioOffset:this._io.byteOffset},this.primaryNs=new r(this._io,this,this._root),this._debug.primaryNs.end=this._io.pos,this._debug.responsibleMailbox={start:this._io.pos,ioOffset:this._io.byteOffset},this.responsibleMailbox=new r(this._io,this,this._root),this._debug.responsibleMailbox.end=this._io.pos,this._debug.serial={start:this._io.pos,ioOffset:this._io.byteOffset},this.serial=this._io.readU4be(),this._debug.serial.end=this._io.pos,this._debug.refreshInterval={start:this._io.pos,ioOffset:this._io.byteOffset},this.refreshInterval=this._io.readU4be(),this._debug.refreshInterval.end=this._io.pos,this._debug.retryInterval={start:this._io.pos,ioOffset:this._io.byteOffset},this.retryInterval=this._io.readU4be(),this._debug.retryInterval.end=this._io.pos,this._debug.expireLimit={start:this._io.pos,ioOffset:this._io.byteOffset},this.expireLimit=this._io.readU4be(),this._debug.expireLimit.end=this._io.pos,this._debug.minTtl={start:this._io.pos,ioOffset:this._io.byteOffset},this.minTtl=this._io.readU4be(),this._debug.minTtl.end=this._io.pos},t})(),r=s.DomainName=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.name.arr=[],this.name=[];do{this._debug.name.arr[this.name.length]={start:this._io.pos,ioOffset:this._io.byteOffset};var i=new y(this._io,this,this._root);this.name.push(i),this._debug.name.arr[this.name.length-1].end=this._io.pos}while(!(i.length==0||i.length>=192));this._debug.name.end=this._io.pos},t})(),y=s.Label=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.length={start:this._io.pos,ioOffset:this._io.byteOffset},this.length=this._io.readU1(),this._debug.length.end=this._io.pos,this.isPointer&&(this._debug.pointer={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointer=new g(this._io,this,this._root),this._debug.pointer.end=this._io.pos),this.isPointer||(this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=_.bytesToStr(this._io.readBytes(this.length),"UTF-8"),this._debug.name.end=this._io.pos)},Object.defineProperty(t.prototype,"isPointer",{get:function(){return this._m_isPointer!==void 0?this._m_isPointer:(this._debug._m_isPointer={},this._m_isPointer=this.length>=192,this._m_isPointer)}}),t})(),b=s.MxInfo=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.preference={start:this._io.pos,ioOffset:this._io.byteOffset},this.preference=this._io.readU2be(),this._debug.preference.end=this._io.pos,this._debug.mx={start:this._io.pos,ioOffset:this._io.byteOffset},this.mx=new r(this._io,this,this._root),this._debug.mx.end=this._io.pos},t})(),c=s.PacketFlags=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.flag={start:this._io.pos,ioOffset:this._io.byteOffset},this.flag=this._io.readU2be(),this._debug.flag.end=this._io.pos},Object.defineProperty(t.prototype,"aa",{get:function(){return this._m_aa!==void 0?this._m_aa:(this._debug._m_aa={},this._m_aa=(this.flag&1024)>>>10,this._m_aa)}}),Object.defineProperty(t.prototype,"ad",{get:function(){return this._m_ad!==void 0?this._m_ad:(this._debug._m_ad={},this._m_ad=(this.flag&32)>>>5,this._m_ad)}}),Object.defineProperty(t.prototype,"cd",{get:function(){return this._m_cd!==void 0?this._m_cd:(this._debug._m_cd={},this._m_cd=(this.flag&16)>>>4,this._m_cd)}}),Object.defineProperty(t.prototype,"isOpcodeValid",{get:function(){return this._m_isOpcodeValid!==void 0?this._m_isOpcodeValid:(this._debug._m_isOpcodeValid={},this._m_isOpcodeValid=this.opcode==0||this.opcode==1||this.opcode==2,this._m_isOpcodeValid)}}),Object.defineProperty(t.prototype,"opcode",{get:function(){return this._m_opcode!==void 0?this._m_opcode:(this._debug._m_opcode={},this._m_opcode=(this.flag&30720)>>>11,this._m_opcode)}}),Object.defineProperty(t.prototype,"qr",{get:function(){return this._m_qr!==void 0?this._m_qr:(this._debug._m_qr={},this._m_qr=(this.flag&32768)>>>15,this._m_qr)}}),Object.defineProperty(t.prototype,"ra",{get:function(){return this._m_ra!==void 0?this._m_ra:(this._debug._m_ra={},this._m_ra=(this.flag&128)>>>7,this._m_ra)}}),Object.defineProperty(t.prototype,"rcode",{get:function(){return this._m_rcode!==void 0?this._m_rcode:(this._debug._m_rcode={},this._m_rcode=(this.flag&15)>>>0,this._m_rcode)}}),Object.defineProperty(t.prototype,"rd",{get:function(){return this._m_rd!==void 0?this._m_rd:(this._debug._m_rd={},this._m_rd=(this.flag&256)>>>8,this._m_rd)}}),Object.defineProperty(t.prototype,"tc",{get:function(){return this._m_tc!==void 0?this._m_tc:(this._debug._m_tc={},this._m_tc=(this.flag&512)>>>9,this._m_tc)}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._m_z!==void 0?this._m_z:(this._debug._m_z={},this._m_z=(this.flag&64)>>>6,this._m_z)}}),t})(),g=s.PointerStruct=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.value=this._io.readU1(),this._debug.value.end=this._io.pos},Object.defineProperty(t.prototype,"contents",{get:function(){if(this._m_contents!==void 0)return this._m_contents;var i=this._root._io,e=i.pos;return i.seek(this.value+(this._parent.length-192<<8)),this._debug._m_contents={start:i.pos,ioOffset:i.byteOffset},this._m_contents=new r(i,this,this._root),this._debug._m_contents.end=i.pos,i.seek(e),this._m_contents}}),t})(),l=s.Query=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=new r(this._io,this,this._root),this._debug.name.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"DnsPacket.TypeType"},this.type=this._io.readU2be(),this._debug.type.end=this._io.pos,this._debug.queryClass={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"DnsPacket.ClassType"},this.queryClass=this._io.readU2be(),this._debug.queryClass.end=this._io.pos},t})(),m=s.Service=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.priority={start:this._io.pos,ioOffset:this._io.byteOffset},this.priority=this._io.readU2be(),this._debug.priority.end=this._io.pos,this._debug.weight={start:this._io.pos,ioOffset:this._io.byteOffset},this.weight=this._io.readU2be(),this._debug.weight.end=this._io.pos,this._debug.port={start:this._io.pos,ioOffset:this._io.byteOffset},this.port=this._io.readU2be(),this._debug.port.end=this._io.pos,this._debug.target={start:this._io.pos,ioOffset:this._io.byteOffset},this.target=new r(this._io,this,this._root),this._debug.target.end=this._io.pos},t})(),O=s.Txt=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){this._debug.length={start:this._io.pos,ioOffset:this._io.byteOffset},this.length=this._io.readU1(),this._debug.length.end=this._io.pos,this._debug.text={start:this._io.pos,ioOffset:this._io.byteOffset},this.text=_.bytesToStr(this._io.readBytes(this.length),"UTF-8"),this._debug.text.end=this._io.pos},t})(),v=s.TxtBody=(function(){function t(i,e,o){this._io=i,this._parent=e,this._root=o,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.data.arr=[],this.data=[];!this._io.isEof();)this._debug.data.arr[this.data.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.data.push(new O(this._io,this,this._root)),this._debug.data.arr[this.data.length-1].end=this._io.pos;this._debug.data.end=this._io.pos},t})();return s})();h.DnsPacket=d})}});const k=x(),A={id:"dns_packet",title:"DNS (Domain Name Service) packet",ksy:{meta:{id:"dns_packet",title:"DNS (Domain Name Service) packet",xref:{rfc:1035,wikidata:"Q8767"},license:"CC0-1.0",encoding:"utf-8",endian:"be"},doc:`(No support for Auth-Name + Add-Name for simplicity)
`,seq:[{id:"transaction_id",doc:"ID to keep track of request/responses",type:"u2"},{id:"flags",type:"packet_flags"},{id:"qdcount",doc:"How many questions are there",if:"flags.is_opcode_valid",type:"u2"},{id:"ancount",doc:"Number of resource records answering the question",if:"flags.is_opcode_valid",type:"u2"},{id:"nscount",doc:"Number of resource records pointing toward an authority",if:"flags.is_opcode_valid",type:"u2"},{id:"arcount",doc:"Number of resource records holding additional information",if:"flags.is_opcode_valid",type:"u2"},{id:"queries",if:"flags.is_opcode_valid",type:"query",repeat:"expr","repeat-expr":"qdcount"},{id:"answers",if:"flags.is_opcode_valid",type:"answer",repeat:"expr","repeat-expr":"ancount"},{id:"authorities",if:"flags.is_opcode_valid",type:"answer",repeat:"expr","repeat-expr":"nscount"},{id:"additionals",if:"flags.is_opcode_valid",type:"answer",repeat:"expr","repeat-expr":"arcount"}],types:{query:{seq:[{id:"name",type:"domain_name"},{id:"type",type:"u2",enum:"type_type"},{id:"query_class",type:"u2",enum:"class_type"}]},answer:{seq:[{id:"name",type:"domain_name"},{id:"type",type:"u2",enum:"type_type"},{id:"answer_class",type:"u2",enum:"class_type"},{id:"ttl",doc:"Time to live (in seconds)",type:"s4"},{id:"rdlength",doc:"Length in octets of the following payload",type:"u2"},{id:"payload",size:"rdlength",type:{"switch-on":"type",cases:{"type_type::ptr":"domain_name","type_type::a":"address","type_type::aaaa":"address_v6","type_type::cname":"domain_name","type_type::soa":"authority_info","type_type::mx":"mx_info","type_type::ns":"domain_name","type_type::srv":"service","type_type::txt":"txt_body"}}}]},domain_name:{seq:[{id:"name",type:"label",repeat:"until",doc:"Repeat until the length is 0 or it is a pointer (bit-hack to get around lack of OR operator)","repeat-until":"_.length == 0 or _.length >= 192"}]},label:{seq:[{id:"length",doc:"RFC1035 4.1.4: If the first two bits are raised it's a pointer-offset to a previously defined name",type:"u1"},{id:"pointer",if:"is_pointer",type:"pointer_struct"},{id:"name",if:"not is_pointer",doc:"Otherwise its a string the length of the length value",type:"str",size:"length"}],instances:{is_pointer:{value:"length >= 192"}}},pointer_struct:{seq:[{id:"value",doc:"Read one byte, then offset to that position, read one domain-name and return",type:"u1"}],instances:{contents:{io:"_root._io",pos:"value + ((_parent.length - 192) << 8)",type:"domain_name"}}},address:{seq:[{id:"ip",size:4}]},address_v6:{seq:[{id:"ip_v6",size:16}]},packet_flags:{seq:[{id:"flag",type:"u2"}],instances:{qr:{value:"(flag & 0b1000_0000_0000_0000) >> 15"},opcode:{value:"(flag & 0b0111_1000_0000_0000) >> 11"},aa:{value:"(flag & 0b0000_0100_0000_0000) >> 10"},tc:{value:"(flag & 0b0000_0010_0000_0000) >> 9"},rd:{value:"(flag & 0b0000_0001_0000_0000) >> 8"},ra:{value:"(flag & 0b0000_0000_1000_0000) >> 7"},z:{value:"(flag & 0b0000_0000_0100_0000) >> 6"},ad:{value:"(flag & 0b0000_0000_0010_0000) >> 5"},cd:{value:"(flag & 0b0000_0000_0001_0000) >> 4"},rcode:{value:"(flag & 0b0000_0000_0000_1111) >> 0"},is_opcode_valid:{value:"opcode == 0 or opcode == 1 or opcode == 2"}}},service:{seq:[{id:"priority",type:"u2"},{id:"weight",type:"u2"},{id:"port",type:"u2"},{id:"target",type:"domain_name"}]},txt:{seq:[{id:"length",type:"u1"},{id:"text",type:"str",size:"length"}]},txt_body:{seq:[{id:"data",type:"txt",repeat:"eos"}]},authority_info:{seq:[{id:"primary_ns",type:"domain_name"},{id:"responsible_mailbox",type:"domain_name"},{id:"serial",type:"u4"},{id:"refresh_interval",type:"u4"},{id:"retry_interval",type:"u4"},{id:"expire_limit",type:"u4"},{id:"min_ttl",type:"u4"}]},mx_info:{seq:[{id:"preference",type:"u2"},{id:"mx",type:"domain_name"}]}},enums:{class_type:{1:"in_class",2:"cs",3:"ch",4:"hs"},type_type:{1:"a",2:"ns",3:"md",4:"mf",5:"cname",6:"soa",7:"mb",8:"mg",9:"mr",10:"null",11:"wks",12:"ptr",13:"hinfo",14:"minfo",15:"mx",16:"txt",28:"aaaa",33:"srv"}}}};export{k as default,A as spec};
