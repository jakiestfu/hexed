import{k as d}from"./index-DQZRlv-R.js";var l=Object.getOwnPropertyNames,u=(o,h)=>function(){return h||(0,o[l(o)[0]])((h={exports:{}}).exports,h),h.exports},p=u({"<stdin>"(o){(function(h,t){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],t):typeof o=="object"&&o!==null&&typeof o.nodeType!="number"?t(o,d.KaitaiStream):t(h.Xar||(h.Xar={}),h.KaitaiStream)})(typeof self<"u"?self:o,function(h,t){var a=(function(){s.ChecksumAlgorithmsApple=Object.freeze({NONE:0,SHA1:1,MD5:2,SHA256:3,SHA512:4,0:"NONE",1:"SHA1",2:"MD5",3:"SHA256",4:"SHA512"});function s(i,e,r){this._io=i,this._parent=e,this._root=r||this,this._debug={},this._read()}s.prototype._read=function(){this._debug.headerPrefix={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerPrefix=new c(this._io,this,this._root),this._debug.headerPrefix.end=this._io.pos,this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_header=this._io.readBytes(this.headerPrefix.lenHeader-6);var i=new t(this._raw_header);this.header=new _(i,this,this._root),this._debug.header.end=this._io.pos,this._debug.toc={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__raw_toc=this._io.readBytes(this.header.lenTocCompressed),this._raw_toc=t.processZlib(this._raw__raw_toc);var e=new t(this._raw_toc);this.toc=new m(e,this,this._root),this._debug.toc.end=this._io.pos};var _=s.FileHeader=(function(){function i(e,r,n){this._io=e,this._parent=r,this._root=n,this._debug={},this._read()}return i.prototype._read=function(){if(this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU2be(),this._debug.version.end=this._io.pos,this.version!=1){var e=new t.ValidationNotEqualError(1,this.version,this._io,"/types/file_header/seq/0");throw this._debug.version.validationError=e,e}if(this._debug.lenTocCompressed={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenTocCompressed=this._io.readU8be(),this._debug.lenTocCompressed.end=this._io.pos,this._debug.tocLengthUncompressed={start:this._io.pos,ioOffset:this._io.byteOffset},this.tocLengthUncompressed=this._io.readU8be(),this._debug.tocLengthUncompressed.end=this._io.pos,this._debug.checksumAlgorithmInt={start:this._io.pos,ioOffset:this._io.byteOffset},this.checksumAlgorithmInt=this._io.readU4be(),this._debug.checksumAlgorithmInt.end=this._io.pos,this.hasChecksumAlgName){this._debug.checksumAlgName={start:this._io.pos,ioOffset:this._io.byteOffset},this.checksumAlgName=t.bytesToStr(t.bytesTerminate(this._io.readBytesFull(),0,!1),"UTF-8"),this._debug.checksumAlgName.end=this._io.pos;var r=this.checksumAlgName;if(!(r!=""&&r!="none")){var e=new t.ValidationExprError(this.checksumAlgName,this._io,"/types/file_header/seq/4");throw this._debug.checksumAlgName.validationError=e,e}}},Object.defineProperty(i.prototype,"checksumAlgorithmName",{get:function(){return this._m_checksumAlgorithmName!==void 0?this._m_checksumAlgorithmName:(this._debug._m_checksumAlgorithmName={},this._m_checksumAlgorithmName=this.hasChecksumAlgName?this.checksumAlgName:this.checksumAlgorithmInt==s.ChecksumAlgorithmsApple.NONE?"none":this.checksumAlgorithmInt==s.ChecksumAlgorithmsApple.SHA1?"sha1":this.checksumAlgorithmInt==s.ChecksumAlgorithmsApple.MD5?"md5":this.checksumAlgorithmInt==s.ChecksumAlgorithmsApple.SHA256?"sha256":this.checksumAlgorithmInt==s.ChecksumAlgorithmsApple.SHA512?"sha512":"",this._m_checksumAlgorithmName)}}),Object.defineProperty(i.prototype,"hasChecksumAlgName",{get:function(){return this._m_hasChecksumAlgName!==void 0?this._m_hasChecksumAlgName:(this._debug._m_hasChecksumAlgName={},this._m_hasChecksumAlgName=this.checksumAlgorithmInt==this._root.checksumAlgorithmOther&&this.lenHeader>=32&&t.mod(this.lenHeader,4)==0,this._m_hasChecksumAlgName)}}),Object.defineProperty(i.prototype,"lenHeader",{get:function(){return this._m_lenHeader!==void 0?this._m_lenHeader:(this._debug._m_lenHeader={},this._m_lenHeader=this._root.headerPrefix.lenHeader,this._m_lenHeader)}}),i})(),c=s.FileHeaderPrefix=(function(){function i(e,r,n){this._io=e,this._parent=r,this._root=n,this._debug={},this._read()}return i.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,t.byteArrayCompare(this.magic,new Uint8Array([120,97,114,33]))!=0){var e=new t.ValidationNotEqualError(new Uint8Array([120,97,114,33]),this.magic,this._io,"/types/file_header_prefix/seq/0");throw this._debug.magic.validationError=e,e}this._debug.lenHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenHeader=this._io.readU2be(),this._debug.lenHeader.end=this._io.pos},i})(),m=s.TocType=(function(){function i(e,r,n){this._io=e,this._parent=r,this._root=n,this._debug={},this._read()}return i.prototype._read=function(){this._debug.xmlString={start:this._io.pos,ioOffset:this._io.byteOffset},this.xmlString=t.bytesToStr(this._io.readBytesFull(),"UTF-8"),this._debug.xmlString.end=this._io.pos},i})();return Object.defineProperty(s.prototype,"checksumAlgorithmOther",{get:function(){return this._m_checksumAlgorithmOther!==void 0?this._m_checksumAlgorithmOther:(this._debug._m_checksumAlgorithmOther={},this._m_checksumAlgorithmOther=3,this._m_checksumAlgorithmOther)}}),s})();h.Xar=a})}});const f=p(),b={id:"xar",title:"XAR (eXtensible ARchive)",ksy:{meta:{id:"xar",title:"XAR (eXtensible ARchive)","file-extension":["xar","pkg","xip"],xref:{justsolve:"Xar_(Extensible_Archive)",mime:"application/x-xar",pronom:"fmt/600",wikidata:"Q1093556"},license:"CC0-1.0","ks-version":.9,encoding:"UTF-8",endian:"be"},doc:`From [Wikipedia](https://en.wikipedia.org/wiki/Xar_(archiver)):

"XAR (short for eXtensible ARchive format) is an open source file archiver
and the archiver's file format. It was created within the OpenDarwin project
and is used in macOS X 10.5 and up for software installation routines, as
well as browser extensions in Safari 5.0 and up."
`,"doc-ref":"https://github.com/mackyle/xar/wiki/xarformat",seq:[{id:"header_prefix",type:"file_header_prefix",doc:"internal; access `_root.header` instead"},{id:"header",size:"header_prefix.len_header - header_prefix._sizeof",type:"file_header"},{id:"toc",size:"header.len_toc_compressed",type:"toc_type",process:"zlib",doc:"zlib compressed XML further describing the content of the archive"}],instances:{checksum_algorithm_other:{"-orig-id":"XAR_CKSUM_OTHER",value:3,"doc-ref":"https://github.com/mackyle/xar/blob/66d451d/xar/include/xar.h.in#L85"}},types:{file_header_prefix:{seq:[{id:"magic",contents:"xar!"},{id:"len_header",type:"u2",doc:"internal; access `_root.header.len_header` instead"}]},file_header:{seq:[{id:"version",type:"u2",valid:1},{id:"len_toc_compressed","-orig-id":"toc_length_compressed",type:"u8"},{id:"toc_length_uncompressed",type:"u8"},{id:"checksum_algorithm_int",type:"u4",doc:"internal; access `checksum_algorithm_name` instead"},{id:"checksum_alg_name","size-eos":!0,type:"strz",valid:{expr:'_ != "" and _ != "none"'},if:"has_checksum_alg_name",doc:"internal; access `checksum_algorithm_name` instead"}],instances:{checksum_algorithm_name:{value:`has_checksum_alg_name ? checksum_alg_name
: checksum_algorithm_int == checksum_algorithms_apple::none.to_i ? "none"
: checksum_algorithm_int == checksum_algorithms_apple::sha1.to_i ? "sha1"
: checksum_algorithm_int == checksum_algorithms_apple::md5.to_i ? "md5"
: checksum_algorithm_int == checksum_algorithms_apple::sha256.to_i ? "sha256"
: checksum_algorithm_int == checksum_algorithms_apple::sha512.to_i ? "sha512"
: ""
`,doc:'If it is not\n\n* `""` (empty string), indicating an unknown integer value (access\n  `checksum_algorithm_int` for debugging purposes to find out\n  what that value is), or\n* `"none"`, indicating that the TOC checksum is not provided (in that\n  case, the `<checksum>` property or its `style` attribute should be\n  missing, or the `style` attribute must be set to `"none"`),\n\nit must exactly match the `style` attribute value of the\n`<checksum>` property in the root node `<toc>`. See\n<https://github.com/mackyle/xar/blob/66d451d/xar/lib/archive.c#L345-L371>\nfor reference.\n\nThe `xar` (eXtensible ARchiver) program [uses OpenSSL\'s function\n`EVP_get_digestbyname`](\n  https://github.com/mackyle/xar/blob/66d451d/xar/lib/archive.c#L328\n) to verify this value (if it\'s not `""` or `"none"`, of course).\nSo it\'s reasonable to assume that this can only have one of the values\nthat OpenSSL recognizes.\n'},has_checksum_alg_name:{value:`checksum_algorithm_int == _root.checksum_algorithm_other
and len_header >= 32
and len_header % 4 == 0
`},len_header:{value:"_root.header_prefix.len_header"}}},toc_type:{seq:[{id:"xml_string",type:"str","size-eos":!0}]}},enums:{checksum_algorithms_apple:{0:"none",1:"sha1",2:"md5",3:"sha256",4:"sha512"}}}};export{f as default,b as spec};
