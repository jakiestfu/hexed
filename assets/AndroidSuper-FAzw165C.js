import{k as c}from"./index-COA_x_BK.js";var O=Object.getOwnPropertyNames,S=(f,d)=>function(){return d||(0,f[O(f)[0]])((d={exports:{}}).exports,d),d.exports},k=S({"<stdin>"(f){(function(d,t){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],t):typeof f=="object"&&f!==null&&typeof f.nodeType!="number"?t(f,c.KaitaiStream):t(d.AndroidSuper||(d.AndroidSuper={}),d.KaitaiStream)})(typeof self<"u"?self:f,function(d,t){var g=(function(){function r(s,h,n){this._io=s,this._parent=h,this._root=n||this,this._debug={},this._read()}r.prototype._read=function(){};var b=r.Geometry=(function(){function s(h,n,o){this._io=h,this._parent=n,this._root=o,this._debug={},this._read()}return s.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,t.byteArrayCompare(this.magic,new Uint8Array([103,68,108,97]))!=0){var h=new t.ValidationNotEqualError(new Uint8Array([103,68,108,97]),this.magic,this._io,"/types/geometry/seq/0");throw this._debug.magic.validationError=h,h}this._debug.structSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.structSize=this._io.readU4le(),this._debug.structSize.end=this._io.pos,this._debug.checksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.checksum=this._io.readBytes(32),this._debug.checksum.end=this._io.pos,this._debug.metadataMaxSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.metadataMaxSize=this._io.readU4le(),this._debug.metadataMaxSize.end=this._io.pos,this._debug.metadataSlotCount={start:this._io.pos,ioOffset:this._io.byteOffset},this.metadataSlotCount=this._io.readU4le(),this._debug.metadataSlotCount.end=this._io.pos,this._debug.logicalBlockSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.logicalBlockSize=this._io.readU4le(),this._debug.logicalBlockSize.end=this._io.pos},s})(),y=r.Metadata=(function(){s.TableKind=Object.freeze({PARTITIONS:0,EXTENTS:1,GROUPS:2,BLOCK_DEVICES:3,0:"PARTITIONS",1:"EXTENTS",2:"GROUPS",3:"BLOCK_DEVICES"});function s(e,_,i){this._io=e,this._parent=_,this._root=i,this._debug={},this._read()}s.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,t.byteArrayCompare(this.magic,new Uint8Array([48,80,76,65]))!=0){var e=new t.ValidationNotEqualError(new Uint8Array([48,80,76,65]),this.magic,this._io,"/types/metadata/seq/0");throw this._debug.magic.validationError=e,e}this._debug.majorVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.majorVersion=this._io.readU2le(),this._debug.majorVersion.end=this._io.pos,this._debug.minorVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minorVersion=this._io.readU2le(),this._debug.minorVersion.end=this._io.pos,this._debug.headerSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerSize=this._io.readU4le(),this._debug.headerSize.end=this._io.pos,this._debug.headerChecksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerChecksum=this._io.readBytes(32),this._debug.headerChecksum.end=this._io.pos,this._debug.tablesSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.tablesSize=this._io.readU4le(),this._debug.tablesSize.end=this._io.pos,this._debug.tablesChecksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.tablesChecksum=this._io.readBytes(32),this._debug.tablesChecksum.end=this._io.pos,this._debug.partitions={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitions=new p(this._io,this,this._root,r.Metadata.TableKind.PARTITIONS),this._debug.partitions.end=this._io.pos,this._debug.extents={start:this._io.pos,ioOffset:this._io.byteOffset},this.extents=new p(this._io,this,this._root,r.Metadata.TableKind.EXTENTS),this._debug.extents.end=this._io.pos,this._debug.groups={start:this._io.pos,ioOffset:this._io.byteOffset},this.groups=new p(this._io,this,this._root,r.Metadata.TableKind.GROUPS),this._debug.groups.end=this._io.pos,this._debug.blockDevices={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockDevices=new p(this._io,this,this._root,r.Metadata.TableKind.BLOCK_DEVICES),this._debug.blockDevices.end=this._io.pos};var h=s.BlockDevice=(function(){function e(_,i,a){this._io=_,this._parent=i,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){this._debug.firstLogicalSector={start:this._io.pos,ioOffset:this._io.byteOffset},this.firstLogicalSector=this._io.readU8le(),this._debug.firstLogicalSector.end=this._io.pos,this._debug.alignment={start:this._io.pos,ioOffset:this._io.byteOffset},this.alignment=this._io.readU4le(),this._debug.alignment.end=this._io.pos,this._debug.alignmentOffset={start:this._io.pos,ioOffset:this._io.byteOffset},this.alignmentOffset=this._io.readU4le(),this._debug.alignmentOffset.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readU8le(),this._debug.size.end=this._io.pos,this._debug.partitionName={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionName=t.bytesToStr(t.bytesTerminate(this._io.readBytes(36),0,!1),"UTF-8"),this._debug.partitionName.end=this._io.pos,this._debug.flagSlotSuffixed={start:this._io.pos,ioOffset:this._io.byteOffset},this.flagSlotSuffixed=this._io.readBitsIntLe(1)!=0,this._debug.flagSlotSuffixed.end=this._io.pos,this._debug.flagsReserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.flagsReserved=this._io.readBitsIntLe(31),this._debug.flagsReserved.end=this._io.pos},e})(),n=s.Extent=(function(){e.TargetType=Object.freeze({LINEAR:0,ZERO:1,0:"LINEAR",1:"ZERO"});function e(_,i,a){this._io=_,this._parent=i,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){this._debug.numSectors={start:this._io.pos,ioOffset:this._io.byteOffset},this.numSectors=this._io.readU8le(),this._debug.numSectors.end=this._io.pos,this._debug.targetType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"AndroidSuper.Metadata.Extent.TargetType"},this.targetType=this._io.readU4le(),this._debug.targetType.end=this._io.pos,this._debug.targetData={start:this._io.pos,ioOffset:this._io.byteOffset},this.targetData=this._io.readU8le(),this._debug.targetData.end=this._io.pos,this._debug.targetSource={start:this._io.pos,ioOffset:this._io.byteOffset},this.targetSource=this._io.readU4le(),this._debug.targetSource.end=this._io.pos},e})(),o=s.Group=(function(){function e(_,i,a){this._io=_,this._parent=i,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=t.bytesToStr(t.bytesTerminate(this._io.readBytes(36),0,!1),"UTF-8"),this._debug.name.end=this._io.pos,this._debug.flagSlotSuffixed={start:this._io.pos,ioOffset:this._io.byteOffset},this.flagSlotSuffixed=this._io.readBitsIntLe(1)!=0,this._debug.flagSlotSuffixed.end=this._io.pos,this._debug.flagsReserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.flagsReserved=this._io.readBitsIntLe(31),this._debug.flagsReserved.end=this._io.pos,this._io.alignToByte(),this._debug.maximumSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.maximumSize=this._io.readU8le(),this._debug.maximumSize.end=this._io.pos},e})(),u=s.Partition=(function(){function e(_,i,a){this._io=_,this._parent=i,this._root=a,this._debug={},this._read()}return e.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=t.bytesToStr(t.bytesTerminate(this._io.readBytes(36),0,!1),"UTF-8"),this._debug.name.end=this._io.pos,this._debug.attrReadonly={start:this._io.pos,ioOffset:this._io.byteOffset},this.attrReadonly=this._io.readBitsIntLe(1)!=0,this._debug.attrReadonly.end=this._io.pos,this._debug.attrSlotSuffixed={start:this._io.pos,ioOffset:this._io.byteOffset},this.attrSlotSuffixed=this._io.readBitsIntLe(1)!=0,this._debug.attrSlotSuffixed.end=this._io.pos,this._debug.attrUpdated={start:this._io.pos,ioOffset:this._io.byteOffset},this.attrUpdated=this._io.readBitsIntLe(1)!=0,this._debug.attrUpdated.end=this._io.pos,this._debug.attrDisabled={start:this._io.pos,ioOffset:this._io.byteOffset},this.attrDisabled=this._io.readBitsIntLe(1)!=0,this._debug.attrDisabled.end=this._io.pos,this._debug.attrsReserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.attrsReserved=this._io.readBitsIntLe(28),this._debug.attrsReserved.end=this._io.pos,this._io.alignToByte(),this._debug.firstExtentIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.firstExtentIndex=this._io.readU4le(),this._debug.firstExtentIndex.end=this._io.pos,this._debug.numExtents={start:this._io.pos,ioOffset:this._io.byteOffset},this.numExtents=this._io.readU4le(),this._debug.numExtents.end=this._io.pos,this._debug.groupIndex={start:this._io.pos,ioOffset:this._io.byteOffset},this.groupIndex=this._io.readU4le(),this._debug.groupIndex.end=this._io.pos},e})(),p=s.TableDescriptor=(function(){function e(_,i,a,l){this._io=_,this._parent=i,this._root=a,this.kind=l,this._debug={},this._read()}return e.prototype._read=function(){this._debug.offset={start:this._io.pos,ioOffset:this._io.byteOffset},this.offset=this._io.readU4le(),this._debug.offset.end=this._io.pos,this._debug.numEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this.numEntries=this._io.readU4le(),this._debug.numEntries.end=this._io.pos,this._debug.entrySize={start:this._io.pos,ioOffset:this._io.byteOffset},this.entrySize=this._io.readU4le(),this._debug.entrySize.end=this._io.pos},Object.defineProperty(e.prototype,"table",{get:function(){if(this._m_table!==void 0)return this._m_table;var _=this._io.pos;this._io.seek(this._parent.headerSize+this.offset),this._debug._m_table={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug._m_table.arr=[],this._raw__m_table=[],this._m_table=[];for(var i=0;i<this.numEntries;i++){switch(this._debug._m_table.arr[i]={start:this._io.pos,ioOffset:this._io.byteOffset},this.kind){case r.Metadata.TableKind.BLOCK_DEVICES:this._raw__m_table.push(this._io.readBytes(this.entrySize));var a=new t(this._raw__m_table[i]);this._m_table.push(new h(a,this,this._root));break;case r.Metadata.TableKind.EXTENTS:this._raw__m_table.push(this._io.readBytes(this.entrySize));var a=new t(this._raw__m_table[i]);this._m_table.push(new n(a,this,this._root));break;case r.Metadata.TableKind.GROUPS:this._raw__m_table.push(this._io.readBytes(this.entrySize));var a=new t(this._raw__m_table[i]);this._m_table.push(new o(a,this,this._root));break;case r.Metadata.TableKind.PARTITIONS:this._raw__m_table.push(this._io.readBytes(this.entrySize));var a=new t(this._raw__m_table[i]);this._m_table.push(new u(a,this,this._root));break;default:this._m_table.push(this._io.readBytes(this.entrySize));break}this._debug._m_table.arr[i].end=this._io.pos}return this._debug._m_table.end=this._io.pos,this._io.seek(_),this._m_table}}),e})();return s})(),m=r.Root=(function(){function s(h,n,o){this._io=h,this._parent=n,this._root=o,this._debug={},this._read()}return s.prototype._read=function(){this._debug.primaryGeometry={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_primaryGeometry=this._io.readBytes(4096);var h=new t(this._raw_primaryGeometry);this.primaryGeometry=new b(h,this,this._root),this._debug.primaryGeometry.end=this._io.pos,this._debug.backupGeometry={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_backupGeometry=this._io.readBytes(4096);var n=new t(this._raw_backupGeometry);this.backupGeometry=new b(n,this,this._root),this._debug.backupGeometry.end=this._io.pos,this._debug.primaryMetadata={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.primaryMetadata.arr=[],this._raw_primaryMetadata=[],this.primaryMetadata=[];for(var o=0;o<this.primaryGeometry.metadataSlotCount;o++){this._debug.primaryMetadata.arr[o]={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_primaryMetadata.push(this._io.readBytes(this.primaryGeometry.metadataMaxSize));var u=new t(this._raw_primaryMetadata[o]);this.primaryMetadata.push(new y(u,this,this._root)),this._debug.primaryMetadata.arr[o].end=this._io.pos}this._debug.primaryMetadata.end=this._io.pos,this._debug.backupMetadata={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.backupMetadata.arr=[],this._raw_backupMetadata=[],this.backupMetadata=[];for(var o=0;o<this.primaryGeometry.metadataSlotCount;o++){this._debug.backupMetadata.arr[o]={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_backupMetadata.push(this._io.readBytes(this.primaryGeometry.metadataMaxSize));var p=new t(this._raw_backupMetadata[o]);this.backupMetadata.push(new y(p,this,this._root)),this._debug.backupMetadata.arr[o].end=this._io.pos}this._debug.backupMetadata.end=this._io.pos},s})();return Object.defineProperty(r.prototype,"root",{get:function(){if(this._m_root!==void 0)return this._m_root;var s=this._io.pos;return this._io.seek(4096),this._debug._m_root={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_root=new m(this._io,this,this._root),this._debug._m_root.end=this._io.pos,this._io.seek(s),this._m_root}}),r})();d.AndroidSuper=g})}});const x=k(),v={id:"android_super",title:"Android Dynamic Partitions metadata",ksy:{meta:{id:"android_super",title:"Android Dynamic Partitions metadata",application:"Android","file-extension":"img",tags:["android","filesystem"],license:"CC0-1.0","ks-version":.9,"bit-endian":"le",endian:"le"},doc:`The metadata stored by Android at the beginning of a "super" partition, which
is what it calls a disk partition that holds one or more Dynamic Partitions.
Dynamic Partitions do more or less the same thing that LVM does on Linux,
allowing Android to map ranges of non-contiguous extents to a single logical
device. This metadata holds that mapping.
`,"doc-ref":["https://source.android.com/docs/core/ota/dynamic_partitions","https://android.googlesource.com/platform/system/core/+/refs/tags/android-11.0.0_r8/fs_mgr/liblp/include/liblp/metadata_format.h"],instances:{root:{pos:4096,type:"root"}},types:{root:{seq:[{id:"primary_geometry",size:4096,type:"geometry"},{id:"backup_geometry",type:"geometry",size:4096},{id:"primary_metadata",size:"primary_geometry.metadata_max_size",type:"metadata",repeat:"expr","repeat-expr":"primary_geometry.metadata_slot_count"},{id:"backup_metadata",size:"primary_geometry.metadata_max_size",type:"metadata",repeat:"expr","repeat-expr":"primary_geometry.metadata_slot_count"}]},geometry:{seq:[{id:"magic",contents:"gDla"},{id:"struct_size",type:"u4"},{id:"checksum",size:32,doc:`SHA-256 hash of struct_size bytes from beginning of geometry,
calculated as if checksum were zeroed out
`},{id:"metadata_max_size",type:"u4"},{id:"metadata_slot_count",type:"u4"},{id:"logical_block_size",type:"u4"}]},metadata:{seq:[{id:"magic",contents:"0PLA"},{id:"major_version",type:"u2"},{id:"minor_version",type:"u2"},{id:"header_size",type:"u4"},{id:"header_checksum",size:32,doc:`SHA-256 hash of header_size bytes from beginning of metadata,
calculated as if header_checksum were zeroed out
`},{id:"tables_size",type:"u4"},{id:"tables_checksum",size:32,doc:"SHA-256 hash of tables_size bytes from end of header"},{id:"partitions",type:"table_descriptor(table_kind::partitions)"},{id:"extents",type:"table_descriptor(table_kind::extents)"},{id:"groups",type:"table_descriptor(table_kind::groups)"},{id:"block_devices",type:"table_descriptor(table_kind::block_devices)"}],enums:{table_kind:{0:"partitions",1:"extents",2:"groups",3:"block_devices"}},types:{table_descriptor:{params:[{id:"kind",type:"u1",enum:"table_kind","-affected-by":135}],seq:[{id:"offset",type:"u4"},{id:"num_entries",type:"u4"},{id:"entry_size",type:"u4"}],instances:{table:{pos:"_parent.header_size + offset",size:"entry_size",type:{"switch-on":"kind",cases:{"table_kind::partitions":"partition","table_kind::extents":"extent","table_kind::groups":"group","table_kind::block_devices":"block_device"}},repeat:"expr","repeat-expr":"num_entries"}}},partition:{seq:[{id:"name",size:36,type:"strz",encoding:"UTF-8"},{id:"attr_readonly",type:"b1"},{id:"attr_slot_suffixed",type:"b1"},{id:"attr_updated",type:"b1"},{id:"attr_disabled",type:"b1"},{id:"attrs_reserved",type:"b28"},{id:"first_extent_index",type:"u4"},{id:"num_extents",type:"u4"},{id:"group_index",type:"u4"}]},extent:{seq:[{id:"num_sectors",type:"u8"},{id:"target_type",type:"u4",enum:"target_type"},{id:"target_data",type:"u8"},{id:"target_source",type:"u4"}],enums:{target_type:{0:"linear",1:"zero"}}},group:{seq:[{id:"name",size:36,type:"strz",encoding:"UTF-8"},{id:"flag_slot_suffixed",type:"b1"},{id:"flags_reserved",type:"b31"},{id:"maximum_size",type:"u8"}]},block_device:{seq:[{id:"first_logical_sector",type:"u8"},{id:"alignment",type:"u4"},{id:"alignment_offset",type:"u4"},{id:"size",type:"u8"},{id:"partition_name",size:36,type:"strz",encoding:"UTF-8"},{id:"flag_slot_suffixed",type:"b1"},{id:"flags_reserved",type:"b31"}]}}}}}};export{x as default,v as spec};
