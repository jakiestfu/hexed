import{k as g}from"./index-LM5QM2-c.js";var l=Object.getOwnPropertyNames,b=(d,o)=>function(){return o||(0,d[l(d)[0]])((o={exports:{}}).exports,o),o.exports},y=b({"<stdin>"(d){(function(o,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof d=="object"&&d!==null&&typeof d.nodeType!="number"?s(d,g.KaitaiStream):s(o.WindowsEvtLog||(o.WindowsEvtLog={}),o.KaitaiStream)})(typeof self<"u"?self:d,function(o,s){var _=(function(){function n(t,e,i){this._io=t,this._parent=e,this._root=i||this,this._debug={},this._read()}n.prototype._read=function(){for(this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new f(this._io,this,this._root),this._debug.header.end=this._io.pos,this._debug.records={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.records.arr=[],this.records=[];!this._io.isEof();)this._debug.records.arr[this.records.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.records.push(new u(this._io,this,this._root)),this._debug.records.arr[this.records.length-1].end=this._io.pos;this._debug.records.end=this._io.pos};var a=n.CursorRecordBody=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(12),this._debug.magic.end=this._io.pos,s.byteArrayCompare(this.magic,new Uint8Array([34,34,34,34,51,51,51,51,68,68,68,68]))!=0){var e=new s.ValidationNotEqualError(new Uint8Array([34,34,34,34,51,51,51,51,68,68,68,68]),this.magic,this._io,"/types/cursor_record_body/seq/0");throw this._debug.magic.validationError=e,e}this._debug.ofsFirstRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsFirstRecord=this._io.readU4le(),this._debug.ofsFirstRecord.end=this._io.pos,this._debug.ofsNextRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsNextRecord=this._io.readU4le(),this._debug.ofsNextRecord.end=this._io.pos,this._debug.idxNextRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.idxNextRecord=this._io.readU4le(),this._debug.idxNextRecord.end=this._io.pos,this._debug.idxFirstRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.idxFirstRecord=this._io.readU4le(),this._debug.idxFirstRecord.end=this._io.pos},t})(),f=n.Header=(function(){function t(i,r,h){this._io=i,this._parent=r,this._root=h,this._debug={},this._read()}t.prototype._read=function(){if(this._debug.lenHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenHeader=this._io.readU4le(),this._debug.lenHeader.end=this._io.pos,this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,s.byteArrayCompare(this.magic,new Uint8Array([76,102,76,101]))!=0){var i=new s.ValidationNotEqualError(new Uint8Array([76,102,76,101]),this.magic,this._io,"/types/header/seq/1");throw this._debug.magic.validationError=i,i}this._debug.versionMajor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMajor=this._io.readU4le(),this._debug.versionMajor.end=this._io.pos,this._debug.versionMinor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMinor=this._io.readU4le(),this._debug.versionMinor.end=this._io.pos,this._debug.ofsStart={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStart=this._io.readU4le(),this._debug.ofsStart.end=this._io.pos,this._debug.ofsEnd={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsEnd=this._io.readU4le(),this._debug.ofsEnd.end=this._io.pos,this._debug.curRecIdx={start:this._io.pos,ioOffset:this._io.byteOffset},this.curRecIdx=this._io.readU4le(),this._debug.curRecIdx.end=this._io.pos,this._debug.oldestRecIdx={start:this._io.pos,ioOffset:this._io.byteOffset},this.oldestRecIdx=this._io.readU4le(),this._debug.oldestRecIdx.end=this._io.pos,this._debug.lenFileMax={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenFileMax=this._io.readU4le(),this._debug.lenFileMax.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=new e(this._io,this,this._root),this._debug.flags.end=this._io.pos,this._debug.retention={start:this._io.pos,ioOffset:this._io.byteOffset},this.retention=this._io.readU4le(),this._debug.retention.end=this._io.pos,this._debug.lenHeader2={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenHeader2=this._io.readU4le(),this._debug.lenHeader2.end=this._io.pos};var e=t.Flags=(function(){function i(r,h,c){this._io=r,this._parent=h,this._root=c,this._debug={},this._read()}return i.prototype._read=function(){this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBitsIntBe(28),this._debug.reserved.end=this._io.pos,this._debug.archive={start:this._io.pos,ioOffset:this._io.byteOffset},this.archive=this._io.readBitsIntBe(1)!=0,this._debug.archive.end=this._io.pos,this._debug.logFull={start:this._io.pos,ioOffset:this._io.byteOffset},this.logFull=this._io.readBitsIntBe(1)!=0,this._debug.logFull.end=this._io.pos,this._debug.wrap={start:this._io.pos,ioOffset:this._io.byteOffset},this.wrap=this._io.readBitsIntBe(1)!=0,this._debug.wrap.end=this._io.pos,this._debug.dirty={start:this._io.pos,ioOffset:this._io.byteOffset},this.dirty=this._io.readBitsIntBe(1)!=0,this._debug.dirty.end=this._io.pos},i})();return t})(),u=n.Record=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.lenRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenRecord=this._io.readU4le(),this._debug.lenRecord.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=this._io.readU4le(),this._debug.type.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.type){case 1699505740:this._raw_body=this._io.readBytes(this.lenRecord-12);var e=new s(this._raw_body);this.body=new p(e,this,this._root);break;case 286331153:this._raw_body=this._io.readBytes(this.lenRecord-12);var e=new s(this._raw_body);this.body=new a(e,this,this._root);break;default:this.body=this._io.readBytes(this.lenRecord-12);break}this._debug.body.end=this._io.pos,this._debug.lenRecord2={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenRecord2=this._io.readU4le(),this._debug.lenRecord2.end=this._io.pos},t})(),p=n.RecordBody=(function(){t.EventTypes=Object.freeze({ERROR:1,AUDIT_FAILURE:2,AUDIT_SUCCESS:3,INFO:4,WARNING:5,1:"ERROR",2:"AUDIT_FAILURE",3:"AUDIT_SUCCESS",4:"INFO",5:"WARNING"});function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.idx={start:this._io.pos,ioOffset:this._io.byteOffset},this.idx=this._io.readU4le(),this._debug.idx.end=this._io.pos,this._debug.timeGenerated={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeGenerated=this._io.readU4le(),this._debug.timeGenerated.end=this._io.pos,this._debug.timeWritten={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeWritten=this._io.readU4le(),this._debug.timeWritten.end=this._io.pos,this._debug.eventId={start:this._io.pos,ioOffset:this._io.byteOffset},this.eventId=this._io.readU4le(),this._debug.eventId.end=this._io.pos,this._debug.eventType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"WindowsEvtLog.RecordBody.EventTypes"},this.eventType=this._io.readU2le(),this._debug.eventType.end=this._io.pos,this._debug.numStrings={start:this._io.pos,ioOffset:this._io.byteOffset},this.numStrings=this._io.readU2le(),this._debug.numStrings.end=this._io.pos,this._debug.eventCategory={start:this._io.pos,ioOffset:this._io.byteOffset},this.eventCategory=this._io.readU2le(),this._debug.eventCategory.end=this._io.pos,this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBytes(6),this._debug.reserved.end=this._io.pos,this._debug.ofsStrings={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStrings=this._io.readU4le(),this._debug.ofsStrings.end=this._io.pos,this._debug.lenUserSid={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenUserSid=this._io.readU4le(),this._debug.lenUserSid.end=this._io.pos,this._debug.ofsUserSid={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsUserSid=this._io.readU4le(),this._debug.ofsUserSid.end=this._io.pos,this._debug.lenData={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenData=this._io.readU4le(),this._debug.lenData.end=this._io.pos,this._debug.ofsData={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsData=this._io.readU4le(),this._debug.ofsData.end=this._io.pos},Object.defineProperty(t.prototype,"data",{get:function(){if(this._m_data!==void 0)return this._m_data;var e=this._io.pos;return this._io.seek(this.ofsData-8),this._debug._m_data={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_data=this._io.readBytes(this.lenData),this._debug._m_data.end=this._io.pos,this._io.seek(e),this._m_data}}),Object.defineProperty(t.prototype,"userSid",{get:function(){if(this._m_userSid!==void 0)return this._m_userSid;var e=this._io.pos;return this._io.seek(this.ofsUserSid-8),this._debug._m_userSid={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_userSid=this._io.readBytes(this.lenUserSid),this._debug._m_userSid.end=this._io.pos,this._io.seek(e),this._m_userSid}}),t})();return n})();o.WindowsEvtLog=_})}});const v=y(),w={id:"windows_evt_log",title:"Windows Event Log (EVT)",ksy:{meta:{id:"windows_evt_log",title:"Windows Event Log (EVT)","file-extension":"evt",xref:{forensicswiki:"windows_event_log_(evt)",justsolve:"Windows_Event_Log"},tags:["windows","log"],license:"CC0-1.0","ks-version":.9,endian:"le"},doc:`EVT files are Windows Event Log files written by older Windows
operating systems (2000, XP, 2003). They are used as binary log
files by several major Windows subsystems and
applications. Typically, several of them can be found in
\`%WINDIR%\\system32\\config\` directory:

* Application = \`AppEvent.evt\`
* System = \`SysEvent.evt\`
* Security = \`SecEvent.evt\`

Alternatively, one can export any system event log as distinct .evt
file using relevant option in Event Viewer application.

A Windows application can submit an entry into these logs using
[ReportEventA](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-reporteventa)
function of Windows API.

Internally, EVT files consist of a fixed-size header and event
records. There are several usage scenarios (non-wrapping vs wrapping
log files) which result in slightly different organization of
records.
`,"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/eventlog/event-log-file-format",seq:[{id:"header",type:"header"},{id:"records",type:"record",repeat:"eos"}],types:{header:{"doc-ref":"https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/bb309024(v=vs.85)",seq:[{id:"len_header","-orig-id":"HeaderSize",type:"u4",doc:"Size of the header structure, must be 0x30."},{id:"magic","-orig-id":"Signature",contents:"LfLe"},{id:"version_major","-orig-id":"MajorVersion",type:"u4"},{id:"version_minor","-orig-id":"MinorVersion",type:"u4"},{id:"ofs_start","-orig-id":"StartOffset",type:"u4",doc:"Offset of oldest record kept in this log file."},{id:"ofs_end","-orig-id":"EndOffset",type:"u4",doc:"Offset of EOF log record, which is a placeholder for new record."},{id:"cur_rec_idx","-orig-id":"CurrentRecordNumber",type:"u4",doc:`Index of current record, where a new submission would be
written to (normally there should to EOF log record there).
`},{id:"oldest_rec_idx","-orig-id":"OldestRecordNumber",type:"u4",doc:"Index of oldest record in the log file"},{id:"len_file_max","-orig-id":"MaxSize",type:"u4",doc:"Total maximum size of the log file"},{id:"flags","-orig-id":"Flags",type:"flags"},{id:"retention","-orig-id":"Retention",type:"u4"},{id:"len_header_2","-orig-id":"EndHeaderSize",type:"u4",doc:"Size of the header structure repeated again, and again it must be 0x30."}],types:{flags:{seq:[{id:"reserved",type:"b28"},{id:"archive","-orig-id":"ELF_LOGFILE_ARCHIVE_SET",type:"b1",doc:"True if archive attribute has been set for this log file."},{id:"log_full","-orig-id":"ELF_LOGFILE_LOGFULL_WRITTEN",type:"b1",doc:"True if last write operation failed due to log being full."},{id:"wrap","-orig-id":"ELF_LOGFILE_HEADER_WRAP",type:"b1",doc:"True if wrapping of record has occurred."},{id:"dirty","-orig-id":"ELF_LOGFILE_HEADER_DIRTY",type:"b1",doc:`True if write operation was in progress, but log file
wasn't properly closed.
`}]}}},record:{"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-eventlogrecord",seq:[{id:"len_record","-orig-id":"Length",type:"u4",doc:"Size of whole record, including all headers, footers and data"},{id:"type","-orig-id":"Reserved",type:"u4",doc:`Type of record. Normal log records specify "LfLe"
(0x654c664c) in this field, cursor records use 0x11111111.
`},{id:"body",size:"len_record - 12",type:{"switch-on":"type",cases:{286331153:"cursor_record_body",1699505740:"record_body"}},doc:'Record body interpretation depends on type of record. Body\nsize is specified in a way that it won\'t include a 8-byte\n"header" (`len_record` + `type`) and a "footer"\n(`len_record2`).\n'},{id:"len_record2",type:"u4",doc:"Size of whole record again."}]},record_body:{"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-eventlogrecord",seq:[{id:"idx","-orig-id":"RecordNumber",type:"u4",doc:"Index of record in the file."},{id:"time_generated","-orig-id":"TimeGenerated",type:"u4",doc:"Time when this record was generated, POSIX timestamp format."},{id:"time_written","-orig-id":"TimeWritten",type:"u4",doc:"Time when this record was written into the log file, POSIX timestamp format."},{id:"event_id","-orig-id":"EventID",type:"u4",doc:`Identifier of an event, meaning is specific to particular
source of events / event type.
`},{id:"event_type","-orig-id":"EventType",type:"u2",enum:"event_types",doc:"Type of event.","doc-ref":"https://learn.microsoft.com/en-us/windows/win32/eventlog/event-types"},{id:"num_strings","-orig-id":"NumStrings",type:"u2",doc:"Number of strings present in the log."},{id:"event_category","-orig-id":"EventCategory",type:"u2","doc-ref":"https://learn.microsoft.com/en-us/windows/win32/eventlog/event-categories"},{id:"reserved","-orig-id":"ReservedFlags, ClosingRecordNumber",size:6},{id:"ofs_strings","-orig-id":"StringOffset",type:"u4",doc:"Offset of strings present in the log"},{id:"len_user_sid","-orig-id":"UserSidLength",type:"u4"},{id:"ofs_user_sid","-orig-id":"UserSidOffset",type:"u4"},{id:"len_data","-orig-id":"DataLength",type:"u4"},{id:"ofs_data","-orig-id":"DataOffset",type:"u4"}],instances:{user_sid:{pos:"ofs_user_sid - 8",size:"len_user_sid"},data:{pos:"ofs_data - 8",size:"len_data"}},enums:{event_types:{1:"error",2:"audit_failure",3:"audit_success",4:"info",5:"warning"}}},cursor_record_body:{"doc-ref":"https://forensics.wiki/windows_event_log_(evt)/#cursor-record",seq:[{id:"magic",contents:[34,34,34,34,51,51,51,51,68,68,68,68]},{id:"ofs_first_record",type:"u4"},{id:"ofs_next_record",type:"u4"},{id:"idx_next_record",type:"u4"},{id:"idx_first_record",type:"u4"}]}}}};export{v as default,w as spec};
