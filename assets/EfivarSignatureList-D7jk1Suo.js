import{k as f}from"./index-COmSdSC_.js";var c=Object.getOwnPropertyNames,x=(a,s)=>function(){return s||(0,a[c(a)[0]])((s={exports:{}}).exports,s),s.exports},g=x({"<stdin>"(a){(function(s,t){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],t):typeof a=="object"&&a!==null&&typeof a.nodeType!="number"?t(a,f.KaitaiStream):t(s.EfivarSignatureList||(s.EfivarSignatureList={}),s.KaitaiStream)})(typeof self<"u"?self:a,function(s,t){var h=(function(){function _(e,i,r){this._io=e,this._parent=i,this._root=r||this,this._debug={},this._read()}_.prototype._read=function(){for(this._debug.varAttributes={start:this._io.pos,ioOffset:this._io.byteOffset},this.varAttributes=new o(this._io,this,this._root),this._debug.varAttributes.end=this._io.pos,this._debug.signatures={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.signatures.arr=[],this.signatures=[];!this._io.isEof();)this._debug.signatures.arr[this.signatures.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.signatures.push(new u(this._io,this,this._root)),this._debug.signatures.arr[this.signatures.length-1].end=this._io.pos;this._debug.signatures.end=this._io.pos};var o=_.EfiVarAttr=(function(){function e(i,r,n){this._io=i,this._parent=r,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){this._debug.enhancedAuthenticatedAccess={start:this._io.pos,ioOffset:this._io.byteOffset},this.enhancedAuthenticatedAccess=this._io.readBitsIntBe(1)!=0,this._debug.enhancedAuthenticatedAccess.end=this._io.pos,this._debug.appendWrite={start:this._io.pos,ioOffset:this._io.byteOffset},this.appendWrite=this._io.readBitsIntBe(1)!=0,this._debug.appendWrite.end=this._io.pos,this._debug.timeBasedAuthenticatedWriteAccess={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeBasedAuthenticatedWriteAccess=this._io.readBitsIntBe(1)!=0,this._debug.timeBasedAuthenticatedWriteAccess.end=this._io.pos,this._debug.authenticatedWriteAccess={start:this._io.pos,ioOffset:this._io.byteOffset},this.authenticatedWriteAccess=this._io.readBitsIntBe(1)!=0,this._debug.authenticatedWriteAccess.end=this._io.pos,this._debug.hardwareErrorRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.hardwareErrorRecord=this._io.readBitsIntBe(1)!=0,this._debug.hardwareErrorRecord.end=this._io.pos,this._debug.runtimeAccess={start:this._io.pos,ioOffset:this._io.byteOffset},this.runtimeAccess=this._io.readBitsIntBe(1)!=0,this._debug.runtimeAccess.end=this._io.pos,this._debug.bootserviceAccess={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootserviceAccess=this._io.readBitsIntBe(1)!=0,this._debug.bootserviceAccess.end=this._io.pos,this._debug.nonVolatile={start:this._io.pos,ioOffset:this._io.byteOffset},this.nonVolatile=this._io.readBitsIntBe(1)!=0,this._debug.nonVolatile.end=this._io.pos,this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBitsIntBe(24),this._debug.reserved1.end=this._io.pos},e})(),d=_.SignatureData=(function(){function e(i,r,n){this._io=i,this._parent=r,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){this._debug.owner={start:this._io.pos,ioOffset:this._io.byteOffset},this.owner=this._io.readBytes(16),this._debug.owner.end=this._io.pos,this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this.data=this._io.readBytesFull(),this._debug.data.end=this._io.pos},e})(),u=_.SignatureList=(function(){function e(i,r,n){this._io=i,this._parent=r,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.signatureType={start:this._io.pos,ioOffset:this._io.byteOffset},this.signatureType=this._io.readBytes(16),this._debug.signatureType.end=this._io.pos,this._debug.lenSignatureList={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenSignatureList=this._io.readU4le(),this._debug.lenSignatureList.end=this._io.pos,this._debug.lenSignatureHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenSignatureHeader=this._io.readU4le(),this._debug.lenSignatureHeader.end=this._io.pos,this._debug.lenSignature={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenSignature=this._io.readU4le(),this._debug.lenSignature.end=this._io.pos,this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=this._io.readBytes(this.lenSignatureHeader),this._debug.header.end=this._io.pos,this.lenSignature>0){this._debug.signatures={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.signatures.arr=[],this._raw_signatures=[],this.signatures=[];for(var i=0;i<Math.floor((this.lenSignatureList-this.lenSignatureHeader-28)/this.lenSignature);i++){this._debug.signatures.arr[i]={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_signatures.push(this._io.readBytes(this.lenSignature));var r=new t(this._raw_signatures[i]);this.signatures.push(new d(r,this,this._root)),this._debug.signatures.arr[i].end=this._io.pos}this._debug.signatures.end=this._io.pos}},Object.defineProperty(e.prototype,"isCertDerPkcs7",{get:function(){return this._m_isCertDerPkcs7!==void 0?this._m_isCertDerPkcs7:(this._debug._m_isCertDerPkcs7={},this._m_isCertDerPkcs7=t.byteArrayCompare(this.signatureType,new Uint8Array([157,210,175,74,223,104,238,73,138,169,52,125,55,86,101,167]))==0,this._m_isCertDerPkcs7)}}),Object.defineProperty(e.prototype,"isCertRsa2048Key",{get:function(){return this._m_isCertRsa2048Key!==void 0?this._m_isCertRsa2048Key:(this._debug._m_isCertRsa2048Key={},this._m_isCertRsa2048Key=t.byteArrayCompare(this.signatureType,new Uint8Array([232,102,87,60,156,38,52,78,170,20,237,119,110,133,179,182]))==0,this._m_isCertRsa2048Key)}}),Object.defineProperty(e.prototype,"isCertRsa2048Sha1",{get:function(){return this._m_isCertRsa2048Sha1!==void 0?this._m_isCertRsa2048Sha1:(this._debug._m_isCertRsa2048Sha1={},this._m_isCertRsa2048Sha1=t.byteArrayCompare(this.signatureType,new Uint8Array([79,68,248,103,67,135,241,72,163,40,30,170,184,115,96,128]))==0,this._m_isCertRsa2048Sha1)}}),Object.defineProperty(e.prototype,"isCertRsa2048Sha256",{get:function(){return this._m_isCertRsa2048Sha256!==void 0?this._m_isCertRsa2048Sha256:(this._debug._m_isCertRsa2048Sha256={},this._m_isCertRsa2048Sha256=t.byteArrayCompare(this.signatureType,new Uint8Array([144,97,179,226,155,135,61,74,173,141,242,231,187,163,39,132]))==0,this._m_isCertRsa2048Sha256)}}),Object.defineProperty(e.prototype,"isCertSha1",{get:function(){return this._m_isCertSha1!==void 0?this._m_isCertSha1:(this._debug._m_isCertSha1={},this._m_isCertSha1=t.byteArrayCompare(this.signatureType,new Uint8Array([18,165,108,130,16,207,201,74,177,135,190,1,73,102,49,189]))==0,this._m_isCertSha1)}}),Object.defineProperty(e.prototype,"isCertSha224",{get:function(){return this._m_isCertSha224!==void 0?this._m_isCertSha224:(this._debug._m_isCertSha224={},this._m_isCertSha224=t.byteArrayCompare(this.signatureType,new Uint8Array([51,82,110,11,92,166,201,68,148,7,217,171,131,191,200,189]))==0,this._m_isCertSha224)}}),Object.defineProperty(e.prototype,"isCertSha256",{get:function(){return this._m_isCertSha256!==void 0?this._m_isCertSha256:(this._debug._m_isCertSha256={},this._m_isCertSha256=t.byteArrayCompare(this.signatureType,new Uint8Array([38,22,196,193,76,80,146,64,172,169,65,249,54,147,67,40]))==0,this._m_isCertSha256)}}),Object.defineProperty(e.prototype,"isCertSha256X509",{get:function(){return this._m_isCertSha256X509!==void 0?this._m_isCertSha256X509:(this._debug._m_isCertSha256X509={},this._m_isCertSha256X509=t.byteArrayCompare(this.signatureType,new Uint8Array([146,164,210,59,192,150,121,64,180,32,252,249,142,241,3,237]))==0,this._m_isCertSha256X509)}}),Object.defineProperty(e.prototype,"isCertSha384",{get:function(){return this._m_isCertSha384!==void 0?this._m_isCertSha384:(this._debug._m_isCertSha384={},this._m_isCertSha384=t.byteArrayCompare(this.signatureType,new Uint8Array([7,83,62,255,208,159,201,72,133,241,138,213,108,112,30,1]))==0,this._m_isCertSha384)}}),Object.defineProperty(e.prototype,"isCertSha384X509",{get:function(){return this._m_isCertSha384X509!==void 0?this._m_isCertSha384X509:(this._debug._m_isCertSha384X509={},this._m_isCertSha384X509=t.byteArrayCompare(this.signatureType,new Uint8Array([110,135,118,112,194,128,230,78,170,210,40,179,73,166,134,91]))==0,this._m_isCertSha384X509)}}),Object.defineProperty(e.prototype,"isCertSha512",{get:function(){return this._m_isCertSha512!==void 0?this._m_isCertSha512:(this._debug._m_isCertSha512={},this._m_isCertSha512=t.byteArrayCompare(this.signatureType,new Uint8Array([174,15,62,9,196,166,80,79,159,27,212,30,43,137,193,154]))==0,this._m_isCertSha512)}}),Object.defineProperty(e.prototype,"isCertSha512X509",{get:function(){return this._m_isCertSha512X509!==void 0?this._m_isCertSha512X509:(this._debug._m_isCertSha512X509={},this._m_isCertSha512X509=t.byteArrayCompare(this.signatureType,new Uint8Array([99,191,109,68,2,37,218,76,188,250,36,101,210,176,254,157]))==0,this._m_isCertSha512X509)}}),Object.defineProperty(e.prototype,"isCertX509",{get:function(){return this._m_isCertX509!==void 0?this._m_isCertX509:(this._debug._m_isCertX509={},this._m_isCertX509=t.byteArrayCompare(this.signatureType,new Uint8Array([161,89,192,165,228,148,167,74,135,181,171,21,92,43,240,114]))==0,this._m_isCertX509)}}),e})();return _})();s.EfivarSignatureList=h})}});const p=g(),y={id:"efivar_signature_list",title:"UEFI Variable with Signature List",ksy:{meta:{id:"efivar_signature_list",title:"UEFI Variable with Signature List",xref:{wikidata:"Q859398"},license:"CC0-1.0",endian:"le"},doc:`Parse UEFI variables db and dbx that contain signatures, certificates and
hashes. On a Linux system using UEFI, these variables are readable from:

\`\`\`
/sys/firmware/efi/efivars/db-d719b2cb-3d3a-4596-a3bc-dad00e67656f
/sys/firmware/efi/efivars/dbDefault-8be4df61-93ca-11d2-aa0d-00e098032b8c
/sys/firmware/efi/efivars/dbx-d719b2cb-3d3a-4596-a3bc-dad00e67656f
/sys/firmware/efi/efivars/dbxDefault-8be4df61-93ca-11d2-aa0d-00e098032b8c
\`\`\`

Note:

* \`d719b2cb-3d3a-4596-a3bc-dad00e67656f\` is defined as \`EFI_IMAGE_SECURITY_DATABASE_GUID\`
* \`8be4df61-93ca-11d2-aa0d-00e098032b8c\` is defined as \`EFI_GLOBAL_VARIABLE\`

Each file contains an EFI attribute (32-bit integer) followed by a list of
\`EFI_SIGNATURE_LIST\` structures.
`,"doc-ref":"https://uefi.org/sites/default/files/resources/UEFI_Spec_2_8_final.pdf",seq:[{id:"var_attributes",doc:"Attributes of the UEFI variable",type:"efi_var_attr"},{id:"signatures",type:"signature_list",repeat:"eos"}],types:{signature_list:{"doc-ref":"EFI_SIGNATURE_LIST",seq:[{id:"signature_type",doc:"Type of the signature as a GUID","-orig-id":"SignatureType",size:16},{id:"len_signature_list",doc:"Total size of the signature list, including this header",type:"u4","-orig-id":"SignatureListSize"},{id:"len_signature_header",doc:"Size of the signature header which precedes the array of signatures",type:"u4","-orig-id":"SignatureHeaderSize"},{id:"len_signature",doc:"Size of each signature",type:"u4","-orig-id":"signatureSize"},{id:"header",doc:"Header before the array of signatures","-orig-id":"SignatureHeader",size:"len_signature_header"},{id:"signatures",doc:"An array of signatures","-orig-id":"Signatures",size:"len_signature",repeat:"expr","repeat-expr":"(len_signature_list - len_signature_header - 0x1c) / len_signature",if:"len_signature > 0",type:"signature_data"}],instances:{is_cert_sha256:{value:"signature_type == [0x26, 0x16, 0xc4, 0xc1, 0x4c, 0x50, 0x92, 0x40, 0xac, 0xa9, 0x41, 0xf9, 0x36, 0x93, 0x43, 0x28]",doc:"SHA-256 hash","doc-ref":"EFI_CERT_SHA256_GUID"},is_cert_rsa2048_key:{value:"signature_type == [0xe8, 0x66, 0x57, 0x3c, 0x9c, 0x26, 0x34, 0x4e, 0xaa, 0x14, 0xed, 0x77, 0x6e, 0x85, 0xb3, 0xb6]",doc:"RSA-2048 key (only the modulus since the public key exponent is known to be 0x10001)","doc-ref":"EFI_CERT_RSA2048_GUID"},is_cert_rsa2048_sha256:{value:"signature_type == [0x90, 0x61, 0xb3, 0xe2, 0x9b, 0x87, 0x3d, 0x4a, 0xad, 0x8d, 0xf2, 0xe7, 0xbb, 0xa3, 0x27, 0x84]",doc:"RSA-2048 signature of a SHA-256 hash","doc-ref":"EFI_CERT_RSA2048_SHA256_GUID"},is_cert_sha1:{value:"signature_type == [0x12, 0xa5, 0x6c, 0x82, 0x10, 0xcf, 0xc9, 0x4a, 0xb1, 0x87, 0xbe, 0x01, 0x49, 0x66, 0x31, 0xbd]",doc:"SHA-1 hash","doc-ref":"EFI_CERT_SHA1_GUID"},is_cert_rsa2048_sha1:{value:"signature_type == [0x4f, 0x44, 0xf8, 0x67, 0x43, 0x87, 0xf1, 0x48, 0xa3, 0x28, 0x1e, 0xaa, 0xb8, 0x73, 0x60, 0x80]",doc:"RSA-2048 signature of a SHA-1 hash","doc-ref":"EFI_CERT_RSA2048_SHA1_GUID"},is_cert_x509:{value:"signature_type == [0xa1, 0x59, 0xc0, 0xa5, 0xe4, 0x94, 0xa7, 0x4a, 0x87, 0xb5, 0xab, 0x15, 0x5c, 0x2b, 0xf0, 0x72]",doc:"X.509 certificate","doc-ref":"EFI_CERT_X509_GUID"},is_cert_sha224:{value:"signature_type == [0x33, 0x52, 0x6e, 0x0b, 0x5c, 0xa6, 0xc9, 0x44, 0x94, 0x07, 0xd9, 0xab, 0x83, 0xbf, 0xc8, 0xbd]",doc:"SHA-224 hash","doc-ref":"EFI_CERT_SHA224_GUID"},is_cert_sha384:{value:"signature_type == [0x07, 0x53, 0x3e, 0xff, 0xd0, 0x9f, 0xc9, 0x48, 0x85, 0xf1, 0x8a, 0xd5, 0x6c, 0x70, 0x1e, 0x01]",doc:"SHA-384 hash","doc-ref":"EFI_CERT_SHA384_GUID"},is_cert_sha512:{value:"signature_type == [0xae, 0x0f, 0x3e, 0x09, 0xc4, 0xa6, 0x50, 0x4f, 0x9f, 0x1b, 0xd4, 0x1e, 0x2b, 0x89, 0xc1, 0x9a]",doc:"SHA-512 hash","doc-ref":"EFI_CERT_SHA512_GUID"},is_cert_sha256_x509:{value:"signature_type == [0x92, 0xa4, 0xd2, 0x3b, 0xc0, 0x96, 0x79, 0x40, 0xb4, 0x20, 0xfc, 0xf9, 0x8e, 0xf1, 0x03, 0xed]",doc:"SHA256 hash of an X.509 certificate's To-Be-Signed contents, and a time of revocation","doc-ref":"EFI_CERT_X509_SHA256_GUID"},is_cert_sha384_x509:{value:"signature_type == [0x6e, 0x87, 0x76, 0x70, 0xc2, 0x80, 0xe6, 0x4e, 0xaa, 0xd2, 0x28, 0xb3, 0x49, 0xa6, 0x86, 0x5b]",doc:"SHA384 hash of an X.509 certificate's To-Be-Signed contents, and a time of revocation","doc-ref":"EFI_CERT_X509_SHA384_GUID"},is_cert_sha512_x509:{value:"signature_type == [0x63, 0xbf, 0x6d, 0x44, 0x02, 0x25, 0xda, 0x4c, 0xbc, 0xfa, 0x24, 0x65, 0xd2, 0xb0, 0xfe, 0x9d]",doc:"SHA512 hash of an X.509 certificate's To-Be-Signed contents, and a time of revocation","doc-ref":"EFI_CERT_X509_SHA512_GUID"},is_cert_der_pkcs7:{value:"signature_type == [0x9d, 0xd2, 0xaf, 0x4a, 0xdf, 0x68, 0xee, 0x49, 0x8a, 0xa9, 0x34, 0x7d, 0x37, 0x56, 0x65, 0xa7]",doc:"DER-encoded PKCS #7 version 1.5 [RFC2315]","doc-ref":"EFI_CERT_TYPE_PKCS7_GUID"}}},signature_data:{"doc-ref":"EFI_SIGNATURE_DATA",seq:[{id:"owner",doc:"An identifier which identifies the agent which added the signature to the list","-orig-id":"SignatureOwner",size:16},{id:"data",doc:"The format of the signature is defined by the SignatureType.","-orig-id":"SignatureData","size-eos":!0}]},efi_var_attr:{doc:"Attributes of a UEFI variable",seq:[{id:"enhanced_authenticated_access",type:"b1","-orig-id":"EFI_VARIABLE_ENHANCED_AUTHENTICATED_ACCESS"},{id:"append_write",type:"b1","-orig-id":"EFI_VARIABLE_APPEND_WRITE"},{id:"time_based_authenticated_write_access",type:"b1","-orig-id":"EFI_VARIABLE_TIME_BASED_AUTHENTICATED_WRITE_ACCESS"},{id:"authenticated_write_access",type:"b1","-orig-id":"EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS"},{id:"hardware_error_record",type:"b1","-orig-id":"EFI_VARIABLE_HARDWARE_ERROR_RECORD"},{id:"runtime_access",type:"b1","-orig-id":"EFI_VARIABLE_RUNTIME_ACCESS"},{id:"bootservice_access",type:"b1","-orig-id":"EFI_VARIABLE_BOOTSERVICE_ACCESS"},{id:"non_volatile",type:"b1","-orig-id":"EFI_VARIABLE_NON_VOLATILE"},{id:"reserved1",doc:"Reserved (unused) bits",type:"b24"}]}}}};export{p as default,y as spec};
