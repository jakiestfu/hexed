import{k as m}from"./index-DQZRlv-R.js";var v=Object.getOwnPropertyNames,g=(_,h)=>function(){return h||(0,_[v(_)[0]])((h={exports:{}}).exports,h),h.exports},y=g({"<stdin>"(_){(function(h,i){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],i):typeof _=="object"&&_!==null&&typeof _.nodeType!="number"?i(_,m.KaitaiStream):i(h.BtrfsStream||(h.BtrfsStream={}),h.KaitaiStream)})(typeof self<"u"?self:_,function(h,i){var f=(function(){e.Attribute=Object.freeze({UNSPEC:0,UUID:1,CTRANSID:2,INO:3,SIZE:4,MODE:5,UID:6,GID:7,RDEV:8,CTIME:9,MTIME:10,ATIME:11,OTIME:12,XATTR_NAME:13,XATTR_DATA:14,PATH:15,PATH_TO:16,PATH_LINK:17,FILE_OFFSET:18,DATA:19,CLONE_UUID:20,CLONE_CTRANSID:21,CLONE_PATH:22,CLONE_OFFSET:23,CLONE_LEN:24,0:"UNSPEC",1:"UUID",2:"CTRANSID",3:"INO",4:"SIZE",5:"MODE",6:"UID",7:"GID",8:"RDEV",9:"CTIME",10:"MTIME",11:"ATIME",12:"OTIME",13:"XATTR_NAME",14:"XATTR_DATA",15:"PATH",16:"PATH_TO",17:"PATH_LINK",18:"FILE_OFFSET",19:"DATA",20:"CLONE_UUID",21:"CLONE_CTRANSID",22:"CLONE_PATH",23:"CLONE_OFFSET",24:"CLONE_LEN"}),e.Command=Object.freeze({UNSPEC:0,SUBVOL:1,SNAPSHOT:2,MKFILE:3,MKDIR:4,MKNOD:5,MKFIFO:6,MKSOCK:7,SYMLINK:8,RENAME:9,LINK:10,UNLINK:11,RMDIR:12,SET_XATTR:13,REMOVE_XATTR:14,WRITE:15,CLONE:16,TRUNCATE:17,CHMOD:18,CHOWN:19,UTIMES:20,END:21,UPDATE_EXTENT:22,0:"UNSPEC",1:"SUBVOL",2:"SNAPSHOT",3:"MKFILE",4:"MKDIR",5:"MKNOD",6:"MKFIFO",7:"MKSOCK",8:"SYMLINK",9:"RENAME",10:"LINK",11:"UNLINK",12:"RMDIR",13:"SET_XATTR",14:"REMOVE_XATTR",15:"WRITE",16:"CLONE",17:"TRUNCATE",18:"CHMOD",19:"CHOWN",20:"UTIMES",21:"END",22:"UPDATE_EXTENT"});function e(a,r,u){this._io=a,this._parent=r,this._root=u||this,this._debug={},this._read()}e.prototype._read=function(){for(this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new c(this._io,this,this._root),this._debug.header.end=this._io.pos,this._debug.commands={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.commands.arr=[],this.commands=[];!this._io.isEof();)this._debug.commands.arr[this.commands.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.commands.push(new b(this._io,this,this._root)),this._debug.commands.arr[this.commands.length-1].end=this._io.pos;this._debug.commands.end=this._io.pos};var b=e.SendCommand=(function(){function a(s,t,o){this._io=s,this._parent=t,this._root=o,this._debug={},this._read()}a.prototype._read=function(){this._debug.lenData={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenData=this._io.readU4le(),this._debug.lenData.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"BtrfsStream.Command"},this.type=this._io.readU2le(),this._debug.type.end=this._io.pos,this._debug.checksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.checksum=this._io.readBytes(4),this._debug.checksum.end=this._io.pos,this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_data=this._io.readBytes(this.lenData);var s=new i(this._raw_data);this.data=new p(s,this,this._root),this._debug.data.end=this._io.pos};var r=a.String=(function(){function s(t,o,n){this._io=t,this._parent=o,this._root=n,this._debug={},this._read()}return s.prototype._read=function(){this._debug.string={start:this._io.pos,ioOffset:this._io.byteOffset},this.string=i.bytesToStr(this._io.readBytesFull(),"UTF-8"),this._debug.string.end=this._io.pos},s})(),u=a.Timespec=(function(){function s(t,o,n){this._io=t,this._parent=o,this._root=n,this._debug={},this._read()}return s.prototype._read=function(){this._debug.tsSec={start:this._io.pos,ioOffset:this._io.byteOffset},this.tsSec=this._io.readS8le(),this._debug.tsSec.end=this._io.pos,this._debug.tsNsec={start:this._io.pos,ioOffset:this._io.byteOffset},this.tsNsec=this._io.readS4le(),this._debug.tsNsec.end=this._io.pos},s})(),d=a.Tlv=(function(){function s(t,o,n){this._io=t,this._parent=o,this._root=n,this._debug={},this._read()}return s.prototype._read=function(){switch(this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"BtrfsStream.Attribute"},this.type=this._io.readU2le(),this._debug.type.end=this._io.pos,this._debug.length={start:this._io.pos,ioOffset:this._io.byteOffset},this.length=this._io.readU2le(),this._debug.length.end=this._io.pos,this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.type){case e.Attribute.ATIME:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new u(t,this,this._root);break;case e.Attribute.CLONE_CTRANSID:this.value=this._io.readU8le();break;case e.Attribute.CLONE_LEN:this.value=this._io.readU8le();break;case e.Attribute.CLONE_OFFSET:this.value=this._io.readU8le();break;case e.Attribute.CLONE_PATH:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new r(t,this,this._root);break;case e.Attribute.CLONE_UUID:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new l(t,this,this._root);break;case e.Attribute.CTIME:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new u(t,this,this._root);break;case e.Attribute.CTRANSID:this.value=this._io.readU8le();break;case e.Attribute.FILE_OFFSET:this.value=this._io.readU8le();break;case e.Attribute.GID:this.value=this._io.readU8le();break;case e.Attribute.MODE:this.value=this._io.readU8le();break;case e.Attribute.MTIME:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new u(t,this,this._root);break;case e.Attribute.OTIME:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new u(t,this,this._root);break;case e.Attribute.PATH:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new r(t,this,this._root);break;case e.Attribute.PATH_LINK:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new r(t,this,this._root);break;case e.Attribute.PATH_TO:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new r(t,this,this._root);break;case e.Attribute.RDEV:this.value=this._io.readU8le();break;case e.Attribute.SIZE:this.value=this._io.readU8le();break;case e.Attribute.UID:this.value=this._io.readU8le();break;case e.Attribute.UUID:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new l(t,this,this._root);break;case e.Attribute.XATTR_NAME:this._raw_value=this._io.readBytes(this.length);var t=new i(this._raw_value);this.value=new r(t,this,this._root);break;default:this.value=this._io.readBytes(this.length);break}this._debug.value.end=this._io.pos},s})(),p=a.Tlvs=(function(){function s(t,o,n){this._io=t,this._parent=o,this._root=n,this._debug={},this._read()}return s.prototype._read=function(){for(this._debug.tlv={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.tlv.arr=[],this.tlv=[];!this._io.isEof();)this._debug.tlv.arr[this.tlv.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.tlv.push(new d(this._io,this,this._root)),this._debug.tlv.arr[this.tlv.length-1].end=this._io.pos;this._debug.tlv.end=this._io.pos},s})(),l=a.Uuid=(function(){function s(t,o,n){this._io=t,this._parent=o,this._root=n,this._debug={},this._read()}return s.prototype._read=function(){this._debug.uuid={start:this._io.pos,ioOffset:this._io.byteOffset},this.uuid=this._io.readBytes(16),this._debug.uuid.end=this._io.pos},s})();return a})(),c=e.SendStreamHeader=(function(){function a(r,u,d){this._io=r,this._parent=u,this._root=d,this._debug={},this._read()}return a.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(13),this._debug.magic.end=this._io.pos,i.byteArrayCompare(this.magic,new Uint8Array([98,116,114,102,115,45,115,116,114,101,97,109,0]))!=0){var r=new i.ValidationNotEqualError(new Uint8Array([98,116,114,102,115,45,115,116,114,101,97,109,0]),this.magic,this._io,"/types/send_stream_header/seq/0");throw this._debug.magic.validationError=r,r}this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU4le(),this._debug.version.end=this._io.pos},a})();return e})();h.BtrfsStream=f})}});const O=y(),E={id:"btrfs_stream",title:"btrfs_stream",ksy:{meta:{id:"btrfs_stream",application:"Btrfs",xref:{wikidata:"Q283820"},tags:["filesystem","linux"],license:"CC0-1.0",endian:"le"},doc:"Btrfs is a copy on write file system based on B-trees focusing on fault tolerance, repair and easy\nadministration. Btrfs is intended to address the lack of pooling, snapshots, checksums, and\nintegral multi-device spanning in Linux file systems.\nGiven any pair of subvolumes (or snapshots), Btrfs can generate a binary diff between them by\nusing the `btrfs send` command that can be replayed later by using `btrfs receive`, possibly on a\ndifferent Btrfs file system. The `btrfs send` command creates a set of data modifications required\nfor converting one subvolume into another.\nThis spec can be used to disassemble the binary diff created by the `btrfs send` command.\nIf you want a text representation you may want to checkout `btrfs receive --dump` instead.\n","doc-ref":"https://archive.kernel.org/oldwiki/btrfs.wiki.kernel.org/index.php/Design_notes_on_Send/Receive.html",seq:[{id:"header",type:"send_stream_header"},{id:"commands",type:"send_command",repeat:"eos"}],types:{send_stream_header:{seq:[{id:"magic",contents:["btrfs-stream",0]},{id:"version",type:"u4le"}]},send_command:{seq:[{id:"len_data",type:"u4le"},{id:"type",type:"u2le",enum:"command"},{id:"checksum",size:4,doc:"CRC32 checksum of a whole send command, including the header, with this attribute set to 0."},{id:"data",type:"tlvs",size:"len_data"}],types:{tlvs:{seq:[{id:"tlv",type:"tlv",repeat:"eos"}]},tlv:{seq:[{id:"type",enum:"attribute",type:"u2le"},{id:"length",type:"u2le"},{id:"value",size:"length",type:{"switch-on":"type",cases:{"attribute::uuid":"uuid","attribute::ctransid":"u8le","attribute::size":"u8le","attribute::mode":"u8le","attribute::uid":"u8le","attribute::gid":"u8le","attribute::rdev":"u8le","attribute::ctime":"timespec","attribute::mtime":"timespec","attribute::atime":"timespec","attribute::otime":"timespec","attribute::xattr_name":"string","attribute::path":"string","attribute::path_to":"string","attribute::path_link":"string","attribute::file_offset":"u8le","attribute::clone_uuid":"uuid","attribute::clone_ctransid":"u8le","attribute::clone_path":"string","attribute::clone_offset":"u8le","attribute::clone_len":"u8le"}}}]},timespec:{seq:[{id:"ts_sec",type:"s8le"},{id:"ts_nsec",type:"s4le"}]},string:{seq:[{id:"string",type:"str","size-eos":!0,encoding:"UTF-8"}]},uuid:{seq:[{id:"uuid",size:16}]}}}},enums:{command:{0:"unspec",1:"subvol",2:"snapshot",3:"mkfile",4:"mkdir",5:"mknod",6:"mkfifo",7:"mksock",8:"symlink",9:"rename",10:"link",11:"unlink",12:"rmdir",13:"set_xattr",14:"remove_xattr",15:"write",16:"clone",17:"truncate",18:"chmod",19:"chown",20:"utimes",21:"end",22:"update_extent"},attribute:{0:"unspec",1:"uuid",2:"ctransid",3:"ino",4:"size",5:"mode",6:"uid",7:"gid",8:"rdev",9:"ctime",10:"mtime",11:"atime",12:"otime",13:"xattr_name",14:"xattr_data",15:"path",16:"path_to",17:"path_link",18:"file_offset",19:"data",20:"clone_uuid",21:"clone_ctransid",22:"clone_path",23:"clone_offset",24:"clone_len"}}}};export{O as default,E as spec};
