import{k as n}from"./index-C9sUxlHS.js";var f=Object.getOwnPropertyNames,p=(e,i)=>function(){return i||(0,e[f(e)[0]])((i={exports:{}}).exports,i),i.exports},c=p({"<stdin>"(e){(function(i,r){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],r):typeof e=="object"&&e!==null&&typeof e.nodeType!="number"?r(e,n.KaitaiStream):r(i.VmwareVmdk||(i.VmwareVmdk={}),i.KaitaiStream)})(typeof self<"u"?self:e,function(i,r){var _=(function(){s.CompressionMethods=Object.freeze({NONE:0,DEFLATE:1,0:"NONE",1:"DEFLATE"});function s(t,o,a){this._io=t,this._parent=o,this._root=a||this,this._debug={},this._read()}s.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,r.byteArrayCompare(this.magic,new Uint8Array([75,68,77,86]))!=0){var t=new r.ValidationNotEqualError(new Uint8Array([75,68,77,86]),this.magic,this._io,"/seq/0");throw this._debug.magic.validationError=t,t}this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readS4le(),this._debug.version.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=new d(this._io,this,this._root),this._debug.flags.end=this._io.pos,this._debug.sizeMax={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeMax=this._io.readS8le(),this._debug.sizeMax.end=this._io.pos,this._debug.sizeGrain={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeGrain=this._io.readS8le(),this._debug.sizeGrain.end=this._io.pos,this._debug.startDescriptor={start:this._io.pos,ioOffset:this._io.byteOffset},this.startDescriptor=this._io.readS8le(),this._debug.startDescriptor.end=this._io.pos,this._debug.sizeDescriptor={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeDescriptor=this._io.readS8le(),this._debug.sizeDescriptor.end=this._io.pos,this._debug.numGrainTableEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this.numGrainTableEntries=this._io.readS4le(),this._debug.numGrainTableEntries.end=this._io.pos,this._debug.startSecondaryGrain={start:this._io.pos,ioOffset:this._io.byteOffset},this.startSecondaryGrain=this._io.readS8le(),this._debug.startSecondaryGrain.end=this._io.pos,this._debug.startPrimaryGrain={start:this._io.pos,ioOffset:this._io.byteOffset},this.startPrimaryGrain=this._io.readS8le(),this._debug.startPrimaryGrain.end=this._io.pos,this._debug.sizeMetadata={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeMetadata=this._io.readS8le(),this._debug.sizeMetadata.end=this._io.pos,this._debug.isDirty={start:this._io.pos,ioOffset:this._io.byteOffset},this.isDirty=this._io.readU1(),this._debug.isDirty.end=this._io.pos,this._debug.stuff={start:this._io.pos,ioOffset:this._io.byteOffset},this.stuff=this._io.readBytes(4),this._debug.stuff.end=this._io.pos,this._debug.compressionMethod={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"VmwareVmdk.CompressionMethods"},this.compressionMethod=this._io.readU2le(),this._debug.compressionMethod.end=this._io.pos};var d=s.HeaderFlags=(function(){function t(o,a,h){this._io=o,this._parent=a,this._root=h,this._debug={},this._read()}return t.prototype._read=function(){this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBitsIntBe(5),this._debug.reserved1.end=this._io.pos,this._debug.zeroedGrainTableEntry={start:this._io.pos,ioOffset:this._io.byteOffset},this.zeroedGrainTableEntry=this._io.readBitsIntBe(1)!=0,this._debug.zeroedGrainTableEntry.end=this._io.pos,this._debug.useSecondaryGrainDir={start:this._io.pos,ioOffset:this._io.byteOffset},this.useSecondaryGrainDir=this._io.readBitsIntBe(1)!=0,this._debug.useSecondaryGrainDir.end=this._io.pos,this._debug.validNewLineDetectionTest={start:this._io.pos,ioOffset:this._io.byteOffset},this.validNewLineDetectionTest=this._io.readBitsIntBe(1)!=0,this._debug.validNewLineDetectionTest.end=this._io.pos,this._io.alignToByte(),this._debug.reserved2={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved2=this._io.readU1(),this._debug.reserved2.end=this._io.pos,this._debug.reserved3={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved3=this._io.readBitsIntBe(6),this._debug.reserved3.end=this._io.pos,this._debug.hasMetadata={start:this._io.pos,ioOffset:this._io.byteOffset},this.hasMetadata=this._io.readBitsIntBe(1)!=0,this._debug.hasMetadata.end=this._io.pos,this._debug.hasCompressedGrain={start:this._io.pos,ioOffset:this._io.byteOffset},this.hasCompressedGrain=this._io.readBitsIntBe(1)!=0,this._debug.hasCompressedGrain.end=this._io.pos,this._io.alignToByte(),this._debug.reserved4={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved4=this._io.readU1(),this._debug.reserved4.end=this._io.pos},t})();return Object.defineProperty(s.prototype,"descriptor",{get:function(){if(this._m_descriptor!==void 0)return this._m_descriptor;var t=this._io.pos;return this._io.seek(this.startDescriptor*this._root.lenSector),this._debug._m_descriptor={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_descriptor=this._io.readBytes(this.sizeDescriptor*this._root.lenSector),this._debug._m_descriptor.end=this._io.pos,this._io.seek(t),this._m_descriptor}}),Object.defineProperty(s.prototype,"grainPrimary",{get:function(){if(this._m_grainPrimary!==void 0)return this._m_grainPrimary;var t=this._io.pos;return this._io.seek(this.startPrimaryGrain*this._root.lenSector),this._debug._m_grainPrimary={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_grainPrimary=this._io.readBytes(this.sizeGrain*this._root.lenSector),this._debug._m_grainPrimary.end=this._io.pos,this._io.seek(t),this._m_grainPrimary}}),Object.defineProperty(s.prototype,"grainSecondary",{get:function(){if(this._m_grainSecondary!==void 0)return this._m_grainSecondary;var t=this._io.pos;return this._io.seek(this.startSecondaryGrain*this._root.lenSector),this._debug._m_grainSecondary={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_grainSecondary=this._io.readBytes(this.sizeGrain*this._root.lenSector),this._debug._m_grainSecondary.end=this._io.pos,this._io.seek(t),this._m_grainSecondary}}),Object.defineProperty(s.prototype,"lenSector",{get:function(){return this._m_lenSector!==void 0?this._m_lenSector:(this._debug._m_lenSector={},this._m_lenSector=512,this._m_lenSector)}}),s})();i.VmwareVmdk=_})}});const b=c(),m={id:"vmware_vmdk",title:"VMWare Virtual Disk",ksy:{meta:{id:"vmware_vmdk",title:"VMWare Virtual Disk","file-extension":"vmdk",xref:{forensicswiki:"vmware_virtual_disk_format_(vmdk)",justsolve:"VMDK",wikidata:"Q2658179"},license:"CC0-1.0",endian:"le"},"doc-ref":"https://github.com/libyal/libvmdk/blob/main/documentation/VMWare%20Virtual%20Disk%20Format%20(VMDK).asciidoc#41-file-header",seq:[{id:"magic",contents:"KDMV"},{id:"version",type:"s4"},{id:"flags",type:"header_flags"},{id:"size_max",type:"s8",doc:"Maximum number of sectors in a given image file (capacity)"},{id:"size_grain",type:"s8"},{id:"start_descriptor",type:"s8",doc:"Embedded descriptor file start sector number (0 if not available)"},{id:"size_descriptor",type:"s8",doc:"Number of sectors that embedded descriptor file occupies"},{id:"num_grain_table_entries",type:"s4",doc:"Number of grains table entries"},{id:"start_secondary_grain",type:"s8",doc:"Secondary (backup) grain directory start sector number"},{id:"start_primary_grain",type:"s8",doc:"Primary grain directory start sector number"},{id:"size_metadata",type:"s8"},{id:"is_dirty",type:"u1"},{id:"stuff",size:4},{id:"compression_method",type:"u2",enum:"compression_methods"}],enums:{compression_methods:{0:"none",1:"deflate"}},instances:{len_sector:{value:512},descriptor:{pos:"start_descriptor * _root.len_sector",size:"size_descriptor * _root.len_sector"},grain_primary:{pos:"start_primary_grain * _root.len_sector",size:"size_grain * _root.len_sector"},grain_secondary:{pos:"start_secondary_grain * _root.len_sector",size:"size_grain * _root.len_sector"}},types:{header_flags:{"doc-ref":"https://github.com/libyal/libvmdk/blob/main/documentation/VMWare%20Virtual%20Disk%20Format%20(VMDK).asciidoc#411-flags",seq:[{id:"reserved1",type:"b5"},{id:"zeroed_grain_table_entry",type:"b1"},{id:"use_secondary_grain_dir",type:"b1"},{id:"valid_new_line_detection_test",type:"b1"},{id:"reserved2",type:"u1"},{id:"reserved3",type:"b6"},{id:"has_metadata",type:"b1"},{id:"has_compressed_grain",type:"b1"},{id:"reserved4",type:"u1"}]}}}};export{b as default,m as spec};
