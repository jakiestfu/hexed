import{k as u}from"./index-DZ3xxA7Z.js";var p=Object.getOwnPropertyNames,l=(o,s)=>function(){return s||(0,o[p(o)[0]])((s={exports:{}}).exports,s),s.exports},g=l({"<stdin>"(o){(function(s,t){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],t):typeof o=="object"&&o!==null&&typeof o.nodeType!="number"?t(o,u.KaitaiStream):t(s.CpioOldLe||(s.CpioOldLe={}),s.KaitaiStream)})(typeof self<"u"?self:o,function(s,t){var n=(function(){function a(e,i,h){this._io=e,this._parent=i,this._root=h||this,this._debug={},this._read()}a.prototype._read=function(){for(this._debug.files={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.files.arr=[],this.files=[];!this._io.isEof();)this._debug.files.arr[this.files.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.files.push(new _(this._io,this,this._root)),this._debug.files.arr[this.files.length-1].end=this._io.pos;this._debug.files.end=this._io.pos};var _=a.File=(function(){function e(i,h,r){this._io=i,this._parent=h,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new f(this._io,this,this._root),this._debug.header.end=this._io.pos,this._debug.pathName={start:this._io.pos,ioOffset:this._io.byteOffset},this.pathName=this._io.readBytes(this.header.pathNameSize-1),this._debug.pathName.end=this._io.pos,this._debug.stringTerminator={start:this._io.pos,ioOffset:this._io.byteOffset},this.stringTerminator=this._io.readBytes(1),this._debug.stringTerminator.end=this._io.pos,t.byteArrayCompare(this.stringTerminator,new Uint8Array([0]))!=0){var i=new t.ValidationNotEqualError(new Uint8Array([0]),this.stringTerminator,this._io,"/types/file/seq/2");throw this._debug.stringTerminator.validationError=i,i}if(t.mod(this.header.pathNameSize,2)==1&&(this._debug.pathNamePadding={start:this._io.pos,ioOffset:this._io.byteOffset},this.pathNamePadding=this._io.readBytes(1),this._debug.pathNamePadding.end=this._io.pos,t.byteArrayCompare(this.pathNamePadding,new Uint8Array([0]))!=0)){var i=new t.ValidationNotEqualError(new Uint8Array([0]),this.pathNamePadding,this._io,"/types/file/seq/3");throw this._debug.pathNamePadding.validationError=i,i}if(this._debug.fileData={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileData=this._io.readBytes(this.header.fileSize.value),this._debug.fileData.end=this._io.pos,t.mod(this.header.fileSize.value,2)==1&&(this._debug.fileDataPadding={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileDataPadding=this._io.readBytes(1),this._debug.fileDataPadding.end=this._io.pos,t.byteArrayCompare(this.fileDataPadding,new Uint8Array([0]))!=0)){var i=new t.ValidationNotEqualError(new Uint8Array([0]),this.fileDataPadding,this._io,"/types/file/seq/5");throw this._debug.fileDataPadding.validationError=i,i}t.byteArrayCompare(this.pathName,new Uint8Array([84,82,65,73,76,69,82,33,33,33]))==0&&this.header.fileSize.value==0&&(this._debug.endOfFilePadding={start:this._io.pos,ioOffset:this._io.byteOffset},this.endOfFilePadding=this._io.readBytesFull(),this._debug.endOfFilePadding.end=this._io.pos)},e})(),f=a.FileHeader=(function(){function e(i,h,r){this._io=i,this._parent=h,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(2),this._debug.magic.end=this._io.pos,t.byteArrayCompare(this.magic,new Uint8Array([199,113]))!=0){var i=new t.ValidationNotEqualError(new Uint8Array([199,113]),this.magic,this._io,"/types/file_header/seq/0");throw this._debug.magic.validationError=i,i}this._debug.deviceNumber={start:this._io.pos,ioOffset:this._io.byteOffset},this.deviceNumber=this._io.readU2le(),this._debug.deviceNumber.end=this._io.pos,this._debug.inodeNumber={start:this._io.pos,ioOffset:this._io.byteOffset},this.inodeNumber=this._io.readU2le(),this._debug.inodeNumber.end=this._io.pos,this._debug.mode={start:this._io.pos,ioOffset:this._io.byteOffset},this.mode=this._io.readU2le(),this._debug.mode.end=this._io.pos,this._debug.userId={start:this._io.pos,ioOffset:this._io.byteOffset},this.userId=this._io.readU2le(),this._debug.userId.end=this._io.pos,this._debug.groupId={start:this._io.pos,ioOffset:this._io.byteOffset},this.groupId=this._io.readU2le(),this._debug.groupId.end=this._io.pos,this._debug.numberOfLinks={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfLinks=this._io.readU2le(),this._debug.numberOfLinks.end=this._io.pos,this._debug.rDeviceNumber={start:this._io.pos,ioOffset:this._io.byteOffset},this.rDeviceNumber=this._io.readU2le(),this._debug.rDeviceNumber.end=this._io.pos,this._debug.modificationTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.modificationTime=new d(this._io,this,this._root),this._debug.modificationTime.end=this._io.pos,this._debug.pathNameSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.pathNameSize=this._io.readU2le(),this._debug.pathNameSize.end=this._io.pos,this._debug.fileSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileSize=new d(this._io,this,this._root),this._debug.fileSize.end=this._io.pos},e})(),d=a.FourByteUnsignedInteger=(function(){function e(i,h,r){this._io=i,this._parent=h,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.mostSignificantBits={start:this._io.pos,ioOffset:this._io.byteOffset},this.mostSignificantBits=this._io.readU2le(),this._debug.mostSignificantBits.end=this._io.pos,this._debug.leastSignificantBits={start:this._io.pos,ioOffset:this._io.byteOffset},this.leastSignificantBits=this._io.readU2le(),this._debug.leastSignificantBits.end=this._io.pos},Object.defineProperty(e.prototype,"value",{get:function(){return this._m_value!==void 0?this._m_value:(this._debug._m_value={},this._m_value=this.leastSignificantBits+(this.mostSignificantBits<<16),this._m_value)}}),e})();return a})();s.CpioOldLe=n})}});const y=g(),m={id:"cpio_old_le",title:"cpio archive, old binary variant, little-endian",ksy:{meta:{id:"cpio_old_le",title:"cpio archive, old binary variant, little-endian","file-extension":"cpio",xref:{forensicswiki:"cpio",justsolve:"Cpio",mime:"application/x-cpio",pronom:"fmt/635",wikidata:"Q285296"},license:"CC0-1.0",endian:"le"},seq:[{id:"files",type:"file",repeat:"eos"}],types:{file:{seq:[{id:"header",type:"file_header"},{id:"path_name",size:"header.path_name_size - 1"},{id:"string_terminator",contents:[0]},{id:"path_name_padding",contents:[0],if:"header.path_name_size % 2 == 1"},{id:"file_data",size:"header.file_size.value"},{id:"file_data_padding",contents:[0],if:"header.file_size.value % 2 == 1"},{id:"end_of_file_padding","size-eos":!0,if:"path_name == [0x54, 0x52, 0x41, 0x49, 0x4c, 0x45, 0x52, 0x21, 0x21, 0x21] and header.file_size.value == 0"}]},file_header:{seq:[{id:"magic",contents:[199,113]},{id:"device_number",type:"u2"},{id:"inode_number",type:"u2"},{id:"mode",type:"u2"},{id:"user_id",type:"u2"},{id:"group_id",type:"u2"},{id:"number_of_links",type:"u2"},{id:"r_device_number",type:"u2"},{id:"modification_time",type:"four_byte_unsigned_integer"},{id:"path_name_size",type:"u2"},{id:"file_size",type:"four_byte_unsigned_integer"}]},four_byte_unsigned_integer:{seq:[{id:"most_significant_bits",type:"u2"},{id:"least_significant_bits",type:"u2"}],instances:{value:{value:"least_significant_bits + (most_significant_bits << 16)"}}}}}};export{y as default,m as spec};
