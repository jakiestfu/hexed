import{k as d}from"./index-Cy_iKu7E.js";var h=Object.getOwnPropertyNames,f=(r,s)=>function(){return s||(0,r[h(r)[0]])((s={exports:{}}).exports,s),s.exports},b=f({"<stdin>"(r){(function(s,o){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],o):typeof r=="object"&&r!==null&&typeof r.nodeType!="number"?o(r,d.KaitaiStream):o(s.ApmPartitionTable||(s.ApmPartitionTable={}),s.KaitaiStream)})(typeof self<"u"?self:r,function(s,o){var p=(function(){function _(i,t,e){this._io=i,this._parent=t,this._root=e||this,this._debug={},this._read()}_.prototype._read=function(){};var n=_.PartitionEntry=(function(){function i(t,e,a){this._io=t,this._parent=e,this._root=a,this._debug={},this._read()}return i.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(2),this._debug.magic.end=this._io.pos,o.byteArrayCompare(this.magic,new Uint8Array([80,77]))!=0){var t=new o.ValidationNotEqualError(new Uint8Array([80,77]),this.magic,this._io,"/types/partition_entry/seq/0");throw this._debug.magic.validationError=t,t}this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBytes(2),this._debug.reserved1.end=this._io.pos,this._debug.numberOfPartitions={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfPartitions=this._io.readU4be(),this._debug.numberOfPartitions.end=this._io.pos,this._debug.partitionStart={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionStart=this._io.readU4be(),this._debug.partitionStart.end=this._io.pos,this._debug.partitionSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionSize=this._io.readU4be(),this._debug.partitionSize.end=this._io.pos,this._debug.partitionName={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionName=o.bytesToStr(o.bytesTerminate(this._io.readBytes(32),0,!1),"ASCII"),this._debug.partitionName.end=this._io.pos,this._debug.partitionType={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionType=o.bytesToStr(o.bytesTerminate(this._io.readBytes(32),0,!1),"ASCII"),this._debug.partitionType.end=this._io.pos,this._debug.dataStart={start:this._io.pos,ioOffset:this._io.byteOffset},this.dataStart=this._io.readU4be(),this._debug.dataStart.end=this._io.pos,this._debug.dataSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.dataSize=this._io.readU4be(),this._debug.dataSize.end=this._io.pos,this._debug.partitionStatus={start:this._io.pos,ioOffset:this._io.byteOffset},this.partitionStatus=this._io.readU4be(),this._debug.partitionStatus.end=this._io.pos,this._debug.bootCodeStart={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootCodeStart=this._io.readU4be(),this._debug.bootCodeStart.end=this._io.pos,this._debug.bootCodeSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootCodeSize=this._io.readU4be(),this._debug.bootCodeSize.end=this._io.pos,this._debug.bootLoaderAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootLoaderAddress=this._io.readU4be(),this._debug.bootLoaderAddress.end=this._io.pos,this._debug.reserved2={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved2=this._io.readBytes(4),this._debug.reserved2.end=this._io.pos,this._debug.bootCodeEntry={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootCodeEntry=this._io.readU4be(),this._debug.bootCodeEntry.end=this._io.pos,this._debug.reserved3={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved3=this._io.readBytes(4),this._debug.reserved3.end=this._io.pos,this._debug.bootCodeCksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootCodeCksum=this._io.readU4be(),this._debug.bootCodeCksum.end=this._io.pos,this._debug.processorType={start:this._io.pos,ioOffset:this._io.byteOffset},this.processorType=o.bytesToStr(o.bytesTerminate(this._io.readBytes(16),0,!1),"ASCII"),this._debug.processorType.end=this._io.pos},Object.defineProperty(i.prototype,"bootCode",{get:function(){if(this._m_bootCode!==void 0)return this._m_bootCode;var t=this._root._io,e=t.pos;return t.seek(this.bootCodeStart*this._root.sectorSize),this._debug._m_bootCode={start:t.pos,ioOffset:t.byteOffset},this._m_bootCode=t.readBytes(this.bootCodeSize),this._debug._m_bootCode.end=t.pos,t.seek(e),this._m_bootCode}}),Object.defineProperty(i.prototype,"data",{get:function(){if(this._m_data!==void 0)return this._m_data;var t=this._root._io,e=t.pos;return t.seek(this.dataStart*this._root.sectorSize),this._debug._m_data={start:t.pos,ioOffset:t.byteOffset},this._m_data=t.readBytes(this.dataSize*this._root.sectorSize),this._debug._m_data.end=t.pos,t.seek(e),this._m_data}}),Object.defineProperty(i.prototype,"partition",{get:function(){if(this._m_partition!==void 0)return this._m_partition;if((this.partitionStatus&1)!=0){var t=this._root._io,e=t.pos;t.seek(this.partitionStart*this._root.sectorSize),this._debug._m_partition={start:t.pos,ioOffset:t.byteOffset},this._m_partition=t.readBytes(this.partitionSize*this._root.sectorSize),this._debug._m_partition.end=t.pos,t.seek(e)}return this._m_partition}}),i})();return Object.defineProperty(_.prototype,"partitionEntries",{get:function(){if(this._m_partitionEntries!==void 0)return this._m_partitionEntries;var i=this._root._io,t=i.pos;i.seek(this._root.sectorSize),this._debug._m_partitionEntries={start:i.pos,ioOffset:i.byteOffset},this._debug._m_partitionEntries.arr=[],this._raw__m_partitionEntries=[],this._m_partitionEntries=[];for(var e=0;e<this._root.partitionLookup.numberOfPartitions;e++){this._debug._m_partitionEntries.arr[e]={start:i.pos,ioOffset:i.byteOffset},this._raw__m_partitionEntries.push(i.readBytes(this.sectorSize));var a=new o(this._raw__m_partitionEntries[e]);this._m_partitionEntries.push(new n(a,this,this._root)),this._debug._m_partitionEntries.arr[e].end=i.pos}return this._debug._m_partitionEntries.end=i.pos,i.seek(t),this._m_partitionEntries}}),Object.defineProperty(_.prototype,"partitionLookup",{get:function(){if(this._m_partitionLookup!==void 0)return this._m_partitionLookup;var i=this._root._io,t=i.pos;i.seek(this._root.sectorSize),this._debug._m_partitionLookup={start:i.pos,ioOffset:i.byteOffset},this._raw__m_partitionLookup=i.readBytes(this.sectorSize);var e=new o(this._raw__m_partitionLookup);return this._m_partitionLookup=new n(e,this,this._root),this._debug._m_partitionLookup.end=i.pos,i.seek(t),this._m_partitionLookup}}),Object.defineProperty(_.prototype,"sectorSize",{get:function(){return this._m_sectorSize!==void 0?this._m_sectorSize:(this._debug._m_sectorSize={},this._m_sectorSize=512,this._m_sectorSize)}}),_})();s.ApmPartitionTable=p})}});const y=b(),c={id:"apm_partition_table",title:"APM (Apple Partition Map) partition table",ksy:{meta:{id:"apm_partition_table",title:"APM (Apple Partition Map) partition table",xref:{forensicswiki:"apm",justsolve:"Apple_Partition_Map",wikidata:"Q375944"},tags:["filesystem","macos"],license:"CC0-1.0",encoding:"ascii",endian:"be"},"doc-ref":"https://en.wikipedia.org/wiki/Apple_Partition_Map",instances:{sector_size:{value:512,doc:`0x200 (512) bytes for disks, 0x1000 (4096) bytes is not supported by APM
0x800 (2048) bytes for CDROM
`},partition_lookup:{io:"_root._io",pos:"_root.sector_size",size:"sector_size",type:"partition_entry",doc:`Every partition entry contains the number of partition entries.
We parse the first entry, to know how many to parse, including the first one.
No logic is given what to do if other entries have a different number.
`},partition_entries:{io:"_root._io",pos:"_root.sector_size",size:"sector_size",type:"partition_entry",repeat:"expr","repeat-expr":"_root.partition_lookup.number_of_partitions"}},types:{partition_entry:{seq:[{id:"magic",contents:[80,77]},{id:"reserved_1",size:2},{id:"number_of_partitions",type:"u4"},{id:"partition_start",type:"u4",doc:"First sector"},{id:"partition_size",type:"u4",doc:"Number of sectors"},{id:"partition_name",type:"strz",size:32},{id:"partition_type",type:"strz",size:32},{id:"data_start",type:"u4",doc:"First sector"},{id:"data_size",type:"u4",doc:"Number of sectors"},{id:"partition_status",type:"u4"},{id:"boot_code_start",type:"u4",doc:"First sector"},{id:"boot_code_size",type:"u4",doc:"Number of bytes"},{id:"boot_loader_address",type:"u4",doc:"Address of bootloader code"},{id:"reserved_2",size:4},{id:"boot_code_entry",type:"u4",doc:"Boot code entry point"},{id:"reserved_3",size:4},{id:"boot_code_cksum",type:"u4",doc:"Boot code checksum"},{id:"processor_type",type:"strz",size:16}],instances:{partition:{io:"_root._io",pos:"partition_start * _root.sector_size",size:"partition_size * _root.sector_size",if:"partition_status & 1 != 0"},data:{io:"_root._io",pos:"data_start * _root.sector_size",size:"data_size * _root.sector_size"},boot_code:{io:"_root._io",pos:"boot_code_start * _root.sector_size",size:"boot_code_size"}}}}}};export{y as default,c as spec};
