import{k as u}from"./index-C9sUxlHS.js";var l=Object.getOwnPropertyNames,b=(_,i)=>function(){return i||(0,_[l(_)[0]])((i={exports:{}}).exports,i),i.exports},y=b({"<stdin>"(_){(function(i,o){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],o):typeof _=="object"&&_!==null&&typeof _.nodeType!="number"?o(_,u.KaitaiStream):o(i.SystemdJournal||(i.SystemdJournal={}),i.KaitaiStream)})(typeof self<"u"?self:_,function(i,o){var d=(function(){a.State=Object.freeze({OFFLINE:0,ONLINE:1,ARCHIVED:2,0:"OFFLINE",1:"ONLINE",2:"ARCHIVED"});function a(e,t,s){this._io=e,this._parent=t,this._root=s||this,this._debug={},this._read()}a.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_header=this._io.readBytes(this.lenHeader);var e=new o(this._raw_header);this.header=new f(e,this,this._root),this._debug.header.end=this._io.pos,this._debug.objects={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.objects.arr=[],this.objects=[];for(var t=0;t<this.header.numObjects;t++)this._debug.objects.arr[t]={start:this._io.pos,ioOffset:this._io.byteOffset},this.objects.push(new h(this._io,this,this._root)),this._debug.objects.arr[t].end=this._io.pos;this._debug.objects.end=this._io.pos};var n=a.DataObject=(function(){function e(t,s,r){this._io=t,this._parent=s,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.hash={start:this._io.pos,ioOffset:this._io.byteOffset},this.hash=this._io.readU8le(),this._debug.hash.end=this._io.pos,this._debug.ofsNextHash={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsNextHash=this._io.readU8le(),this._debug.ofsNextHash.end=this._io.pos,this._debug.ofsHeadField={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsHeadField=this._io.readU8le(),this._debug.ofsHeadField.end=this._io.pos,this._debug.ofsEntry={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsEntry=this._io.readU8le(),this._debug.ofsEntry.end=this._io.pos,this._debug.ofsEntryArray={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsEntryArray=this._io.readU8le(),this._debug.ofsEntryArray.end=this._io.pos,this._debug.numEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this.numEntries=this._io.readU8le(),this._debug.numEntries.end=this._io.pos,this._debug.payload={start:this._io.pos,ioOffset:this._io.byteOffset},this.payload=this._io.readBytesFull(),this._debug.payload.end=this._io.pos},Object.defineProperty(e.prototype,"entry",{get:function(){if(this._m_entry!==void 0)return this._m_entry;if(this.ofsEntry!=0){var t=this._root._io,s=t.pos;t.seek(this.ofsEntry),this._debug._m_entry={start:t.pos,ioOffset:t.byteOffset},this._m_entry=new h(t,this,this._root),this._debug._m_entry.end=t.pos,t.seek(s)}return this._m_entry}}),Object.defineProperty(e.prototype,"entryArray",{get:function(){if(this._m_entryArray!==void 0)return this._m_entryArray;if(this.ofsEntryArray!=0){var t=this._root._io,s=t.pos;t.seek(this.ofsEntryArray),this._debug._m_entryArray={start:t.pos,ioOffset:t.byteOffset},this._m_entryArray=new h(t,this,this._root),this._debug._m_entryArray.end=t.pos,t.seek(s)}return this._m_entryArray}}),Object.defineProperty(e.prototype,"headField",{get:function(){if(this._m_headField!==void 0)return this._m_headField;if(this.ofsHeadField!=0){var t=this._root._io,s=t.pos;t.seek(this.ofsHeadField),this._debug._m_headField={start:t.pos,ioOffset:t.byteOffset},this._m_headField=new h(t,this,this._root),this._debug._m_headField.end=t.pos,t.seek(s)}return this._m_headField}}),Object.defineProperty(e.prototype,"nextHash",{get:function(){if(this._m_nextHash!==void 0)return this._m_nextHash;if(this.ofsNextHash!=0){var t=this._root._io,s=t.pos;t.seek(this.ofsNextHash),this._debug._m_nextHash={start:t.pos,ioOffset:t.byteOffset},this._m_nextHash=new h(t,this,this._root),this._debug._m_nextHash.end=t.pos,t.seek(s)}return this._m_nextHash}}),e})(),f=a.Header=(function(){function e(t,s,r){this._io=t,this._parent=s,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.signature={start:this._io.pos,ioOffset:this._io.byteOffset},this.signature=this._io.readBytes(8),this._debug.signature.end=this._io.pos,o.byteArrayCompare(this.signature,new Uint8Array([76,80,75,83,72,72,82,72]))!=0){var t=new o.ValidationNotEqualError(new Uint8Array([76,80,75,83,72,72,82,72]),this.signature,this._io,"/types/header/seq/0");throw this._debug.signature.validationError=t,t}this._debug.compatibleFlags={start:this._io.pos,ioOffset:this._io.byteOffset},this.compatibleFlags=this._io.readU4le(),this._debug.compatibleFlags.end=this._io.pos,this._debug.incompatibleFlags={start:this._io.pos,ioOffset:this._io.byteOffset},this.incompatibleFlags=this._io.readU4le(),this._debug.incompatibleFlags.end=this._io.pos,this._debug.state={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"SystemdJournal.State"},this.state=this._io.readU1(),this._debug.state.end=this._io.pos,this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBytes(7),this._debug.reserved.end=this._io.pos,this._debug.fileId={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileId=this._io.readBytes(16),this._debug.fileId.end=this._io.pos,this._debug.machineId={start:this._io.pos,ioOffset:this._io.byteOffset},this.machineId=this._io.readBytes(16),this._debug.machineId.end=this._io.pos,this._debug.bootId={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootId=this._io.readBytes(16),this._debug.bootId.end=this._io.pos,this._debug.seqnumId={start:this._io.pos,ioOffset:this._io.byteOffset},this.seqnumId=this._io.readBytes(16),this._debug.seqnumId.end=this._io.pos,this._debug.lenHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenHeader=this._io.readU8le(),this._debug.lenHeader.end=this._io.pos,this._debug.lenArena={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenArena=this._io.readU8le(),this._debug.lenArena.end=this._io.pos,this._debug.ofsDataHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsDataHashTable=this._io.readU8le(),this._debug.ofsDataHashTable.end=this._io.pos,this._debug.lenDataHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenDataHashTable=this._io.readU8le(),this._debug.lenDataHashTable.end=this._io.pos,this._debug.ofsFieldHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsFieldHashTable=this._io.readU8le(),this._debug.ofsFieldHashTable.end=this._io.pos,this._debug.lenFieldHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenFieldHashTable=this._io.readU8le(),this._debug.lenFieldHashTable.end=this._io.pos,this._debug.ofsTailObject={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsTailObject=this._io.readU8le(),this._debug.ofsTailObject.end=this._io.pos,this._debug.numObjects={start:this._io.pos,ioOffset:this._io.byteOffset},this.numObjects=this._io.readU8le(),this._debug.numObjects.end=this._io.pos,this._debug.numEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this.numEntries=this._io.readU8le(),this._debug.numEntries.end=this._io.pos,this._debug.tailEntrySeqnum={start:this._io.pos,ioOffset:this._io.byteOffset},this.tailEntrySeqnum=this._io.readU8le(),this._debug.tailEntrySeqnum.end=this._io.pos,this._debug.headEntrySeqnum={start:this._io.pos,ioOffset:this._io.byteOffset},this.headEntrySeqnum=this._io.readU8le(),this._debug.headEntrySeqnum.end=this._io.pos,this._debug.ofsEntryArray={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsEntryArray=this._io.readU8le(),this._debug.ofsEntryArray.end=this._io.pos,this._debug.headEntryRealtime={start:this._io.pos,ioOffset:this._io.byteOffset},this.headEntryRealtime=this._io.readU8le(),this._debug.headEntryRealtime.end=this._io.pos,this._debug.tailEntryRealtime={start:this._io.pos,ioOffset:this._io.byteOffset},this.tailEntryRealtime=this._io.readU8le(),this._debug.tailEntryRealtime.end=this._io.pos,this._debug.tailEntryMonotonic={start:this._io.pos,ioOffset:this._io.byteOffset},this.tailEntryMonotonic=this._io.readU8le(),this._debug.tailEntryMonotonic.end=this._io.pos,this._io.isEof()||(this._debug.numData={start:this._io.pos,ioOffset:this._io.byteOffset},this.numData=this._io.readU8le(),this._debug.numData.end=this._io.pos),this._io.isEof()||(this._debug.numFields={start:this._io.pos,ioOffset:this._io.byteOffset},this.numFields=this._io.readU8le(),this._debug.numFields.end=this._io.pos),this._io.isEof()||(this._debug.numTags={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTags=this._io.readU8le(),this._debug.numTags.end=this._io.pos),this._io.isEof()||(this._debug.numEntryArrays={start:this._io.pos,ioOffset:this._io.byteOffset},this.numEntryArrays=this._io.readU8le(),this._debug.numEntryArrays.end=this._io.pos)},e})(),h=a.JournalObject=(function(){e.ObjectTypes=Object.freeze({UNUSED:0,DATA:1,FIELD:2,ENTRY:3,DATA_HASH_TABLE:4,FIELD_HASH_TABLE:5,ENTRY_ARRAY:6,TAG:7,0:"UNUSED",1:"DATA",2:"FIELD",3:"ENTRY",4:"DATA_HASH_TABLE",5:"FIELD_HASH_TABLE",6:"ENTRY_ARRAY",7:"TAG"});function e(t,s,r){this._io=t,this._parent=s,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){switch(this._debug.padding={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding=this._io.readBytes(o.mod(8-this._io.pos,8)),this._debug.padding.end=this._io.pos,this._debug.objectType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"SystemdJournal.JournalObject.ObjectTypes"},this.objectType=this._io.readU1(),this._debug.objectType.end=this._io.pos,this._debug.flags={start:this._io.pos,ioOffset:this._io.byteOffset},this.flags=this._io.readU1(),this._debug.flags.end=this._io.pos,this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBytes(6),this._debug.reserved.end=this._io.pos,this._debug.lenObject={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenObject=this._io.readU8le(),this._debug.lenObject.end=this._io.pos,this._debug.payload={start:this._io.pos,ioOffset:this._io.byteOffset},this.objectType){case a.JournalObject.ObjectTypes.DATA:this._raw_payload=this._io.readBytes(this.lenObject-16);var t=new o(this._raw_payload);this.payload=new n(t,this,this._root);break;default:this.payload=this._io.readBytes(this.lenObject-16);break}this._debug.payload.end=this._io.pos},e})();return Object.defineProperty(a.prototype,"dataHashTable",{get:function(){if(this._m_dataHashTable!==void 0)return this._m_dataHashTable;var e=this._io.pos;return this._io.seek(this.header.ofsDataHashTable),this._debug._m_dataHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_dataHashTable=this._io.readBytes(this.header.lenDataHashTable),this._debug._m_dataHashTable.end=this._io.pos,this._io.seek(e),this._m_dataHashTable}}),Object.defineProperty(a.prototype,"fieldHashTable",{get:function(){if(this._m_fieldHashTable!==void 0)return this._m_fieldHashTable;var e=this._io.pos;return this._io.seek(this.header.ofsFieldHashTable),this._debug._m_fieldHashTable={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_fieldHashTable=this._io.readBytes(this.header.lenFieldHashTable),this._debug._m_fieldHashTable.end=this._io.pos,this._io.seek(e),this._m_fieldHashTable}}),Object.defineProperty(a.prototype,"lenHeader",{get:function(){if(this._m_lenHeader!==void 0)return this._m_lenHeader;var e=this._io.pos;return this._io.seek(88),this._debug._m_lenHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_lenHeader=this._io.readU8le(),this._debug._m_lenHeader.end=this._io.pos,this._io.seek(e),this._m_lenHeader}}),a})();i.SystemdJournal=d})}});const g=y(),m={id:"systemd_journal",title:"systemd journal file",ksy:{meta:{id:"systemd_journal",title:"systemd journal file","file-extension":"journal",xref:{forensicswiki:"systemd"},tags:["linux","log"],license:"CC0-1.0",endian:"le"},doc:`systemd, a popular user-space system/service management suite on Linux,
offers logging functionality, storing incoming logs in a binary journal
format.

On live Linux system running systemd, these journals are typically located at:

* /run/log/journal/machine-id/*.journal (volatile, lost after reboot)
* /var/log/journal/machine-id/*.journal (persistent, but disabled by default on Debian / Ubuntu)
`,"doc-ref":"https://www.freedesktop.org/wiki/Software/systemd/journal-files/",seq:[{id:"header",type:"header",size:"len_header"},{id:"objects",type:"journal_object",repeat:"expr","repeat-expr":"header.num_objects"}],instances:{len_header:{pos:88,type:"u8",doc:`Header length is used to set substream size, as it thus required
prior to declaration of header.
`},data_hash_table:{pos:"header.ofs_data_hash_table",size:"header.len_data_hash_table"},field_hash_table:{pos:"header.ofs_field_hash_table",size:"header.len_field_hash_table"}},enums:{state:{0:{id:"offline",doc:"File is closed and thus not being written into right now"},1:{id:"online",doc:"File is open and thus might be undergoing update at the moment"},2:{id:"archived",doc:"File has been rotated, no further updates to this file are to be expected"}}},types:{header:{seq:[{id:"signature",contents:"LPKSHHRH"},{id:"compatible_flags",type:"u4"},{id:"incompatible_flags",type:"u4"},{id:"state",type:"u1",enum:"state"},{id:"reserved",size:7},{id:"file_id",size:16},{id:"machine_id",size:16},{id:"boot_id",size:16},{id:"seqnum_id",size:16},{id:"len_header","-orig-id":"header_size",type:"u8"},{id:"len_arena","-orig-id":"arena_size",type:"u8"},{id:"ofs_data_hash_table","-orig-id":"data_hash_table_offset",type:"u8"},{id:"len_data_hash_table","-orig-id":"data_hash_table_size",type:"u8"},{id:"ofs_field_hash_table","-orig-id":"field_hash_table_offset",type:"u8"},{id:"len_field_hash_table","-orig-id":"field_hash_table_size",type:"u8"},{id:"ofs_tail_object","-orig-id":"tail_object_offset",type:"u8"},{id:"num_objects","-orig-id":"n_objects",type:"u8"},{id:"num_entries","-orig-id":"n_entries",type:"u8"},{id:"tail_entry_seqnum",type:"u8"},{id:"head_entry_seqnum",type:"u8"},{id:"ofs_entry_array","-orig-id":"entry_array_offset",type:"u8"},{id:"head_entry_realtime",type:"u8"},{id:"tail_entry_realtime",type:"u8"},{id:"tail_entry_monotonic",type:"u8"},{id:"num_data","-orig-id":"n_data",type:"u8",if:"not _io.eof"},{id:"num_fields","-orig-id":"n_fields",type:"u8",if:"not _io.eof"},{id:"num_tags","-orig-id":"n_tags",type:"u8",if:"not _io.eof"},{id:"num_entry_arrays","-orig-id":"n_entry_arrays",type:"u8",if:"not _io.eof"}]},journal_object:{"doc-ref":"https://www.freedesktop.org/wiki/Software/systemd/journal-files/#objects",seq:[{id:"padding",size:"(8 - _io.pos) % 8"},{id:"object_type",type:"u1",enum:"object_types"},{id:"flags",type:"u1"},{id:"reserved",size:6},{id:"len_object",type:"u8"},{id:"payload",size:"len_object - 16",type:{"switch-on":"object_type",cases:{"object_types::data":"data_object"}}}],enums:{object_types:{0:"unused",1:"data",2:"field",3:"entry",4:"data_hash_table",5:"field_hash_table",6:"entry_array",7:"tag"}}},data_object:{doc:'Data objects are designed to carry log payload, typically in\nform of a "key=value" string in `payload` attribute.\n',"doc-ref":"https://www.freedesktop.org/wiki/Software/systemd/journal-files/#dataobjects",seq:[{id:"hash",type:"u8"},{id:"ofs_next_hash","-orig-id":"next_hash_offset",type:"u8"},{id:"ofs_head_field","-orig-id":"head_field_offset",type:"u8"},{id:"ofs_entry","-orig-id":"entry_offset",type:"u8"},{id:"ofs_entry_array","-orig-id":"entry_array_offset",type:"u8"},{id:"num_entries","-orig-id":"n_entries",type:"u8"},{id:"payload","size-eos":!0}],instances:{next_hash:{io:"_root._io",pos:"ofs_next_hash",type:"journal_object",if:"ofs_next_hash != 0"},head_field:{io:"_root._io",pos:"ofs_head_field",type:"journal_object",if:"ofs_head_field != 0"},entry:{io:"_root._io",pos:"ofs_entry",type:"journal_object",if:"ofs_entry != 0"},entry_array:{io:"_root._io",pos:"ofs_entry_array",type:"journal_object",if:"ofs_entry_array != 0"}}}}}};export{g as default,m as spec};
