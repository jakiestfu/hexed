import{k as f}from"./index-LM5QM2-c.js";var y=Object.getOwnPropertyNames,p=(_,o)=>function(){return o||(0,_[y(_)[0]])((o={exports:{}}).exports,o),o.exports},l=p({"<stdin>"(_){(function(o,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof _=="object"&&_!==null&&typeof _.nodeType!="number"?s(_,f.KaitaiStream):s(o.Asn1Der||(o.Asn1Der={}),o.KaitaiStream)})(typeof self<"u"?self:_,function(o,s){var a=(function(){e.TypeTag=Object.freeze({END_OF_CONTENT:0,BOOLEAN:1,INTEGER:2,BIT_STRING:3,OCTET_STRING:4,NULL_VALUE:5,OBJECT_ID:6,OBJECT_DESCRIPTOR:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED_PDV:11,UTF8STRING:12,RELATIVE_OID:13,SEQUENCE_10:16,PRINTABLE_STRING:19,IA5STRING:22,SEQUENCE_30:48,SET:49,0:"END_OF_CONTENT",1:"BOOLEAN",2:"INTEGER",3:"BIT_STRING",4:"OCTET_STRING",5:"NULL_VALUE",6:"OBJECT_ID",7:"OBJECT_DESCRIPTOR",8:"EXTERNAL",9:"REAL",10:"ENUMERATED",11:"EMBEDDED_PDV",12:"UTF8STRING",13:"RELATIVE_OID",16:"SEQUENCE_10",19:"PRINTABLE_STRING",22:"IA5STRING",48:"SEQUENCE_30",49:"SET"});function e(t,i,n){this._io=t,this._parent=i,this._root=n||this,this._debug={},this._read()}e.prototype._read=function(){switch(this._debug.typeTag={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Asn1Der.TypeTag"},this.typeTag=this._io.readU1(),this._debug.typeTag.end=this._io.pos,this._debug.len={start:this._io.pos,ioOffset:this._io.byteOffset},this.len=new b(this._io,this,this._root),this._debug.len.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.typeTag){case e.TypeTag.OBJECT_ID:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new h(t,this,this._root);break;case e.TypeTag.PRINTABLE_STRING:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new u(t,this,this._root);break;case e.TypeTag.SEQUENCE_10:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new d(t,this,this._root);break;case e.TypeTag.SEQUENCE_30:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new d(t,this,this._root);break;case e.TypeTag.SET:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new d(t,this,this._root);break;case e.TypeTag.UTF8STRING:this._raw_body=this._io.readBytes(this.len.result);var t=new s(this._raw_body);this.body=new c(t,this,this._root);break;default:this.body=this._io.readBytes(this.len.result);break}this._debug.body.end=this._io.pos};var h=e.BodyObjectId=(function(){function t(i,n,r){this._io=i,this._parent=n,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.firstAndSecond={start:this._io.pos,ioOffset:this._io.byteOffset},this.firstAndSecond=this._io.readU1(),this._debug.firstAndSecond.end=this._io.pos,this._debug.rest={start:this._io.pos,ioOffset:this._io.byteOffset},this.rest=this._io.readBytesFull(),this._debug.rest.end=this._io.pos},Object.defineProperty(t.prototype,"first",{get:function(){return this._m_first!==void 0?this._m_first:(this._debug._m_first={},this._m_first=Math.floor(this.firstAndSecond/40),this._m_first)}}),Object.defineProperty(t.prototype,"second",{get:function(){return this._m_second!==void 0?this._m_second:(this._debug._m_second={},this._m_second=s.mod(this.firstAndSecond,40),this._m_second)}}),t})(),u=e.BodyPrintableString=(function(){function t(i,n,r){this._io=i,this._parent=n,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.str={start:this._io.pos,ioOffset:this._io.byteOffset},this.str=s.bytesToStr(this._io.readBytesFull(),"ASCII"),this._debug.str.end=this._io.pos},t})(),d=e.BodySequence=(function(){function t(i,n,r){this._io=i,this._parent=n,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.entries.arr=[],this.entries=[];!this._io.isEof();)this._debug.entries.arr[this.entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.entries.push(new e(this._io,this,this._root)),this._debug.entries.arr[this.entries.length-1].end=this._io.pos;this._debug.entries.end=this._io.pos},t})(),c=e.BodyUtf8string=(function(){function t(i,n,r){this._io=i,this._parent=n,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.str={start:this._io.pos,ioOffset:this._io.byteOffset},this.str=s.bytesToStr(this._io.readBytesFull(),"UTF-8"),this._debug.str.end=this._io.pos},t})(),b=e.LenEncoded=(function(){function t(i,n,r){this._io=i,this._parent=n,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.b1={start:this._io.pos,ioOffset:this._io.byteOffset},this.b1=this._io.readU1(),this._debug.b1.end=this._io.pos,this.b1==130&&(this._debug.int2={start:this._io.pos,ioOffset:this._io.byteOffset},this.int2=this._io.readU2be(),this._debug.int2.end=this._io.pos),this.b1==129&&(this._debug.int1={start:this._io.pos,ioOffset:this._io.byteOffset},this.int1=this._io.readU1(),this._debug.int1.end=this._io.pos)},Object.defineProperty(t.prototype,"result",{get:function(){return this._m_result!==void 0?this._m_result:(this._debug._m_result={},this._m_result=this.b1==129?this.int1:this.b1==130?this.int2:this.b1,this._m_result)}}),t})();return e})();o.Asn1Der=a})}});const E=l(),T={id:"asn1_der",title:"ASN.1 DER (Abstract Syntax Notation One, Distinguished Encoding Rules)",ksy:{meta:{id:"asn1_der",title:"ASN.1 DER (Abstract Syntax Notation One, Distinguished Encoding Rules)","file-extension":"der",xref:{justsolve:"DER",wikidata:"Q28600469"},license:"CC0-1.0"},doc:`ASN.1 (Abstract Syntax Notation One) DER (Distinguished Encoding
Rules) is a standard-backed serialization scheme used in many
different use-cases. Particularly popular usage scenarios are X.509
certificates and some telecommunication / networking protocols.

DER is self-describing encoding scheme which allows representation
of simple, atomic data elements, such as strings and numbers, and
complex objects, such as sequences of other elements.

DER is a subset of BER (Basic Encoding Rules), with an emphasis on
being non-ambiguous: there's always exactly one canonical way to
encode a data structure defined in terms of ASN.1 using DER.

This spec allows full parsing of format syntax, but to understand
the semantics, one would typically require a dictionary of Object
Identifiers (OIDs), to match OID bodies against some human-readable
list of constants. OIDs are covered by many different standards,
so typically it's simpler to use a pre-compiled list of them, such
as:

* <https://www.cs.auckland.ac.nz/~pgut001/dumpasn1.cfg>
* <http://oid-info.com/>
* <https://www.alvestrand.no/objectid/top.html>
`,"doc-ref":"https://www.itu.int/itu-t/recommendations/rec.aspx?rec=12483&lang=en","-webide-representation":"t={type_tag}, b={body}",seq:[{id:"type_tag",type:"u1",enum:"type_tag"},{id:"len",type:"len_encoded"},{id:"body",size:"len.result",type:{"switch-on":"type_tag",cases:{"type_tag::object_id":"body_object_id","type_tag::sequence_10":"body_sequence","type_tag::sequence_30":"body_sequence","type_tag::set":"body_sequence","type_tag::utf8string":"body_utf8string","type_tag::printable_string":"body_printable_string"}}}],types:{len_encoded:{"-webide-representation":"v={result:dec}",seq:[{id:"b1",type:"u1"},{id:"int2",type:"u2be",if:"b1 == 0x82"},{id:"int1",type:"u1",if:"b1 == 0x81"}],instances:{result:{value:"(b1 == 0x81) ? int1 : ((b1 == 0x82) ? int2 : b1)","-webide-parse-mode":"eager"}}},body_sequence:{"-webide-representation":"[...]",seq:[{id:"entries",type:"asn1_der",repeat:"eos"}]},body_utf8string:{"-webide-representation":"{str}",seq:[{id:"str",type:"str","size-eos":!0,encoding:"UTF-8"}]},body_printable_string:{"-webide-representation":"{str}",seq:[{id:"str",type:"str","size-eos":!0,encoding:"ASCII"}]},body_object_id:{"-webide-representation":"{first:dec}.{second:dec}.{rest}","doc-ref":"https://learn.microsoft.com/en-us/windows/win32/seccertenroll/about-object-identifier",seq:[{id:"first_and_second",type:"u1"},{id:"rest","size-eos":!0}],instances:{first:{value:"first_and_second / 40"},second:{value:"first_and_second % 40"}}}},enums:{type_tag:{0:"end_of_content",1:"boolean",2:"integer",3:"bit_string",4:"octet_string",5:"null_value",6:"object_id",7:"object_descriptor",8:"external",9:"real",10:"enumerated",11:"embedded_pdv",12:"utf8string",13:"relative_oid",16:"sequence_10",19:"printable_string",22:"ia5string",48:"sequence_30",49:"set"}}}};export{E as default,T as spec};
