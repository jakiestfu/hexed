import{k as m}from"./index-COmSdSC_.js";var g=Object.getOwnPropertyNames,l=(n,o)=>function(){return o||(0,n[g(n)[0]])((o={exports:{}}).exports,o),o.exports},O=l({"<stdin>"(n){(function(o,_){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],_):typeof n=="object"&&n!==null&&typeof n.nodeType!="number"?_(n,m.KaitaiStream):_(o.Tsm||(o.Tsm={}),o.KaitaiStream)})(typeof self<"u"?self:n,function(o,_){var u=(function(){function d(i,r,s){this._io=i,this._parent=r,this._root=s||this,this._debug={},this._read()}d.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new b(this._io,this,this._root),this._debug.header.end=this._io.pos};var b=d.Header=(function(){function i(r,s,h){this._io=r,this._parent=s,this._root=h,this._debug={},this._read()}return i.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,_.byteArrayCompare(this.magic,new Uint8Array([22,209,22,209]))!=0){var r=new _.ValidationNotEqualError(new Uint8Array([22,209,22,209]),this.magic,this._io,"/types/header/seq/0");throw this._debug.magic.validationError=r,r}this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU1(),this._debug.version.end=this._io.pos},i})(),y=d.Index=(function(){function i(s,h,e){this._io=s,this._parent=h,this._root=e,this._debug={},this._read()}i.prototype._read=function(){this._debug.offset={start:this._io.pos,ioOffset:this._io.byteOffset},this.offset=this._io.readU8be(),this._debug.offset.end=this._io.pos};var r=i.IndexHeader=(function(){function s(e,f,t){this._io=e,this._parent=f,this._root=t,this._debug={},this._read()}s.prototype._read=function(){this._debug.keyLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.keyLen=this._io.readU2be(),this._debug.keyLen.end=this._io.pos,this._debug.key={start:this._io.pos,ioOffset:this._io.byteOffset},this.key=_.bytesToStr(this._io.readBytes(this.keyLen),"UTF-8"),this._debug.key.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=this._io.readU1(),this._debug.type.end=this._io.pos,this._debug.entryCount={start:this._io.pos,ioOffset:this._io.byteOffset},this.entryCount=this._io.readU2be(),this._debug.entryCount.end=this._io.pos,this._debug.indexEntries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.indexEntries.arr=[],this.indexEntries=[];for(var e=0;e<this.entryCount;e++)this._debug.indexEntries.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this.indexEntries.push(new h(this._io,this,this._root)),this._debug.indexEntries.arr[e].end=this._io.pos;this._debug.indexEntries.end=this._io.pos};var h=s.IndexEntry=(function(){function e(t,a,p){this._io=t,this._parent=a,this._root=p,this._debug={},this._read()}e.prototype._read=function(){this._debug.minTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.minTime=this._io.readU8be(),this._debug.minTime.end=this._io.pos,this._debug.maxTime={start:this._io.pos,ioOffset:this._io.byteOffset},this.maxTime=this._io.readU8be(),this._debug.maxTime.end=this._io.pos,this._debug.blockOffset={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockOffset=this._io.readU8be(),this._debug.blockOffset.end=this._io.pos,this._debug.blockSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.blockSize=this._io.readU4be(),this._debug.blockSize.end=this._io.pos};var f=e.BlockEntry=(function(){function t(a,p,c){this._io=a,this._parent=p,this._root=c,this._debug={},this._read()}return t.prototype._read=function(){this._debug.crc32={start:this._io.pos,ioOffset:this._io.byteOffset},this.crc32=this._io.readU4be(),this._debug.crc32.end=this._io.pos,this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this.data=this._io.readBytes(this._parent.blockSize-4),this._debug.data.end=this._io.pos},t})();return Object.defineProperty(e.prototype,"block",{get:function(){if(this._m_block!==void 0)return this._m_block;var t=this._root._io,a=t.pos;return t.seek(this.blockOffset),this._debug._m_block={start:t.pos,ioOffset:t.byteOffset},this._m_block=new f(t,this,this._root),this._debug._m_block.end=t.pos,t.seek(a),this._m_block}}),e})();return s})();return Object.defineProperty(i.prototype,"entries",{get:function(){if(this._m_entries!==void 0)return this._m_entries;var s=this._io.pos;this._io.seek(this.offset),this._debug._m_entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug._m_entries.arr=[],this._m_entries=[];do{this._debug._m_entries.arr[this._m_entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset};var h=new r(this._io,this,this._root);this._m_entries.push(h),this._debug._m_entries.arr[this._m_entries.length-1].end=this._io.pos}while(this._io.pos!=this._io.size-8);return this._debug._m_entries.end=this._io.pos,this._io.seek(s),this._m_entries}}),i})();return Object.defineProperty(d.prototype,"index",{get:function(){if(this._m_index!==void 0)return this._m_index;var i=this._io.pos;return this._io.seek(this._io.size-8),this._debug._m_index={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_index=new y(this._io,this,this._root),this._debug._m_index.end=this._io.pos,this._io.seek(i),this._m_index}}),d})();o.Tsm=u})}});const x=O(),v={id:"tsm",title:"InfluxDB TSM file",ksy:{meta:{id:"tsm",title:"InfluxDB TSM file",application:"InfluxDB","file-extension":"tsm",xref:{wikidata:"Q29168491"},license:"MIT",endian:"be"},doc:`InfluxDB is a scalable database optimized for storage of time
series, real-time application metrics, operations monitoring events,
etc, written in Go.

Data is stored in .tsm files, which are kept pretty simple
conceptually. Each .tsm file contains a header and footer, which
stores offset to an index. Index is used to find a data block for a
requested time boundary.
`,seq:[{id:"header",type:"header"}],instances:{index:{pos:"_io.size - 8",type:"index"}},types:{header:{seq:[{id:"magic",contents:[22,209,22,209]},{id:"version",type:"u1"}]},index:{seq:[{id:"offset",type:"u8"}],instances:{entries:{pos:"offset",type:"index_header",repeat:"until","repeat-until":"_io.pos == _io.size - 8"}},types:{index_header:{seq:[{id:"key_len",type:"u2"},{id:"key",type:"str",encoding:"UTF-8",size:"key_len"},{id:"type",type:"u1"},{id:"entry_count",type:"u2"},{id:"index_entries",type:"index_entry",repeat:"expr","repeat-expr":"entry_count"}],types:{index_entry:{seq:[{id:"min_time",type:"u8"},{id:"max_time",type:"u8"},{id:"block_offset",type:"u8"},{id:"block_size",type:"u4"}],types:{block_entry:{seq:[{id:"crc32",type:"u4"},{id:"data",size:"_parent.block_size - 4"}]}},instances:{block:{io:"_root._io",pos:"block_offset",type:"block_entry"}}}}}}}}}};export{x as default,v as spec};
