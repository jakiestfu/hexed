import{k as u}from"./index-C9sUxlHS.js";var c=Object.getOwnPropertyNames,m=(h,t)=>function(){return t||(0,h[c(h)[0]])((t={exports:{}}).exports,t),t.exports},b=m({"<stdin>"(h){(function(t,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream","./DosDatetime"],s):typeof h=="object"&&h!==null&&typeof h.nodeType!="number"?s(h,u.KaitaiStream,require("./DosDatetime")):s(t.Lzh||(t.Lzh={}),t.KaitaiStream,t.DosDatetime||(t.DosDatetime={}))})(typeof self<"u"?self:h,function(t,s,a){var _=(function(){function d(e,i,o){this._io=e,this._parent=i,this._root=o||this,this._debug={},this._read()}d.prototype._read=function(){for(this._debug.entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.entries.arr=[],this.entries=[];!this._io.isEof();)this._debug.entries.arr[this.entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.entries.push(new p(this._io,this,this._root)),this._debug.entries.arr[this.entries.length-1].end=this._io.pos;this._debug.entries.end=this._io.pos};var n=d.FileRecord=(function(){function e(i,o,r){this._io=i,this._parent=o,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_header=this._io.readBytes(this._parent.headerLen-1);var i=new s(this._raw_header);this.header=new f(i,this,this._root),this._debug.header.end=this._io.pos,this.header.header1.lhaLevel==0&&(this._debug.fileUncomprCrc16={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileUncomprCrc16=this._io.readU2le(),this._debug.fileUncomprCrc16.end=this._io.pos),this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.body=this._io.readBytes(this.header.header1.fileSizeCompr),this._debug.body.end=this._io.pos},e})(),f=d.Header=(function(){function e(i,o,r){this._io=i,this._parent=o,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.header1={start:this._io.pos,ioOffset:this._io.byteOffset},this.header1=new l(this._io,this,this._root),this._debug.header1.end=this._io.pos,this.header1.lhaLevel==0&&(this._debug.filenameLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.filenameLen=this._io.readU1(),this._debug.filenameLen.end=this._io.pos),this.header1.lhaLevel==0&&(this._debug.filename={start:this._io.pos,ioOffset:this._io.byteOffset},this.filename=s.bytesToStr(this._io.readBytes(this.filenameLen),"ASCII"),this._debug.filename.end=this._io.pos),this.header1.lhaLevel==2&&(this._debug.fileUncomprCrc16={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileUncomprCrc16=this._io.readU2le(),this._debug.fileUncomprCrc16.end=this._io.pos),this.header1.lhaLevel==2&&(this._debug.os={start:this._io.pos,ioOffset:this._io.byteOffset},this.os=this._io.readU1(),this._debug.os.end=this._io.pos),this.header1.lhaLevel==2&&(this._debug.extHeaderSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.extHeaderSize=this._io.readU2le(),this._debug.extHeaderSize.end=this._io.pos)},e})(),l=d.Header1=(function(){function e(i,o,r){this._io=i,this._parent=o,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.headerChecksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerChecksum=this._io.readU1(),this._debug.headerChecksum.end=this._io.pos,this._debug.methodId={start:this._io.pos,ioOffset:this._io.byteOffset},this.methodId=s.bytesToStr(this._io.readBytes(5),"ASCII"),this._debug.methodId.end=this._io.pos,this._debug.fileSizeCompr={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileSizeCompr=this._io.readU4le(),this._debug.fileSizeCompr.end=this._io.pos,this._debug.fileSizeUncompr={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileSizeUncompr=this._io.readU4le(),this._debug.fileSizeUncompr.end=this._io.pos,this._debug.fileTimestamp={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_fileTimestamp=this._io.readBytes(4);var i=new s(this._raw_fileTimestamp);this.fileTimestamp=new a.DosDatetime(i,null,null),this._debug.fileTimestamp.end=this._io.pos,this._debug.attr={start:this._io.pos,ioOffset:this._io.byteOffset},this.attr=this._io.readU1(),this._debug.attr.end=this._io.pos,this._debug.lhaLevel={start:this._io.pos,ioOffset:this._io.byteOffset},this.lhaLevel=this._io.readU1(),this._debug.lhaLevel.end=this._io.pos},e})(),p=d.Record=(function(){function e(i,o,r){this._io=i,this._parent=o,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.headerLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerLen=this._io.readU1(),this._debug.headerLen.end=this._io.pos,this.headerLen>0&&(this._debug.fileRecord={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileRecord=new n(this._io,this,this._root),this._debug.fileRecord.end=this._io.pos)},e})();return d})();t.Lzh=_})}});const g=b(),O={id:"lzh",title:"lzh",ksy:{meta:{id:"lzh",application:"LHA (AKA LHarc) by Yoshizaki Haruyasu","file-extension":"lzh",xref:{justsolve:"LHA",pronom:"fmt/626",wikidata:"Q368782"},license:"CC0-1.0",imports:["/common/dos_datetime"],endian:"le"},doc:`LHA (LHarc, LZH) is a file format used by a popular freeware
eponymous archiver, created in 1988 by Haruyasu Yoshizaki. Over the
years, many ports and implementations were developed, sporting many
extensions to original 1988 LZH.

File format is pretty simple and essentially consists of a stream of
records.
`,seq:[{id:"entries",type:"record",repeat:"eos"}],types:{record:{seq:[{id:"header_len",type:"u1"},{id:"file_record",type:"file_record",if:"header_len > 0"}]},file_record:{seq:[{id:"header",size:"_parent.header_len - 1",type:"header"},{id:"file_uncompr_crc16",type:"u2",if:"header.header1.lha_level == 0"},{id:"body",size:"header.header1.file_size_compr"}]},header:{seq:[{id:"header1",type:"header1",doc:`Level-neutral header, same for all LHA levels. Subsequent fields order and meaning varies, based on LHA level specified in this header.
`},{id:"filename_len",type:"u1",if:"header1.lha_level == 0"},{id:"filename",type:"str",size:"filename_len",encoding:"ASCII",if:"header1.lha_level == 0"},{id:"file_uncompr_crc16",type:"u2",if:"header1.lha_level == 2"},{id:"os",type:"u1",if:"header1.lha_level == 2"},{id:"ext_header_size",type:"u2",if:"header1.lha_level == 2"}]},header1:{seq:[{id:"header_checksum",type:"u1"},{id:"method_id",type:"str",size:5,encoding:"ASCII"},{id:"file_size_compr",type:"u4",doc:"Compressed file size"},{id:"file_size_uncompr",type:"u4",doc:"Uncompressed file size"},{id:"file_timestamp",size:4,type:"dos_datetime",doc:"Original file date/time"},{id:"attr",type:"u1",doc:"File or directory attribute"},{id:"lha_level",type:"u1"}]}}}};export{g as default,O as spec};
