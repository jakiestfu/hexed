import{k as E}from"./index-C9sUxlHS.js";var c=Object.getOwnPropertyNames,m=(o,i)=>function(){return i||(0,o[c(o)[0]])((i={exports:{}}).exports,i),i.exports},l=m({"<stdin>"(o){(function(i,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream","./EthernetFrame","./WindowsSystemtime"],s):typeof o=="object"&&o!==null&&typeof o.nodeType!="number"?s(o,E.KaitaiStream,require("./EthernetFrame"),require("./WindowsSystemtime")):s(i.MicrosoftNetworkMonitorV2||(i.MicrosoftNetworkMonitorV2={}),i.KaitaiStream,i.EthernetFrame||(i.EthernetFrame={}),i.WindowsSystemtime||(i.WindowsSystemtime={}))})(typeof self<"u"?self:o,function(i,s,a,h){var f=(function(){r.Linktype=Object.freeze({NULL_LINKTYPE:0,ETHERNET:1,AX25:3,IEEE802_5:6,ARCNET_BSD:7,SLIP:8,PPP:9,FDDI:10,PPP_HDLC:50,PPP_ETHER:51,ATM_RFC1483:100,RAW:101,C_HDLC:104,IEEE802_11:105,FRELAY:107,LOOP:108,LINUX_SLL:113,LTALK:114,PFLOG:117,IEEE802_11_PRISM:119,IP_OVER_FC:122,SUNATM:123,IEEE802_11_RADIOTAP:127,ARCNET_LINUX:129,APPLE_IP_OVER_IEEE1394:138,MTP2_WITH_PHDR:139,MTP2:140,MTP3:141,SCCP:142,DOCSIS:143,LINUX_IRDA:144,USER0:147,USER1:148,USER2:149,USER3:150,USER4:151,USER5:152,USER6:153,USER7:154,USER8:155,USER9:156,USER10:157,USER11:158,USER12:159,USER13:160,USER14:161,USER15:162,IEEE802_11_AVS:163,BACNET_MS_TP:165,PPP_PPPD:166,GPRS_LLC:169,GPF_T:170,GPF_F:171,LINUX_LAPD:177,BLUETOOTH_HCI_H4:187,USB_LINUX:189,PPI:192,IEEE802_15_4:195,SITA:196,ERF:197,BLUETOOTH_HCI_H4_WITH_PHDR:201,AX25_KISS:202,LAPD:203,PPP_WITH_DIR:204,C_HDLC_WITH_DIR:205,FRELAY_WITH_DIR:206,IPMB_LINUX:209,IEEE802_15_4_NONASK_PHY:215,USB_LINUX_MMAPPED:220,FC_2:224,FC_2_WITH_FRAME_DELIMS:225,IPNET:226,CAN_SOCKETCAN:227,IPV4:228,IPV6:229,IEEE802_15_4_NOFCS:230,DBUS:231,DVB_CI:235,MUX27010:236,STANAG_5066_D_PDU:237,NFLOG:239,NETANALYZER:240,NETANALYZER_TRANSPARENT:241,IPOIB:242,MPEG_2_TS:243,NG40:244,NFC_LLCP:245,INFINIBAND:247,SCTP:248,USBPCAP:249,RTAC_SERIAL:250,BLUETOOTH_LE_LL:251,NETLINK:253,BLUETOOTH_LINUX_MONITOR:254,BLUETOOTH_BREDR_BB:255,BLUETOOTH_LE_LL_WITH_PHDR:256,PROFIBUS_DL:257,PKTAP:258,EPON:259,IPMI_HPM_2:260,ZWAVE_R1_R2:261,ZWAVE_R3:262,WATTSTOPPER_DLM:263,ISO_14443:264,0:"NULL_LINKTYPE",1:"ETHERNET",3:"AX25",6:"IEEE802_5",7:"ARCNET_BSD",8:"SLIP",9:"PPP",10:"FDDI",50:"PPP_HDLC",51:"PPP_ETHER",100:"ATM_RFC1483",101:"RAW",104:"C_HDLC",105:"IEEE802_11",107:"FRELAY",108:"LOOP",113:"LINUX_SLL",114:"LTALK",117:"PFLOG",119:"IEEE802_11_PRISM",122:"IP_OVER_FC",123:"SUNATM",127:"IEEE802_11_RADIOTAP",129:"ARCNET_LINUX",138:"APPLE_IP_OVER_IEEE1394",139:"MTP2_WITH_PHDR",140:"MTP2",141:"MTP3",142:"SCCP",143:"DOCSIS",144:"LINUX_IRDA",147:"USER0",148:"USER1",149:"USER2",150:"USER3",151:"USER4",152:"USER5",153:"USER6",154:"USER7",155:"USER8",156:"USER9",157:"USER10",158:"USER11",159:"USER12",160:"USER13",161:"USER14",162:"USER15",163:"IEEE802_11_AVS",165:"BACNET_MS_TP",166:"PPP_PPPD",169:"GPRS_LLC",170:"GPF_T",171:"GPF_F",177:"LINUX_LAPD",187:"BLUETOOTH_HCI_H4",189:"USB_LINUX",192:"PPI",195:"IEEE802_15_4",196:"SITA",197:"ERF",201:"BLUETOOTH_HCI_H4_WITH_PHDR",202:"AX25_KISS",203:"LAPD",204:"PPP_WITH_DIR",205:"C_HDLC_WITH_DIR",206:"FRELAY_WITH_DIR",209:"IPMB_LINUX",215:"IEEE802_15_4_NONASK_PHY",220:"USB_LINUX_MMAPPED",224:"FC_2",225:"FC_2_WITH_FRAME_DELIMS",226:"IPNET",227:"CAN_SOCKETCAN",228:"IPV4",229:"IPV6",230:"IEEE802_15_4_NOFCS",231:"DBUS",235:"DVB_CI",236:"MUX27010",237:"STANAG_5066_D_PDU",239:"NFLOG",240:"NETANALYZER",241:"NETANALYZER_TRANSPARENT",242:"IPOIB",243:"MPEG_2_TS",244:"NG40",245:"NFC_LLCP",247:"INFINIBAND",248:"SCTP",249:"USBPCAP",250:"RTAC_SERIAL",251:"BLUETOOTH_LE_LL",253:"NETLINK",254:"BLUETOOTH_LINUX_MONITOR",255:"BLUETOOTH_BREDR_BB",256:"BLUETOOTH_LE_LL_WITH_PHDR",257:"PROFIBUS_DL",258:"PKTAP",259:"EPON",260:"IPMI_HPM_2",261:"ZWAVE_R1_R2",262:"ZWAVE_R3",263:"WATTSTOPPER_DLM",264:"ISO_14443"});function r(e,t,_){this._io=e,this._parent=t,this._root=_||this,this._debug={},this._read()}r.prototype._read=function(){if(this._debug.signature={start:this._io.pos,ioOffset:this._io.byteOffset},this.signature=this._io.readBytes(4),this._debug.signature.end=this._io.pos,s.byteArrayCompare(this.signature,new Uint8Array([71,77,66,85]))!=0){var e=new s.ValidationNotEqualError(new Uint8Array([71,77,66,85]),this.signature,this._io,"/seq/0");throw this._debug.signature.validationError=e,e}this._debug.versionMinor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMinor=this._io.readU1(),this._debug.versionMinor.end=this._io.pos,this._debug.versionMajor={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionMajor=this._io.readU1(),this._debug.versionMajor.end=this._io.pos,this._debug.macType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftNetworkMonitorV2.Linktype"},this.macType=this._io.readU2le(),this._debug.macType.end=this._io.pos,this._debug.timeCaptureStart={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeCaptureStart=new h.WindowsSystemtime(this._io,null,null),this._debug.timeCaptureStart.end=this._io.pos,this._debug.frameTableOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.frameTableOfs=this._io.readU4le(),this._debug.frameTableOfs.end=this._io.pos,this._debug.frameTableLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.frameTableLen=this._io.readU4le(),this._debug.frameTableLen.end=this._io.pos,this._debug.userDataOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.userDataOfs=this._io.readU4le(),this._debug.userDataOfs.end=this._io.pos,this._debug.userDataLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.userDataLen=this._io.readU4le(),this._debug.userDataLen.end=this._io.pos,this._debug.commentOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.commentOfs=this._io.readU4le(),this._debug.commentOfs.end=this._io.pos,this._debug.commentLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.commentLen=this._io.readU4le(),this._debug.commentLen.end=this._io.pos,this._debug.statisticsOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.statisticsOfs=this._io.readU4le(),this._debug.statisticsOfs.end=this._io.pos,this._debug.statisticsLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.statisticsLen=this._io.readU4le(),this._debug.statisticsLen.end=this._io.pos,this._debug.networkInfoOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.networkInfoOfs=this._io.readU4le(),this._debug.networkInfoOfs.end=this._io.pos,this._debug.networkInfoLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.networkInfoLen=this._io.readU4le(),this._debug.networkInfoLen.end=this._io.pos,this._debug.conversationStatsOfs={start:this._io.pos,ioOffset:this._io.byteOffset},this.conversationStatsOfs=this._io.readU4le(),this._debug.conversationStatsOfs.end=this._io.pos,this._debug.conversationStatsLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.conversationStatsLen=this._io.readU4le(),this._debug.conversationStatsLen.end=this._io.pos};var d=r.Frame=(function(){function e(t,_,n){this._io=t,this._parent=_,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){switch(this._debug.tsDelta={start:this._io.pos,ioOffset:this._io.byteOffset},this.tsDelta=this._io.readU8le(),this._debug.tsDelta.end=this._io.pos,this._debug.origLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.origLen=this._io.readU4le(),this._debug.origLen.end=this._io.pos,this._debug.incLen={start:this._io.pos,ioOffset:this._io.byteOffset},this.incLen=this._io.readU4le(),this._debug.incLen.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this._root.macType){case r.Linktype.ETHERNET:this._raw_body=this._io.readBytes(this.incLen);var t=new s(this._raw_body);this.body=new a.EthernetFrame(t,null,null);break;default:this.body=this._io.readBytes(this.incLen);break}this._debug.body.end=this._io.pos},e})(),p=r.FrameIndex=(function(){function e(t,_,n){this._io=t,this._parent=_,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){for(this._debug.entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.entries.arr=[],this.entries=[];!this._io.isEof();)this._debug.entries.arr[this.entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.entries.push(new u(this._io,this,this._root)),this._debug.entries.arr[this.entries.length-1].end=this._io.pos;this._debug.entries.end=this._io.pos},e})(),u=r.FrameIndexEntry=(function(){function e(t,_,n){this._io=t,this._parent=_,this._root=n,this._debug={},this._read()}return e.prototype._read=function(){this._debug.ofs={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofs=this._io.readU4le(),this._debug.ofs.end=this._io.pos},Object.defineProperty(e.prototype,"body",{get:function(){if(this._m_body!==void 0)return this._m_body;var t=this._root._io,_=t.pos;return t.seek(this.ofs),this._debug._m_body={start:t.pos,ioOffset:t.byteOffset},this._m_body=new d(t,this,this._root),this._debug._m_body.end=t.pos,t.seek(_),this._m_body}}),e})();return Object.defineProperty(r.prototype,"frameTable",{get:function(){if(this._m_frameTable!==void 0)return this._m_frameTable;var e=this._io.pos;this._io.seek(this.frameTableOfs),this._debug._m_frameTable={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_frameTable=this._io.readBytes(this.frameTableLen);var t=new s(this._raw__m_frameTable);return this._m_frameTable=new p(t,this,this._root),this._debug._m_frameTable.end=this._io.pos,this._io.seek(e),this._m_frameTable}}),r})();i.MicrosoftNetworkMonitorV2=f})}});const O=l(),P={id:"microsoft_network_monitor_v2",title:"microsoft_network_monitor_v2",ksy:{meta:{id:"microsoft_network_monitor_v2",application:"Microsoft Network Monitor, v2.x","file-extension":"cap",license:"CC0-1.0",xref:{pronom:"fmt/778",wikidata:"Q47245444"},"ks-version":.7,imports:["/network/ethernet_frame","/windows/windows_systemtime"],endian:"le"},doc:`Microsoft Network Monitor (AKA Netmon) is a proprietary Microsoft's
network packet sniffing and analysis tool. It can save captured
traffic as .cap files, which usually contain the packets and may
contain some additional info - enhanced network info, calculated
statistics, etc.

There are at least 2 different versions of the format: v1 and
v2. Netmon v3 seems to use the same file format as v1.
`,"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/netmon2/capturefile-header-values",seq:[{id:"signature",contents:"GMBU"},{id:"version_minor",type:"u1",doc:"Format version (minor), BCD"},{id:"version_major",type:"u1",doc:"Format version (major), BCD"},{id:"mac_type",type:"u2",enum:"linktype",doc:"Network topology type of captured data"},{id:"time_capture_start",type:"windows_systemtime",doc:"Timestamp of capture start"},{id:"frame_table_ofs",type:"u4"},{id:"frame_table_len",type:"u4"},{id:"user_data_ofs",type:"u4"},{id:"user_data_len",type:"u4"},{id:"comment_ofs",type:"u4"},{id:"comment_len",type:"u4"},{id:"statistics_ofs",type:"u4"},{id:"statistics_len",type:"u4"},{id:"network_info_ofs",type:"u4"},{id:"network_info_len",type:"u4"},{id:"conversation_stats_ofs",type:"u4"},{id:"conversation_stats_len",type:"u4"}],instances:{frame_table:{pos:"frame_table_ofs",size:"frame_table_len",type:"frame_index",doc:"Index that is used to access individual captured frames"}},types:{frame_index:{seq:[{id:"entries",type:"frame_index_entry",repeat:"eos"}]},frame_index_entry:{doc:`Each index entry is just a pointer to where the frame data is
stored in the file.
`,seq:[{id:"ofs",doc:"Absolute pointer to frame data in the file",type:"u4"}],instances:{body:{io:"_root._io",pos:"ofs",type:"frame",doc:"Frame body itself"}}},frame:{doc:`A container for actually captured network data. Allow to
timestamp individual frames and designates how much data from
the original packet was actually written into the file.
`,"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/netmon2/frame",seq:[{id:"ts_delta",type:"u8",doc:"Time stamp - usecs since start of capture"},{id:"orig_len",type:"u4",doc:"Actual length of packet"},{id:"inc_len",type:"u4",doc:"Number of octets captured in file"},{id:"body",size:"inc_len",doc:"Actual packet captured from the network",type:{"switch-on":"_root.mac_type",cases:{"linktype::ethernet":"ethernet_frame"}}}]}},enums:{linktype:{0:"null_linktype",1:"ethernet",3:"ax25",6:"ieee802_5",7:"arcnet_bsd",8:"slip",9:"ppp",10:"fddi",50:"ppp_hdlc",51:"ppp_ether",100:"atm_rfc1483",101:"raw",104:"c_hdlc",105:"ieee802_11",107:"frelay",108:"loop",113:"linux_sll",114:"ltalk",117:"pflog",119:"ieee802_11_prism",122:"ip_over_fc",123:"sunatm",127:"ieee802_11_radiotap",129:"arcnet_linux",138:"apple_ip_over_ieee1394",139:"mtp2_with_phdr",140:"mtp2",141:"mtp3",142:"sccp",143:"docsis",144:"linux_irda",147:"user0",148:"user1",149:"user2",150:"user3",151:"user4",152:"user5",153:"user6",154:"user7",155:"user8",156:"user9",157:"user10",158:"user11",159:"user12",160:"user13",161:"user14",162:"user15",163:"ieee802_11_avs",165:"bacnet_ms_tp",166:"ppp_pppd",169:"gprs_llc",170:"gpf_t",171:"gpf_f",177:"linux_lapd",187:"bluetooth_hci_h4",189:"usb_linux",192:"ppi",195:"ieee802_15_4",196:"sita",197:"erf",201:"bluetooth_hci_h4_with_phdr",202:"ax25_kiss",203:"lapd",204:"ppp_with_dir",205:"c_hdlc_with_dir",206:"frelay_with_dir",209:"ipmb_linux",215:"ieee802_15_4_nonask_phy",220:"usb_linux_mmapped",224:"fc_2",225:"fc_2_with_frame_delims",226:"ipnet",227:"can_socketcan",228:"ipv4",229:"ipv6",230:"ieee802_15_4_nofcs",231:"dbus",235:"dvb_ci",236:"mux27010",237:"stanag_5066_d_pdu",239:"nflog",240:"netanalyzer",241:"netanalyzer_transparent",242:"ipoib",243:"mpeg_2_ts",244:"ng40",245:"nfc_llcp",247:"infiniband",248:"sctp",249:"usbpcap",250:"rtac_serial",251:"bluetooth_le_ll",253:"netlink",254:"bluetooth_linux_monitor",255:"bluetooth_bredr_bb",256:"bluetooth_le_ll_with_phdr",257:"profibus_dl",258:"pktap",259:"epon",260:"ipmi_hpm_2",261:"zwave_r1_r2",262:"zwave_r3",263:"wattstopper_dlm",264:"iso_14443"}}}};export{O as default,P as spec};
