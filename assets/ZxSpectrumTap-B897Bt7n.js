import{k as m}from"./index-COmSdSC_.js";var l=Object.getOwnPropertyNames,b=(o,a)=>function(){return a||(0,o[l(o)[0]])((a={exports:{}}).exports,a),a.exports},c=b({"<stdin>"(o){(function(a,h){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],h):typeof o=="object"&&o!==null&&typeof o.nodeType!="number"?h(o,m.KaitaiStream):h(a.ZxSpectrumTap||(a.ZxSpectrumTap={}),a.KaitaiStream)})(typeof self<"u"?self:o,function(a,h){var d=(function(){t.FlagEnum=Object.freeze({HEADER:0,DATA:255,0:"HEADER",255:"DATA"}),t.HeaderTypeEnum=Object.freeze({PROGRAM:0,NUM_ARRAY:1,CHAR_ARRAY:2,BYTES:3,0:"PROGRAM",1:"NUM_ARRAY",2:"CHAR_ARRAY",3:"BYTES"});function t(e,s,i){this._io=e,this._parent=s,this._root=i||this,this._debug={},this._read()}t.prototype._read=function(){for(this._debug.blocks={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.blocks.arr=[],this.blocks=[];!this._io.isEof();)this._debug.blocks.arr[this.blocks.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.blocks.push(new n(this._io,this,this._root)),this._debug.blocks.arr[this.blocks.length-1].end=this._io.pos;this._debug.blocks.end=this._io.pos};var _=t.ArrayParams=(function(){function e(s,i,r){this._io=s,this._parent=i,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){if(this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readU1(),this._debug.reserved.end=this._io.pos,this._debug.varName={start:this._io.pos,ioOffset:this._io.byteOffset},this.varName=this._io.readU1(),this._debug.varName.end=this._io.pos,this._debug.reserved1={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved1=this._io.readBytes(2),this._debug.reserved1.end=this._io.pos,h.byteArrayCompare(this.reserved1,new Uint8Array([0,128]))!=0){var s=new h.ValidationNotEqualError(new Uint8Array([0,128]),this.reserved1,this._io,"/types/array_params/seq/2");throw this._debug.reserved1.validationError=s,s}},e})(),n=t.Block=(function(){function e(s,i,r){this._io=s,this._parent=i,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.lenBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenBlock=this._io.readU2le(),this._debug.lenBlock.end=this._io.pos,this._debug.flag={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"ZxSpectrumTap.FlagEnum"},this.flag=this._io.readU1(),this._debug.flag.end=this._io.pos,this.lenBlock==19&&this.flag==t.FlagEnum.HEADER&&(this._debug.header={start:this._io.pos,ioOffset:this._io.byteOffset},this.header=new f(this._io,this,this._root),this._debug.header.end=this._io.pos),this.lenBlock==19&&(this._debug.data={start:this._io.pos,ioOffset:this._io.byteOffset},this.data=this._io.readBytes(this.header.lenData+4),this._debug.data.end=this._io.pos),this.flag==t.FlagEnum.DATA&&(this._debug.headerlessData={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerlessData=this._io.readBytes(this.lenBlock-1),this._debug.headerlessData.end=this._io.pos)},e})(),p=t.BytesParams=(function(){function e(s,i,r){this._io=s,this._parent=i,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.startAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.startAddress=this._io.readU2le(),this._debug.startAddress.end=this._io.pos,this._debug.reserved={start:this._io.pos,ioOffset:this._io.byteOffset},this.reserved=this._io.readBytes(2),this._debug.reserved.end=this._io.pos},e})(),f=t.Header=(function(){function e(s,i,r){this._io=s,this._parent=i,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){switch(this._debug.headerType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"ZxSpectrumTap.HeaderTypeEnum"},this.headerType=this._io.readU1(),this._debug.headerType.end=this._io.pos,this._debug.filename={start:this._io.pos,ioOffset:this._io.byteOffset},this.filename=h.bytesStripRight(this._io.readBytes(10),32),this._debug.filename.end=this._io.pos,this._debug.lenData={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenData=this._io.readU2le(),this._debug.lenData.end=this._io.pos,this._debug.params={start:this._io.pos,ioOffset:this._io.byteOffset},this.headerType){case t.HeaderTypeEnum.BYTES:this.params=new p(this._io,this,this._root);break;case t.HeaderTypeEnum.CHAR_ARRAY:this.params=new _(this._io,this,this._root);break;case t.HeaderTypeEnum.NUM_ARRAY:this.params=new _(this._io,this,this._root);break;case t.HeaderTypeEnum.PROGRAM:this.params=new u(this._io,this,this._root);break}this._debug.params.end=this._io.pos,this._debug.checksum={start:this._io.pos,ioOffset:this._io.byteOffset},this.checksum=this._io.readU1(),this._debug.checksum.end=this._io.pos},e})(),u=t.ProgramParams=(function(){function e(s,i,r){this._io=s,this._parent=i,this._root=r,this._debug={},this._read()}return e.prototype._read=function(){this._debug.autostartLine={start:this._io.pos,ioOffset:this._io.byteOffset},this.autostartLine=this._io.readU2le(),this._debug.autostartLine.end=this._io.pos,this._debug.lenProgram={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenProgram=this._io.readU2le(),this._debug.lenProgram.end=this._io.pos},e})();return t})();a.ZxSpectrumTap=d})}});const g=c(),O={id:"zx_spectrum_tap",title:"ZX Spectrum tape file",ksy:{meta:{id:"zx_spectrum_tap",title:"ZX Spectrum tape file","file-extension":"tap",xref:{justsolve:"TAP_(ZX_Spectrum)",pronom:"fmt/801",wikidata:"Q34748140"},license:"CC0-1.0",endian:"le"},doc:`TAP files are used by emulators of ZX Spectrum computer (released in
1982 by Sinclair Research). TAP file stores blocks of data as if
they are written to magnetic tape, which was used as primary media
for ZX Spectrum. Contents of this file can be viewed as a very
simple linear filesystem, storing named files with some basic
metainformation prepended as a header.
`,"doc-ref":"https://sinclair.wiki.zxnet.co.uk/wiki/TAP_format",seq:[{id:"blocks",type:"block",repeat:"eos"}],enums:{flag_enum:{0:"header",255:"data"},header_type_enum:{0:"program",1:"num_array",2:"char_array",3:"bytes"}},types:{block:{seq:[{id:"len_block",type:"u2"},{id:"flag",type:"u1",enum:"flag_enum"},{id:"header",type:"header",if:"len_block == 0x13 and flag == flag_enum::header"},{id:"data",size:"header.len_data + 4",if:"len_block == 0x13"},{id:"headerless_data",size:"len_block - 1",if:"flag == flag_enum::data"}]},header:{seq:[{id:"header_type",type:"u1",enum:"header_type_enum"},{id:"filename",size:10,"pad-right":32},{id:"len_data",type:"u2"},{id:"params",type:{"switch-on":"header_type",cases:{"header_type_enum::program":"program_params","header_type_enum::num_array":"array_params","header_type_enum::char_array":"array_params","header_type_enum::bytes":"bytes_params"}}},{id:"checksum",type:"u1",doc:"Bitwise XOR of all bytes including the flag byte"}]},program_params:{seq:[{id:"autostart_line",type:"u2"},{id:"len_program",type:"u2"}]},array_params:{seq:[{id:"reserved",type:"u1"},{id:"var_name",type:"u1",doc:"Variable name (1..26 meaning A$..Z$ +192)"},{id:"reserved1",contents:[0,128]}]},bytes_params:{seq:[{id:"start_address",type:"u2"},{id:"reserved",size:2}]}}}};export{g as default,O as spec};
