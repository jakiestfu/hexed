import{k as l}from"./index-COA_x_BK.js";var g=Object.getOwnPropertyNames,y=(n,_)=>function(){return _||(0,n[g(n)[0]])((_={exports:{}}).exports,_),_.exports},m=y({"<stdin>"(n){(function(_,s){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],s):typeof n=="object"&&n!==null&&typeof n.nodeType!="number"?s(n,l.KaitaiStream):s(_.Dtb||(_.Dtb={}),_.KaitaiStream)})(typeof self<"u"?self:n,function(_,s){var h=(function(){o.Fdt=Object.freeze({BEGIN_NODE:1,END_NODE:2,PROP:3,NOP:4,END:9,1:"BEGIN_NODE",2:"END_NODE",3:"PROP",4:"NOP",9:"END"});function o(t,e,i){this._io=t,this._parent=e,this._root=i||this,this._debug={},this._read()}o.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(4),this._debug.magic.end=this._io.pos,s.byteArrayCompare(this.magic,new Uint8Array([208,13,254,237]))!=0){var t=new s.ValidationNotEqualError(new Uint8Array([208,13,254,237]),this.magic,this._io,"/seq/0");throw this._debug.magic.validationError=t,t}if(this._debug.totalSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.totalSize=this._io.readU4be(),this._debug.totalSize.end=this._io.pos,this._debug.ofsStructureBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStructureBlock=this._io.readU4be(),this._debug.ofsStructureBlock.end=this._io.pos,this._debug.ofsStringsBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStringsBlock=this._io.readU4be(),this._debug.ofsStringsBlock.end=this._io.pos,this._debug.ofsMemoryReservationBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsMemoryReservationBlock=this._io.readU4be(),this._debug.ofsMemoryReservationBlock.end=this._io.pos,this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=this._io.readU4be(),this._debug.version.end=this._io.pos,this._debug.minCompatibleVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minCompatibleVersion=this._io.readU4be(),this._debug.minCompatibleVersion.end=this._io.pos,!(this.minCompatibleVersion<=this.version)){var t=new s.ValidationGreaterThanError(this.version,this.minCompatibleVersion,this._io,"/seq/6");throw this._debug.minCompatibleVersion.validationError=t,t}this._debug.bootCpuidPhys={start:this._io.pos,ioOffset:this._io.byteOffset},this.bootCpuidPhys=this._io.readU4be(),this._debug.bootCpuidPhys.end=this._io.pos,this._debug.lenStringsBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenStringsBlock=this._io.readU4be(),this._debug.lenStringsBlock.end=this._io.pos,this._debug.lenStructureBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenStructureBlock=this._io.readU4be(),this._debug.lenStructureBlock.end=this._io.pos};var d=o.FdtBeginNode=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=s.bytesToStr(this._io.readBytesTerm(0,!1,!0,!0),"ASCII"),this._debug.name.end=this._io.pos,this._debug.padding={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding=this._io.readBytes(s.mod(-this._io.pos,4)),this._debug.padding.end=this._io.pos},t})(),a=o.FdtBlock=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.nodes={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.nodes.arr=[],this.nodes=[];do{this._debug.nodes.arr[this.nodes.length]={start:this._io.pos,ioOffset:this._io.byteOffset};var e=new f(this._io,this,this._root);this.nodes.push(e),this._debug.nodes.arr[this.nodes.length-1].end=this._io.pos}while(e.type!=o.Fdt.END);this._debug.nodes.end=this._io.pos},t})(),f=o.FdtNode=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){switch(this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"Dtb.Fdt"},this.type=this._io.readU4be(),this._debug.type.end=this._io.pos,this._debug.body={start:this._io.pos,ioOffset:this._io.byteOffset},this.type){case o.Fdt.BEGIN_NODE:this.body=new d(this._io,this,this._root);break;case o.Fdt.PROP:this.body=new p(this._io,this,this._root);break}this._debug.body.end=this._io.pos},t})(),p=o.FdtProp=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.lenProperty={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenProperty=this._io.readU4be(),this._debug.lenProperty.end=this._io.pos,this._debug.ofsName={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsName=this._io.readU4be(),this._debug.ofsName.end=this._io.pos,this._debug.property={start:this._io.pos,ioOffset:this._io.byteOffset},this.property=this._io.readBytes(this.lenProperty),this._debug.property.end=this._io.pos,this._debug.padding={start:this._io.pos,ioOffset:this._io.byteOffset},this.padding=this._io.readBytes(s.mod(-this._io.pos,4)),this._debug.padding.end=this._io.pos},Object.defineProperty(t.prototype,"name",{get:function(){if(this._m_name!==void 0)return this._m_name;var e=this._root.stringsBlock._io,i=e.pos;return e.seek(this.ofsName),this._debug._m_name={start:e.pos,ioOffset:e.byteOffset},this._m_name=s.bytesToStr(e.readBytesTerm(0,!1,!0,!0),"ASCII"),this._debug._m_name.end=e.pos,e.seek(i),this._m_name}}),t})(),u=o.MemoryBlock=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.entries={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.entries.arr=[],this.entries=[];!this._io.isEof();)this._debug.entries.arr[this.entries.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.entries.push(new c(this._io,this,this._root)),this._debug.entries.arr[this.entries.length-1].end=this._io.pos;this._debug.entries.end=this._io.pos},t})(),c=o.MemoryBlockEntry=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){this._debug.address={start:this._io.pos,ioOffset:this._io.byteOffset},this.address=this._io.readU8be(),this._debug.address.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readU8be(),this._debug.size.end=this._io.pos},t})(),b=o.Strings=(function(){function t(e,i,r){this._io=e,this._parent=i,this._root=r,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.strings={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.strings.arr=[],this.strings=[];!this._io.isEof();)this._debug.strings.arr[this.strings.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.strings.push(s.bytesToStr(this._io.readBytesTerm(0,!1,!0,!0),"ASCII")),this._debug.strings.arr[this.strings.length-1].end=this._io.pos;this._debug.strings.end=this._io.pos},t})();return Object.defineProperty(o.prototype,"memoryReservationBlock",{get:function(){if(this._m_memoryReservationBlock!==void 0)return this._m_memoryReservationBlock;var t=this._io.pos;this._io.seek(this.ofsMemoryReservationBlock),this._debug._m_memoryReservationBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_memoryReservationBlock=this._io.readBytes(this.ofsStructureBlock-this.ofsMemoryReservationBlock);var e=new s(this._raw__m_memoryReservationBlock);return this._m_memoryReservationBlock=new u(e,this,this._root),this._debug._m_memoryReservationBlock.end=this._io.pos,this._io.seek(t),this._m_memoryReservationBlock}}),Object.defineProperty(o.prototype,"stringsBlock",{get:function(){if(this._m_stringsBlock!==void 0)return this._m_stringsBlock;var t=this._io.pos;this._io.seek(this.ofsStringsBlock),this._debug._m_stringsBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_stringsBlock=this._io.readBytes(this.lenStringsBlock);var e=new s(this._raw__m_stringsBlock);return this._m_stringsBlock=new b(e,this,this._root),this._debug._m_stringsBlock.end=this._io.pos,this._io.seek(t),this._m_stringsBlock}}),Object.defineProperty(o.prototype,"structureBlock",{get:function(){if(this._m_structureBlock!==void 0)return this._m_structureBlock;var t=this._io.pos;this._io.seek(this.ofsStructureBlock),this._debug._m_structureBlock={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_structureBlock=this._io.readBytes(this.lenStructureBlock);var e=new s(this._raw__m_structureBlock);return this._m_structureBlock=new a(e,this,this._root),this._debug._m_structureBlock.end=this._io.pos,this._io.seek(t),this._m_structureBlock}}),o})();_.Dtb=h})}});const B=m(),O={id:"dtb",title:"Flattened Devicetree Format",ksy:{meta:{id:"dtb",title:"Flattened Devicetree Format","file-extension":"dtb",application:["Linux","Das U-Boot"],xref:{wikidata:"Q16960371"},tags:["linux","serialization"],license:"CC0-1.0","ks-version":.9,encoding:"ASCII",endian:"be"},doc:`Also referred to as Devicetree Blob (DTB). It is a flat binary encoding
of data (primarily devicetree data, although other data is possible as well).
The data is internally stored as a tree of named nodes and properties. Nodes
contain properties and child nodes, while properties are name-value pairs.

The Devicetree Blobs (\`.dtb\` files) are compiled from the Devicetree Source
files (\`.dts\`) through the Devicetree compiler (DTC).

On Linux systems that support this, the blobs can be accessed in
\`/sys/firmware/fdt\`:

* <https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-firmware-ofw>

The encoding of strings used in the \`strings_block\` and \`structure_block\` is
actually a subset of ASCII:

<https://devicetree-specification.readthedocs.io/en/v0.3/devicetree-basics.html#node-names>

Example files:

* <https://github.com/qemu/qemu/tree/master/pc-bios>
`,"doc-ref":["https://devicetree-specification.readthedocs.io/en/v0.3/flattened-format.html","https://elinux.org/images/f/f4/Elc2013_Fernandes.pdf"],seq:[{id:"magic","-orig-id":"magic",contents:[208,13,254,237]},{id:"total_size","-orig-id":"totalsize",type:"u4"},{id:"ofs_structure_block","-orig-id":"off_dt_struct",type:"u4"},{id:"ofs_strings_block","-orig-id":"off_dt_strings",type:"u4"},{id:"ofs_memory_reservation_block","-orig-id":"off_mem_rsvmap",type:"u4"},{id:"version",type:"u4"},{id:"min_compatible_version","-orig-id":"last_comp_version",type:"u4",valid:{max:"version"}},{id:"boot_cpuid_phys","-orig-id":"boot_cpuid_phys",type:"u4"},{id:"len_strings_block","-orig-id":"size_dt_strings",type:"u4"},{id:"len_structure_block","-orig-id":"size_dt_struct",type:"u4"}],instances:{memory_reservation_block:{pos:"ofs_memory_reservation_block",size:"ofs_structure_block - ofs_memory_reservation_block",type:"memory_block"},structure_block:{pos:"ofs_structure_block",size:"len_structure_block",type:"fdt_block"},strings_block:{pos:"ofs_strings_block",size:"len_strings_block",type:"strings"}},types:{memory_block:{seq:[{id:"entries",type:"memory_block_entry",repeat:"eos"}]},memory_block_entry:{seq:[{id:"address",type:"u8",doc:"physical address of a reserved memory region"},{id:"size",type:"u8",doc:"size of a reserved memory region"}]},fdt_block:{seq:[{id:"nodes",type:"fdt_node",repeat:"until","repeat-until":"_.type == fdt::end"}]},fdt_node:{"-webide-representation":"{type} {body}",seq:[{id:"type",type:"u4",enum:"fdt"},{id:"body",type:{"switch-on":"type",cases:{"fdt::begin_node":"fdt_begin_node","fdt::prop":"fdt_prop"}}}]},fdt_begin_node:{"-webide-representation":"{name}",seq:[{id:"name",type:"strz"},{id:"padding",size:"(- _io.pos) % 4"}]},fdt_prop:{"-webide-representation":"{name}",seq:[{id:"len_property","-orig-id":"len",type:"u4"},{id:"ofs_name","-orig-id":"nameoff",type:"u4"},{id:"property",size:"len_property"},{id:"padding",size:"(- _io.pos) % 4"}],instances:{name:{io:"_root.strings_block._io",pos:"ofs_name",type:"strz","-webide-parse-mode":"eager"}}},strings:{seq:[{id:"strings",type:"strz",repeat:"eos"}]}},enums:{fdt:{1:"begin_node",2:"end_node",3:"prop",4:"nop",9:"end"}}}};export{B as default,O as spec};
