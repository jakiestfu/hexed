import{k as g}from"./index-ik_lyK6M.js";var y=Object.getOwnPropertyNames,c=(h,_)=>function(){return _||(0,h[y(h)[0]])((_={exports:{}}).exports,_),_.exports},v=c({"<stdin>"(h){(function(_,r){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],r):typeof h=="object"&&h!==null&&typeof h.nodeType!="number"?r(h,g.KaitaiStream):r(_.GettextMo||(_.GettextMo={}),_.KaitaiStream)})(typeof self<"u"?self:h,function(_,r){var d=(function(){function f(i,o,n){this._io=i,this._parent=o,this._root=n||this,this._debug={},this._read()}f.prototype._read=function(){this._debug.signature={start:this._io.pos,ioOffset:this._io.byteOffset},this.signature=this._io.readBytes(4),this._debug.signature.end=this._io.pos,this._debug.mo={start:this._io.pos,ioOffset:this._io.byteOffset},this.mo=new b(this._io,this,this._root),this._debug.mo.end=this._io.pos};var p=f.HashLookupIteration=(function(){function i(o,n,a,t,e){this._io=o,this._parent=n,this._root=a,this.idx=t,this.collisionStep=e,this._debug={},this._read()}return i.prototype._read=function(){},Object.defineProperty(i.prototype,"next",{get:function(){if(this._m_next!==void 0)return this._m_next;var o=this._io.pos;return this._io.seek(0),this._debug._m_next={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_next=new i(this._io,this,this._root,this._root.mo.hashtableItems[this.nextIdx].val,this.collisionStep),this._debug._m_next.end=this._io.pos,this._io.seek(o),this._m_next}}),Object.defineProperty(i.prototype,"nextIdx",{get:function(){return this._m_nextIdx!==void 0?this._m_nextIdx:(this._debug._m_nextIdx={},this._m_nextIdx=this.idx+this.collisionStep-(this.idx>=this._root.mo.numHashtableItems-this.collisionStep?this._root.mo.numHashtableItems:0),this._m_nextIdx)}}),Object.defineProperty(i.prototype,"original",{get:function(){return this._m_original!==void 0?this._m_original:(this._debug._m_original={},this._m_original=this._root.mo.originals[this.idx].str,this._m_original)}}),Object.defineProperty(i.prototype,"translation",{get:function(){return this._m_translation!==void 0?this._m_translation:(this._debug._m_translation={},this._m_translation=this._root.mo.translations[this.idx].str,this._m_translation)}}),i})();f.HashtableLookup=(function(){function i(o,n,a,t,e){this._io=o,this._parent=n,this._root=a,this.query=t,this.hash=e,this._debug={},this._read()}return i.prototype._read=function(){},Object.defineProperty(i.prototype,"collisionStep",{get:function(){return this._m_collisionStep!==void 0?this._m_collisionStep:(this._debug._m_collisionStep={},this._m_collisionStep=r.mod(this.hash,this._root.mo.numHashtableItems-2)+1,this._m_collisionStep)}}),Object.defineProperty(i.prototype,"entry",{get:function(){if(this._m_entry!==void 0)return this._m_entry;var o=this._io.pos;return this._io.seek(0),this._debug._m_entry={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_entry=new m(this._io,this,this._root,this.hashLookupIteration,this.query),this._debug._m_entry.end=this._io.pos,this._io.seek(o),this._m_entry}}),Object.defineProperty(i.prototype,"hashLookupIteration",{get:function(){if(this._m_hashLookupIteration!==void 0)return this._m_hashLookupIteration;var o=this._io.pos;return this._io.seek(0),this._debug._m_hashLookupIteration={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_hashLookupIteration=new p(this._io,this,this._root,this._root.mo.hashtableItems[this.idx].val,this.collisionStep),this._debug._m_hashLookupIteration.end=this._io.pos,this._io.seek(o),this._m_hashLookupIteration}}),Object.defineProperty(i.prototype,"idx",{get:function(){return this._m_idx!==void 0?this._m_idx:(this._debug._m_idx={},this._m_idx=r.mod(this.hash,this._root.mo.numHashtableItems),this._m_idx)}}),i})();var m=f.LookupIteration=(function(){function i(o,n,a,t,e){this._io=o,this._parent=n,this._root=a,this.current=t,this.query=e,this._debug={},this._read()}return i.prototype._read=function(){},Object.defineProperty(i.prototype,"found",{get:function(){return this._m_found!==void 0?this._m_found:(this._debug._m_found={},this._m_found=this.query==this.current.original,this._m_found)}}),Object.defineProperty(i.prototype,"next",{get:function(){if(this._m_next!==void 0)return this._m_next;if(!this.found){var o=this._io.pos;this._io.seek(0),this._debug._m_next={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_next=new i(this._io,this,this._root,this.current.next,this.query),this._debug._m_next.end=this._io.pos,this._io.seek(o)}return this._m_next}}),i})(),b=f.Mo=(function(){function i(t,e,s){this._io=t,this._parent=e,this._root=s,this._debug={},this._read()}i.prototype._read=function(){{var t=this._root.signature;r.byteArrayCompare(t,new Uint8Array([222,18,4,149]))==0?this._is_le=!0:r.byteArrayCompare(t,new Uint8Array([149,4,18,222]))==0&&(this._is_le=!1)}if(this._is_le===!0)this._readLE();else if(this._is_le===!1)this._readBE();else throw new r.UndecidedEndiannessError},i.prototype._readLE=function(){this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=new a(this._io,this,this._root,this._is_le),this._debug.version.end=this._io.pos,this._debug.numTranslations={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTranslations=this._io.readU4le(),this._debug.numTranslations.end=this._io.pos,this._debug.ofsOriginals={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsOriginals=this._io.readU4le(),this._debug.ofsOriginals.end=this._io.pos,this._debug.ofsTranslations={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsTranslations=this._io.readU4le(),this._debug.ofsTranslations.end=this._io.pos,this._debug.numHashtableItems={start:this._io.pos,ioOffset:this._io.byteOffset},this.numHashtableItems=this._io.readU4le(),this._debug.numHashtableItems.end=this._io.pos,this._debug.ofsHashtableItems={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsHashtableItems=this._io.readU4le(),this._debug.ofsHashtableItems.end=this._io.pos},i.prototype._readBE=function(){this._debug.version={start:this._io.pos,ioOffset:this._io.byteOffset},this.version=new a(this._io,this,this._root,this._is_le),this._debug.version.end=this._io.pos,this._debug.numTranslations={start:this._io.pos,ioOffset:this._io.byteOffset},this.numTranslations=this._io.readU4be(),this._debug.numTranslations.end=this._io.pos,this._debug.ofsOriginals={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsOriginals=this._io.readU4be(),this._debug.ofsOriginals.end=this._io.pos,this._debug.ofsTranslations={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsTranslations=this._io.readU4be(),this._debug.ofsTranslations.end=this._io.pos,this._debug.numHashtableItems={start:this._io.pos,ioOffset:this._io.byteOffset},this.numHashtableItems=this._io.readU4be(),this._debug.numHashtableItems.end=this._io.pos,this._debug.ofsHashtableItems={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsHashtableItems=this._io.readU4be(),this._debug.ofsHashtableItems.end=this._io.pos};var o=i.Descriptor=(function(){function t(e,s,l,u){this._io=e,this._parent=s,this._root=l,this._is_le=u,this._debug={},this._read()}return t.prototype._read=function(){if(this._is_le===!0)this._readLE();else if(this._is_le===!1)this._readBE();else throw new r.UndecidedEndiannessError},t.prototype._readLE=function(){this._debug.lenStr={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenStr=this._io.readU4le(),this._debug.lenStr.end=this._io.pos,this._debug.ofsStr={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStr=this._io.readU4le(),this._debug.ofsStr.end=this._io.pos},t.prototype._readBE=function(){this._debug.lenStr={start:this._io.pos,ioOffset:this._io.byteOffset},this.lenStr=this._io.readU4be(),this._debug.lenStr.end=this._io.pos,this._debug.ofsStr={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsStr=this._io.readU4be(),this._debug.ofsStr.end=this._io.pos},Object.defineProperty(t.prototype,"str",{get:function(){if(this._m_str!==void 0)return this._m_str;var e=this._root._io,s=e.pos;return e.seek(this.ofsStr),this._is_le?(this._debug._m_str={start:e.pos,ioOffset:e.byteOffset},this._m_str=r.bytesToStr(r.bytesTerminate(e.readBytes(this.lenStr),0,!1),"UTF-8"),this._debug._m_str.end=e.pos):(this._debug._m_str={start:e.pos,ioOffset:e.byteOffset},this._m_str=r.bytesToStr(r.bytesTerminate(e.readBytes(this.lenStr),0,!1),"UTF-8"),this._debug._m_str.end=e.pos),e.seek(s),this._m_str}}),t})(),n=i.HashtableItem=(function(){function t(e,s,l,u){this._io=e,this._parent=s,this._root=l,this._is_le=u,this._debug={},this._read()}return t.prototype._read=function(){if(this._is_le===!0)this._readLE();else if(this._is_le===!1)this._readBE();else throw new r.UndecidedEndiannessError},t.prototype._readLE=function(){this._debug.rawVal={start:this._io.pos,ioOffset:this._io.byteOffset},this.rawVal=this._io.readU4le(),this._debug.rawVal.end=this._io.pos},t.prototype._readBE=function(){this._debug.rawVal={start:this._io.pos,ioOffset:this._io.byteOffset},this.rawVal=this._io.readU4be(),this._debug.rawVal.end=this._io.pos},Object.defineProperty(t.prototype,"isSystemDependent",{get:function(){return this._m_isSystemDependent!==void 0?this._m_isSystemDependent:(this.rawVal!=0&&(this._debug._m_isSystemDependent={},this._m_isSystemDependent=(this.val1&this.mask)==1),this._m_isSystemDependent)}}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._m_mask!==void 0?this._m_mask:(this._debug._m_mask={},this._m_mask=2147483648,this._m_mask)}}),Object.defineProperty(t.prototype,"val",{get:function(){return this._m_val!==void 0?this._m_val:(this.rawVal!=0&&(this._debug._m_val={},this._m_val=this.val1&~this.mask),this._m_val)}}),Object.defineProperty(t.prototype,"val1",{get:function(){return this._m_val1!==void 0?this._m_val1:(this.rawVal!=0&&(this._debug._m_val1={},this._m_val1=this.rawVal-1),this._m_val1)}}),t})(),a=i.Version=(function(){function t(e,s,l,u){this._io=e,this._parent=s,this._root=l,this._is_le=u,this._debug={},this._read()}return t.prototype._read=function(){if(this._is_le===!0)this._readLE();else if(this._is_le===!1)this._readBE();else throw new r.UndecidedEndiannessError},t.prototype._readLE=function(){this._debug.versionRaw={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionRaw=this._io.readU4le(),this._debug.versionRaw.end=this._io.pos},t.prototype._readBE=function(){this._debug.versionRaw={start:this._io.pos,ioOffset:this._io.byteOffset},this.versionRaw=this._io.readU4be(),this._debug.versionRaw.end=this._io.pos},Object.defineProperty(t.prototype,"major",{get:function(){return this._m_major!==void 0?this._m_major:(this._debug._m_major={},this._m_major=this.versionRaw>>>16,this._m_major)}}),Object.defineProperty(t.prototype,"minor",{get:function(){return this._m_minor!==void 0?this._m_minor:(this._debug._m_minor={},this._m_minor=this.versionRaw&65535,this._m_minor)}}),t})();return Object.defineProperty(i.prototype,"hashtableItems",{get:function(){if(this._m_hashtableItems!==void 0)return this._m_hashtableItems;if(this.ofsHashtableItems!=0){var t=this._root._io,e=t.pos;if(t.seek(this.ofsHashtableItems),this._debug._m_hashtableItems={start:t.pos,ioOffset:t.byteOffset},this._debug._m_hashtableItems.arr=[],this._is_le){this._m_hashtableItems=[];for(var s=0;s<this.numHashtableItems;s++)this._debug._m_hashtableItems.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_hashtableItems.push(new n(t,this,this._root,this._is_le)),this._debug._m_hashtableItems.arr[s].end=t.pos}else{this._m_hashtableItems=[];for(var s=0;s<this.numHashtableItems;s++)this._debug._m_hashtableItems.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_hashtableItems.push(new n(t,this,this._root,this._is_le)),this._debug._m_hashtableItems.arr[s].end=t.pos}this._debug._m_hashtableItems.end=t.pos,t.seek(e)}return this._m_hashtableItems}}),Object.defineProperty(i.prototype,"originals",{get:function(){if(this._m_originals!==void 0)return this._m_originals;var t=this._root._io,e=t.pos;if(t.seek(this.ofsOriginals),this._debug._m_originals={start:t.pos,ioOffset:t.byteOffset},this._debug._m_originals.arr=[],this._is_le){this._m_originals=[];for(var s=0;s<this.numTranslations;s++)this._debug._m_originals.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_originals.push(new o(t,this,this._root,this._is_le)),this._debug._m_originals.arr[s].end=t.pos}else{this._m_originals=[];for(var s=0;s<this.numTranslations;s++)this._debug._m_originals.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_originals.push(new o(t,this,this._root,this._is_le)),this._debug._m_originals.arr[s].end=t.pos}return this._debug._m_originals.end=t.pos,t.seek(e),this._m_originals}}),Object.defineProperty(i.prototype,"translations",{get:function(){if(this._m_translations!==void 0)return this._m_translations;var t=this._root._io,e=t.pos;if(t.seek(this.ofsTranslations),this._debug._m_translations={start:t.pos,ioOffset:t.byteOffset},this._debug._m_translations.arr=[],this._is_le){this._m_translations=[];for(var s=0;s<this.numTranslations;s++)this._debug._m_translations.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_translations.push(new o(t,this,this._root,this._is_le)),this._debug._m_translations.arr[s].end=t.pos}else{this._m_translations=[];for(var s=0;s<this.numTranslations;s++)this._debug._m_translations.arr[s]={start:t.pos,ioOffset:t.byteOffset},this._m_translations.push(new o(t,this,this._root,this._is_le)),this._debug._m_translations.arr[s].end=t.pos}return this._debug._m_translations.end=t.pos,t.seek(e),this._m_translations}}),i})();return f})();_.GettextMo=d})}});const x=v(),w={id:"gettext_mo",title:"gettext binary database",ksy:{meta:{id:"gettext_mo",title:"gettext binary database",application:["GNU gettext","libintl"],"file-extension":"mo",xref:{justsolve:"Gettext_MO_(Machine_Object)_file",wikidata:["Q105856977","Q105857131"]},tags:["database","linux"],license:"BSD-2-Clause","ks-version":.9,encoding:"UTF-8"},doc:`[GNU gettext](https://www.gnu.org/software/gettext/) is a popular
solution in free/open source software world to do i18n/l10n of
software, by providing translated strings that will substitute
strings in original language (typically, English).

gettext .mo is a binary database format which stores these string
translation pairs in an efficient binary format, ready to be used by
gettext-enabled software. .mo format is a result of compilation of
text-based .po files using
[msgfmt](https://www.gnu.org/software/gettext/manual/html_node/msgfmt-Invocation.html#msgfmt-Invocation)
utility. The reverse conversion (.mo -> .po) is also possible using
[msgunfmt](https://www.gnu.org/software/gettext/manual/html_node/msgunfmt-Invocation.html#msgunfmt-Invocation)
decompiler utility.
`,"doc-ref":"https://gitlab.com/worr/libintl",seq:[{id:"signature",size:4},{id:"mo",type:"mo"}],types:{hash_lookup_iteration:{params:[{id:"idx",type:"u4"},{id:"collision_step",type:"u4"}],instances:{original:{value:"_root.mo.originals[idx].str"},translation:{value:"_root.mo.translations[idx].str"},next_idx:{value:"idx + collision_step - (idx >= _root.mo.num_hashtable_items - collision_step ? _root.mo.num_hashtable_items : 0)"},next:{pos:0,type:"hash_lookup_iteration(_root.mo.hashtable_items[next_idx].val, collision_step)"}}},lookup_iteration:{params:[{id:"current",type:"hash_lookup_iteration"},{id:"query",type:"str"}],instances:{found:{value:"query == current.original"},next:{pos:0,type:"lookup_iteration(current.next, query)",if:"not found"}}},hashtable_lookup:{doc:`def lookup(s:str, t:gettext_mo.GettextMo):
  try:
    l=gettext_mo.GettextMo.HashtableLookup(s, string_hash(s), t._io, _parent=t, _root=t)
    e=l.entry
    while(not e.found):
      e=e.next
    return e.current
  except:
    raise Exception("Not found "+s+" in the hashtable!")

lookup(t.mo.originals[145].str, t)
`,"doc-ref":"https://gitlab.com/worr/libintl/raw/master/src/lib/libintl/gettext.c",params:[{id:"query",type:"str"},{id:"hash",type:"u4","doc-ref":"https://gitlab.com/worr/libintl/raw/master/src/lib/libintl/strhash.c",doc:`def string_hash(s):
  s=s.encode("utf-8")
  h = 0
  for i in range(len(s)):
    h = h << 4
    h += s[i]
    tmp = h & 0xF0000000
    if tmp != 0:
      h ^= tmp
      h ^= tmp >> 24
  return h
`}],instances:{collision_step:{value:"hash % (_root.mo.num_hashtable_items - 2) + 1"},idx:{value:"hash % _root.mo.num_hashtable_items"},hash_lookup_iteration:{pos:0,type:"hash_lookup_iteration(_root.mo.hashtable_items[idx].val, collision_step)"},entry:{pos:0,type:"lookup_iteration(hash_lookup_iteration, query)"}}},mo:{meta:{endian:{"switch-on":"_root.signature",cases:{"[0xde, 0x12, 0x04, 0x95]":"le","[0x95, 0x04, 0x12, 0xde]":"be"}}},seq:[{id:"version",type:"version"},{id:"num_translations",type:"u4"},{id:"ofs_originals",type:"u4"},{id:"ofs_translations",type:"u4"},{id:"num_hashtable_items",type:"u4"},{id:"ofs_hashtable_items",type:"u4"}],instances:{originals:{io:"_root._io",pos:"ofs_originals",type:"descriptor",repeat:"expr","repeat-expr":"num_translations"},translations:{io:"_root._io",pos:"ofs_translations",type:"descriptor",repeat:"expr","repeat-expr":"num_translations"},hashtable_items:{io:"_root._io",pos:"ofs_hashtable_items",type:"hashtable_item",repeat:"expr","repeat-expr":"num_hashtable_items",if:"ofs_hashtable_items != 0"}},types:{version:{seq:[{id:"version_raw",type:"u4"}],instances:{major:{value:"version_raw >> 16"},minor:{value:"version_raw & 0xffff"}}},hashtable_item:{seq:[{id:"raw_val",type:"u4"}],instances:{mask:{value:2147483648},val_1:{value:"raw_val - 1",if:"raw_val != 0"},is_system_dependent:{value:"val_1 & mask == 1",if:"raw_val != 0"},val:{value:"val_1 & ~mask",if:"raw_val != 0"}}},descriptor:{seq:[{id:"len_str",type:"u4"},{id:"ofs_str",type:"u4"}],instances:{str:{io:"_root._io",pos:"ofs_str",size:"len_str",type:"strz"}}}}}}}};export{x as default,w as spec};
