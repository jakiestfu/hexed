import{k as P}from"./index-DQZRlv-R.js";var I=Object.getOwnPropertyNames,v=(h,a)=>function(){return a||(0,h[I(h)[0]])((a={exports:{}}).exports,a),a.exports},T=v({"<stdin>"(h){(function(a,_){typeof define=="function"&&define.amd?define(["exports","kaitai-struct/KaitaiStream"],_):typeof h=="object"&&h!==null&&typeof h.nodeType!="number"?_(h,P.KaitaiStream):_(a.MicrosoftPe||(a.MicrosoftPe={}),a.KaitaiStream)})(typeof self<"u"?self:h,function(a,_){var n=(function(){o.PeFormat=Object.freeze({ROM_IMAGE:263,PE32:267,PE32_PLUS:523,263:"ROM_IMAGE",267:"PE32",523:"PE32_PLUS"});function o(t,i,e){this._io=t,this._parent=i,this._root=e||this,this._debug={},this._read()}o.prototype._read=function(){this._debug.mz={start:this._io.pos,ioOffset:this._io.byteOffset},this.mz=new m(this._io,this,this._root),this._debug.mz.end=this._io.pos};var d=o.Annoyingstring=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){},Object.defineProperty(t.prototype,"name",{get:function(){return this._m_name!==void 0?this._m_name:(this._debug._m_name={},this._m_name=this.nameZeroes==0?this.nameFromOffset:this.nameFromShort,this._m_name)}}),Object.defineProperty(t.prototype,"nameFromOffset",{get:function(){if(this._m_nameFromOffset!==void 0)return this._m_nameFromOffset;if(this.nameZeroes==0){var i=this._root._io,e=i.pos;i.seek(this.nameZeroes==0?this._parent._parent.symbolNameTableOffset+this.nameOffset:0),this._debug._m_nameFromOffset={start:i.pos,ioOffset:i.byteOffset},this._m_nameFromOffset=_.bytesToStr(i.readBytesTerm(0,!1,!0,!1),"ASCII"),this._debug._m_nameFromOffset.end=i.pos,i.seek(e)}return this._m_nameFromOffset}}),Object.defineProperty(t.prototype,"nameFromShort",{get:function(){if(this._m_nameFromShort!==void 0)return this._m_nameFromShort;if(this.nameZeroes!=0){var i=this._io.pos;this._io.seek(0),this._debug._m_nameFromShort={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_nameFromShort=_.bytesToStr(this._io.readBytesTerm(0,!1,!0,!1),"ASCII"),this._debug._m_nameFromShort.end=this._io.pos,this._io.seek(i)}return this._m_nameFromShort}}),Object.defineProperty(t.prototype,"nameOffset",{get:function(){if(this._m_nameOffset!==void 0)return this._m_nameOffset;var i=this._io.pos;return this._io.seek(4),this._debug._m_nameOffset={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_nameOffset=this._io.readU4le(),this._debug._m_nameOffset.end=this._io.pos,this._io.seek(i),this._m_nameOffset}}),Object.defineProperty(t.prototype,"nameZeroes",{get:function(){if(this._m_nameZeroes!==void 0)return this._m_nameZeroes;var i=this._io.pos;return this._io.seek(0),this._debug._m_nameZeroes={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_nameZeroes=this._io.readU4le(),this._debug._m_nameZeroes.end=this._io.pos,this._io.seek(i),this._m_nameZeroes}}),t})(),f=o.CertificateEntry=(function(){t.CertificateRevision=Object.freeze({REVISION_1_0:256,REVISION_2_0:512,256:"REVISION_1_0",512:"REVISION_2_0"}),t.CertificateTypeEnum=Object.freeze({X509:1,PKCS_SIGNED_DATA:2,RESERVED_1:3,TS_STACK_SIGNED:4,1:"X509",2:"PKCS_SIGNED_DATA",3:"RESERVED_1",4:"TS_STACK_SIGNED"});function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.length={start:this._io.pos,ioOffset:this._io.byteOffset},this.length=this._io.readU4le(),this._debug.length.end=this._io.pos,this._debug.revision={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftPe.CertificateEntry.CertificateRevision"},this.revision=this._io.readU2le(),this._debug.revision.end=this._io.pos,this._debug.certificateType={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftPe.CertificateEntry.CertificateTypeEnum"},this.certificateType=this._io.readU2le(),this._debug.certificateType.end=this._io.pos,this._debug.certificateBytes={start:this._io.pos,ioOffset:this._io.byteOffset},this.certificateBytes=this._io.readBytes(this.length-8),this._debug.certificateBytes.end=this._io.pos},t})(),p=o.CertificateTable=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){for(this._debug.items={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.items.arr=[],this.items=[];!this._io.isEof();)this._debug.items.arr[this.items.length]={start:this._io.pos,ioOffset:this._io.byteOffset},this.items.push(new f(this._io,this,this._root)),this._debug.items.arr[this.items.length-1].end=this._io.pos;this._debug.items.end=this._io.pos},t})(),b=o.CoffHeader=(function(){t.MachineType=Object.freeze({UNKNOWN:0,I386:332,R4000:358,WCE_MIPS_V2:361,ALPHA:388,SH3:418,SH3_DSP:419,SH4:422,SH5:424,ARM:448,THUMB:450,ARM_NT:452,AM33:467,POWERPC:496,POWERPC_FP:497,IA64:512,MIPS16:614,ALPHA64_OR_AXP64:644,MIPS_FPU:870,MIPS16_FPU:1126,EBC:3772,RISCV32:20530,RISCV64:20580,RISCV128:20776,LOONGARCH32:25138,LOONGARCH64:25188,AMD64:34404,M32R:36929,ARM64:43620,0:"UNKNOWN",332:"I386",358:"R4000",361:"WCE_MIPS_V2",388:"ALPHA",418:"SH3",419:"SH3_DSP",422:"SH4",424:"SH5",448:"ARM",450:"THUMB",452:"ARM_NT",467:"AM33",496:"POWERPC",497:"POWERPC_FP",512:"IA64",614:"MIPS16",644:"ALPHA64_OR_AXP64",870:"MIPS_FPU",1126:"MIPS16_FPU",3772:"EBC",20530:"RISCV32",20580:"RISCV64",20776:"RISCV128",25138:"LOONGARCH32",25188:"LOONGARCH64",34404:"AMD64",36929:"M32R",43620:"ARM64"});function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.machine={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftPe.CoffHeader.MachineType"},this.machine=this._io.readU2le(),this._debug.machine.end=this._io.pos,this._debug.numberOfSections={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfSections=this._io.readU2le(),this._debug.numberOfSections.end=this._io.pos,this._debug.timeDateStamp={start:this._io.pos,ioOffset:this._io.byteOffset},this.timeDateStamp=this._io.readU4le(),this._debug.timeDateStamp.end=this._io.pos,this._debug.pointerToSymbolTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToSymbolTable=this._io.readU4le(),this._debug.pointerToSymbolTable.end=this._io.pos,this._debug.numberOfSymbols={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfSymbols=this._io.readU4le(),this._debug.numberOfSymbols.end=this._io.pos,this._debug.sizeOfOptionalHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfOptionalHeader=this._io.readU2le(),this._debug.sizeOfOptionalHeader.end=this._io.pos,this._debug.characteristics={start:this._io.pos,ioOffset:this._io.byteOffset},this.characteristics=this._io.readU2le(),this._debug.characteristics.end=this._io.pos},Object.defineProperty(t.prototype,"symbolNameTableOffset",{get:function(){return this._m_symbolNameTableOffset!==void 0?this._m_symbolNameTableOffset:(this._debug._m_symbolNameTableOffset={},this._m_symbolNameTableOffset=this.pointerToSymbolTable+this.symbolTableSize,this._m_symbolNameTableOffset)}}),Object.defineProperty(t.prototype,"symbolNameTableSize",{get:function(){if(this._m_symbolNameTableSize!==void 0)return this._m_symbolNameTableSize;var i=this._io.pos;return this._io.seek(this.symbolNameTableOffset),this._debug._m_symbolNameTableSize={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_symbolNameTableSize=this._io.readU4le(),this._debug._m_symbolNameTableSize.end=this._io.pos,this._io.seek(i),this._m_symbolNameTableSize}}),Object.defineProperty(t.prototype,"symbolTable",{get:function(){if(this._m_symbolTable!==void 0)return this._m_symbolTable;var i=this._io.pos;this._io.seek(this.pointerToSymbolTable),this._debug._m_symbolTable={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug._m_symbolTable.arr=[],this._m_symbolTable=[];for(var e=0;e<this.numberOfSymbols;e++)this._debug._m_symbolTable.arr[e]={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_symbolTable.push(new u(this._io,this,this._root)),this._debug._m_symbolTable.arr[e].end=this._io.pos;return this._debug._m_symbolTable.end=this._io.pos,this._io.seek(i),this._m_symbolTable}}),Object.defineProperty(t.prototype,"symbolTableSize",{get:function(){return this._m_symbolTableSize!==void 0?this._m_symbolTableSize:(this._debug._m_symbolTableSize={},this._m_symbolTableSize=this.numberOfSymbols*18,this._m_symbolTableSize)}}),t})(),u=o.CoffSymbol=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.nameAnnoying={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_nameAnnoying=this._io.readBytes(8);var i=new _(this._raw_nameAnnoying);this.nameAnnoying=new d(i,this,this._root),this._debug.nameAnnoying.end=this._io.pos,this._debug.value={start:this._io.pos,ioOffset:this._io.byteOffset},this.value=this._io.readU4le(),this._debug.value.end=this._io.pos,this._debug.sectionNumber={start:this._io.pos,ioOffset:this._io.byteOffset},this.sectionNumber=this._io.readU2le(),this._debug.sectionNumber.end=this._io.pos,this._debug.type={start:this._io.pos,ioOffset:this._io.byteOffset},this.type=this._io.readU2le(),this._debug.type.end=this._io.pos,this._debug.storageClass={start:this._io.pos,ioOffset:this._io.byteOffset},this.storageClass=this._io.readU1(),this._debug.storageClass.end=this._io.pos,this._debug.numberOfAuxSymbols={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfAuxSymbols=this._io.readU1(),this._debug.numberOfAuxSymbols.end=this._io.pos},Object.defineProperty(t.prototype,"data",{get:function(){if(this._m_data!==void 0)return this._m_data;var i=this._io.pos;return this._io.seek(this.section.pointerToRawData+this.value),this._debug._m_data={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_data=this._io.readBytes(1),this._debug._m_data.end=this._io.pos,this._io.seek(i),this._m_data}}),Object.defineProperty(t.prototype,"section",{get:function(){return this._m_section!==void 0?this._m_section:(this._debug._m_section={},this._m_section=this._root.pe.sections[this.sectionNumber-1],this._m_section)}}),t})(),r=o.DataDir=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.virtualAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualAddress=this._io.readU4le(),this._debug.virtualAddress.end=this._io.pos,this._debug.size={start:this._io.pos,ioOffset:this._io.byteOffset},this.size=this._io.readU4le(),this._debug.size.end=this._io.pos},t})(),m=o.MzPlaceholder=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.magic={start:this._io.pos,ioOffset:this._io.byteOffset},this.magic=this._io.readBytes(2),this._debug.magic.end=this._io.pos,_.byteArrayCompare(this.magic,new Uint8Array([77,90]))!=0){var i=new _.ValidationNotEqualError(new Uint8Array([77,90]),this.magic,this._io,"/types/mz_placeholder/seq/0");throw this._debug.magic.validationError=i,i}this._debug.data1={start:this._io.pos,ioOffset:this._io.byteOffset},this.data1=this._io.readBytes(58),this._debug.data1.end=this._io.pos,this._debug.ofsPe={start:this._io.pos,ioOffset:this._io.byteOffset},this.ofsPe=this._io.readU4le(),this._debug.ofsPe.end=this._io.pos},t})(),c=o.OptionalHeader=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.std={start:this._io.pos,ioOffset:this._io.byteOffset},this.std=new y(this._io,this,this._root),this._debug.std.end=this._io.pos,this._debug.windows={start:this._io.pos,ioOffset:this._io.byteOffset},this.windows=new O(this._io,this,this._root),this._debug.windows.end=this._io.pos,this._debug.dataDirs={start:this._io.pos,ioOffset:this._io.byteOffset},this.dataDirs=new l(this._io,this,this._root),this._debug.dataDirs.end=this._io.pos},t})(),l=o.OptionalHeaderDataDirs=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.exportTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.exportTable=new r(this._io,this,this._root),this._debug.exportTable.end=this._io.pos,this._debug.importTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.importTable=new r(this._io,this,this._root),this._debug.importTable.end=this._io.pos,this._debug.resourceTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.resourceTable=new r(this._io,this,this._root),this._debug.resourceTable.end=this._io.pos,this._debug.exceptionTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.exceptionTable=new r(this._io,this,this._root),this._debug.exceptionTable.end=this._io.pos,this._debug.certificateTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.certificateTable=new r(this._io,this,this._root),this._debug.certificateTable.end=this._io.pos,this._debug.baseRelocationTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.baseRelocationTable=new r(this._io,this,this._root),this._debug.baseRelocationTable.end=this._io.pos,this._debug.debug={start:this._io.pos,ioOffset:this._io.byteOffset},this.debug=new r(this._io,this,this._root),this._debug.debug.end=this._io.pos,this._debug.architecture={start:this._io.pos,ioOffset:this._io.byteOffset},this.architecture=new r(this._io,this,this._root),this._debug.architecture.end=this._io.pos,this._debug.globalPtr={start:this._io.pos,ioOffset:this._io.byteOffset},this.globalPtr=new r(this._io,this,this._root),this._debug.globalPtr.end=this._io.pos,this._debug.tlsTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.tlsTable=new r(this._io,this,this._root),this._debug.tlsTable.end=this._io.pos,this._debug.loadConfigTable={start:this._io.pos,ioOffset:this._io.byteOffset},this.loadConfigTable=new r(this._io,this,this._root),this._debug.loadConfigTable.end=this._io.pos,this._debug.boundImport={start:this._io.pos,ioOffset:this._io.byteOffset},this.boundImport=new r(this._io,this,this._root),this._debug.boundImport.end=this._io.pos,this._debug.iat={start:this._io.pos,ioOffset:this._io.byteOffset},this.iat=new r(this._io,this,this._root),this._debug.iat.end=this._io.pos,this._debug.delayImportDescriptor={start:this._io.pos,ioOffset:this._io.byteOffset},this.delayImportDescriptor=new r(this._io,this,this._root),this._debug.delayImportDescriptor.end=this._io.pos,this._debug.clrRuntimeHeader={start:this._io.pos,ioOffset:this._io.byteOffset},this.clrRuntimeHeader=new r(this._io,this,this._root),this._debug.clrRuntimeHeader.end=this._io.pos},t})(),y=o.OptionalHeaderStd=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.format={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftPe.PeFormat"},this.format=this._io.readU2le(),this._debug.format.end=this._io.pos,this._debug.majorLinkerVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.majorLinkerVersion=this._io.readU1(),this._debug.majorLinkerVersion.end=this._io.pos,this._debug.minorLinkerVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minorLinkerVersion=this._io.readU1(),this._debug.minorLinkerVersion.end=this._io.pos,this._debug.sizeOfCode={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfCode=this._io.readU4le(),this._debug.sizeOfCode.end=this._io.pos,this._debug.sizeOfInitializedData={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfInitializedData=this._io.readU4le(),this._debug.sizeOfInitializedData.end=this._io.pos,this._debug.sizeOfUninitializedData={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfUninitializedData=this._io.readU4le(),this._debug.sizeOfUninitializedData.end=this._io.pos,this._debug.addressOfEntryPoint={start:this._io.pos,ioOffset:this._io.byteOffset},this.addressOfEntryPoint=this._io.readU4le(),this._debug.addressOfEntryPoint.end=this._io.pos,this._debug.baseOfCode={start:this._io.pos,ioOffset:this._io.byteOffset},this.baseOfCode=this._io.readU4le(),this._debug.baseOfCode.end=this._io.pos,this.format==o.PeFormat.PE32&&(this._debug.baseOfData={start:this._io.pos,ioOffset:this._io.byteOffset},this.baseOfData=this._io.readU4le(),this._debug.baseOfData.end=this._io.pos)},t})(),O=o.OptionalHeaderWindows=(function(){t.SubsystemEnum=Object.freeze({UNKNOWN:0,NATIVE:1,WINDOWS_GUI:2,WINDOWS_CUI:3,POSIX_CUI:7,WINDOWS_CE_GUI:9,EFI_APPLICATION:10,EFI_BOOT_SERVICE_DRIVER:11,EFI_RUNTIME_DRIVER:12,EFI_ROM:13,XBOX:14,WINDOWS_BOOT_APPLICATION:16,0:"UNKNOWN",1:"NATIVE",2:"WINDOWS_GUI",3:"WINDOWS_CUI",7:"POSIX_CUI",9:"WINDOWS_CE_GUI",10:"EFI_APPLICATION",11:"EFI_BOOT_SERVICE_DRIVER",12:"EFI_RUNTIME_DRIVER",13:"EFI_ROM",14:"XBOX",16:"WINDOWS_BOOT_APPLICATION"});function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._parent.std.format==o.PeFormat.PE32&&(this._debug.imageBase32={start:this._io.pos,ioOffset:this._io.byteOffset},this.imageBase32=this._io.readU4le(),this._debug.imageBase32.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32_PLUS&&(this._debug.imageBase64={start:this._io.pos,ioOffset:this._io.byteOffset},this.imageBase64=this._io.readU8le(),this._debug.imageBase64.end=this._io.pos),this._debug.sectionAlignment={start:this._io.pos,ioOffset:this._io.byteOffset},this.sectionAlignment=this._io.readU4le(),this._debug.sectionAlignment.end=this._io.pos,this._debug.fileAlignment={start:this._io.pos,ioOffset:this._io.byteOffset},this.fileAlignment=this._io.readU4le(),this._debug.fileAlignment.end=this._io.pos,this._debug.majorOperatingSystemVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.majorOperatingSystemVersion=this._io.readU2le(),this._debug.majorOperatingSystemVersion.end=this._io.pos,this._debug.minorOperatingSystemVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minorOperatingSystemVersion=this._io.readU2le(),this._debug.minorOperatingSystemVersion.end=this._io.pos,this._debug.majorImageVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.majorImageVersion=this._io.readU2le(),this._debug.majorImageVersion.end=this._io.pos,this._debug.minorImageVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minorImageVersion=this._io.readU2le(),this._debug.minorImageVersion.end=this._io.pos,this._debug.majorSubsystemVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.majorSubsystemVersion=this._io.readU2le(),this._debug.majorSubsystemVersion.end=this._io.pos,this._debug.minorSubsystemVersion={start:this._io.pos,ioOffset:this._io.byteOffset},this.minorSubsystemVersion=this._io.readU2le(),this._debug.minorSubsystemVersion.end=this._io.pos,this._debug.win32VersionValue={start:this._io.pos,ioOffset:this._io.byteOffset},this.win32VersionValue=this._io.readU4le(),this._debug.win32VersionValue.end=this._io.pos,this._debug.sizeOfImage={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfImage=this._io.readU4le(),this._debug.sizeOfImage.end=this._io.pos,this._debug.sizeOfHeaders={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfHeaders=this._io.readU4le(),this._debug.sizeOfHeaders.end=this._io.pos,this._debug.checkSum={start:this._io.pos,ioOffset:this._io.byteOffset},this.checkSum=this._io.readU4le(),this._debug.checkSum.end=this._io.pos,this._debug.subsystem={start:this._io.pos,ioOffset:this._io.byteOffset,enumName:"MicrosoftPe.OptionalHeaderWindows.SubsystemEnum"},this.subsystem=this._io.readU2le(),this._debug.subsystem.end=this._io.pos,this._debug.dllCharacteristics={start:this._io.pos,ioOffset:this._io.byteOffset},this.dllCharacteristics=this._io.readU2le(),this._debug.dllCharacteristics.end=this._io.pos,this._parent.std.format==o.PeFormat.PE32&&(this._debug.sizeOfStackReserve32={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfStackReserve32=this._io.readU4le(),this._debug.sizeOfStackReserve32.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32_PLUS&&(this._debug.sizeOfStackReserve64={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfStackReserve64=this._io.readU8le(),this._debug.sizeOfStackReserve64.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32&&(this._debug.sizeOfStackCommit32={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfStackCommit32=this._io.readU4le(),this._debug.sizeOfStackCommit32.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32_PLUS&&(this._debug.sizeOfStackCommit64={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfStackCommit64=this._io.readU8le(),this._debug.sizeOfStackCommit64.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32&&(this._debug.sizeOfHeapReserve32={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfHeapReserve32=this._io.readU4le(),this._debug.sizeOfHeapReserve32.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32_PLUS&&(this._debug.sizeOfHeapReserve64={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfHeapReserve64=this._io.readU8le(),this._debug.sizeOfHeapReserve64.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32&&(this._debug.sizeOfHeapCommit32={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfHeapCommit32=this._io.readU4le(),this._debug.sizeOfHeapCommit32.end=this._io.pos),this._parent.std.format==o.PeFormat.PE32_PLUS&&(this._debug.sizeOfHeapCommit64={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfHeapCommit64=this._io.readU8le(),this._debug.sizeOfHeapCommit64.end=this._io.pos),this._debug.loaderFlags={start:this._io.pos,ioOffset:this._io.byteOffset},this.loaderFlags=this._io.readU4le(),this._debug.loaderFlags.end=this._io.pos,this._debug.numberOfRvaAndSizes={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfRvaAndSizes=this._io.readU4le(),this._debug.numberOfRvaAndSizes.end=this._io.pos},t})(),g=o.PeHeader=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){if(this._debug.peSignature={start:this._io.pos,ioOffset:this._io.byteOffset},this.peSignature=this._io.readBytes(4),this._debug.peSignature.end=this._io.pos,_.byteArrayCompare(this.peSignature,new Uint8Array([80,69,0,0]))!=0){var i=new _.ValidationNotEqualError(new Uint8Array([80,69,0,0]),this.peSignature,this._io,"/types/pe_header/seq/0");throw this._debug.peSignature.validationError=i,i}this._debug.coffHdr={start:this._io.pos,ioOffset:this._io.byteOffset},this.coffHdr=new b(this._io,this,this._root),this._debug.coffHdr.end=this._io.pos,this._debug.optionalHdr={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw_optionalHdr=this._io.readBytes(this.coffHdr.sizeOfOptionalHeader);var e=new _(this._raw_optionalHdr);this.optionalHdr=new c(e,this,this._root),this._debug.optionalHdr.end=this._io.pos,this._debug.sections={start:this._io.pos,ioOffset:this._io.byteOffset},this._debug.sections.arr=[],this.sections=[];for(var s=0;s<this.coffHdr.numberOfSections;s++)this._debug.sections.arr[s]={start:this._io.pos,ioOffset:this._io.byteOffset},this.sections.push(new S(this._io,this,this._root)),this._debug.sections.arr[s].end=this._io.pos;this._debug.sections.end=this._io.pos},Object.defineProperty(t.prototype,"certificateTable",{get:function(){if(this._m_certificateTable!==void 0)return this._m_certificateTable;if(this.optionalHdr.dataDirs.certificateTable.virtualAddress!=0){var i=this._io.pos;this._io.seek(this.optionalHdr.dataDirs.certificateTable.virtualAddress),this._debug._m_certificateTable={start:this._io.pos,ioOffset:this._io.byteOffset},this._raw__m_certificateTable=this._io.readBytes(this.optionalHdr.dataDirs.certificateTable.size);var e=new _(this._raw__m_certificateTable);this._m_certificateTable=new p(e,this,this._root),this._debug._m_certificateTable.end=this._io.pos,this._io.seek(i)}return this._m_certificateTable}}),t})(),S=o.Section=(function(){function t(i,e,s){this._io=i,this._parent=e,this._root=s,this._debug={},this._read()}return t.prototype._read=function(){this._debug.name={start:this._io.pos,ioOffset:this._io.byteOffset},this.name=_.bytesToStr(_.bytesStripRight(this._io.readBytes(8),0),"UTF-8"),this._debug.name.end=this._io.pos,this._debug.virtualSize={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualSize=this._io.readU4le(),this._debug.virtualSize.end=this._io.pos,this._debug.virtualAddress={start:this._io.pos,ioOffset:this._io.byteOffset},this.virtualAddress=this._io.readU4le(),this._debug.virtualAddress.end=this._io.pos,this._debug.sizeOfRawData={start:this._io.pos,ioOffset:this._io.byteOffset},this.sizeOfRawData=this._io.readU4le(),this._debug.sizeOfRawData.end=this._io.pos,this._debug.pointerToRawData={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToRawData=this._io.readU4le(),this._debug.pointerToRawData.end=this._io.pos,this._debug.pointerToRelocations={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToRelocations=this._io.readU4le(),this._debug.pointerToRelocations.end=this._io.pos,this._debug.pointerToLinenumbers={start:this._io.pos,ioOffset:this._io.byteOffset},this.pointerToLinenumbers=this._io.readU4le(),this._debug.pointerToLinenumbers.end=this._io.pos,this._debug.numberOfRelocations={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfRelocations=this._io.readU2le(),this._debug.numberOfRelocations.end=this._io.pos,this._debug.numberOfLinenumbers={start:this._io.pos,ioOffset:this._io.byteOffset},this.numberOfLinenumbers=this._io.readU2le(),this._debug.numberOfLinenumbers.end=this._io.pos,this._debug.characteristics={start:this._io.pos,ioOffset:this._io.byteOffset},this.characteristics=this._io.readU4le(),this._debug.characteristics.end=this._io.pos},Object.defineProperty(t.prototype,"body",{get:function(){if(this._m_body!==void 0)return this._m_body;var i=this._io.pos;return this._io.seek(this.pointerToRawData),this._debug._m_body={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_body=this._io.readBytes(this.sizeOfRawData),this._debug._m_body.end=this._io.pos,this._io.seek(i),this._m_body}}),t})();return Object.defineProperty(o.prototype,"pe",{get:function(){if(this._m_pe!==void 0)return this._m_pe;var t=this._io.pos;return this._io.seek(this.mz.ofsPe),this._debug._m_pe={start:this._io.pos,ioOffset:this._io.byteOffset},this._m_pe=new g(this._io,this,this._root),this._debug._m_pe.end=this._io.pos,this._io.seek(t),this._m_pe}}),o})();a.MicrosoftPe=n})}});const E=T(),w={id:"microsoft_pe",title:"Microsoft PE (Portable Executable) file format",ksy:{meta:{id:"microsoft_pe",title:"Microsoft PE (Portable Executable) file format",application:"Microsoft Windows","file-extension":["exe","dll","sys"],xref:{justsolve:"Portable_Executable",pronom:"x-fmt/411",wikidata:"Q1076355"},tags:["executable","windows"],license:"CC0-1.0","ks-version":.7,endian:"le"},"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/debug/pe-format",seq:[{id:"mz",type:"mz_placeholder"}],instances:{pe:{pos:"mz.ofs_pe",type:"pe_header"}},enums:{pe_format:{263:"rom_image",267:"pe32",523:"pe32_plus"}},types:{mz_placeholder:{seq:[{id:"magic",contents:"MZ"},{id:"data1",size:58},{id:"ofs_pe",type:"u4",doc:"In PE file, an offset to PE header"}]},pe_header:{seq:[{id:"pe_signature",contents:["PE",0,0]},{id:"coff_hdr",type:"coff_header"},{id:"optional_hdr",type:"optional_header",size:"coff_hdr.size_of_optional_header"},{id:"sections",repeat:"expr","repeat-expr":"coff_hdr.number_of_sections",type:"section"}],instances:{certificate_table:{pos:"optional_hdr.data_dirs.certificate_table.virtual_address",size:"optional_hdr.data_dirs.certificate_table.size",type:"certificate_table",if:"optional_hdr.data_dirs.certificate_table.virtual_address != 0"}}},coff_header:{"doc-ref":"3.3. COFF File Header (Object and Image)",seq:[{id:"machine",type:"u2",enum:"machine_type"},{id:"number_of_sections",type:"u2"},{id:"time_date_stamp",type:"u4"},{id:"pointer_to_symbol_table",type:"u4"},{id:"number_of_symbols",type:"u4"},{id:"size_of_optional_header",type:"u2"},{id:"characteristics",type:"u2"}],instances:{symbol_table_size:{value:"number_of_symbols * 18"},symbol_name_table_offset:{value:"pointer_to_symbol_table + symbol_table_size"},symbol_name_table_size:{pos:"symbol_name_table_offset",type:"u4"},symbol_table:{pos:"pointer_to_symbol_table",type:"coff_symbol",repeat:"expr","repeat-expr":"number_of_symbols"}},enums:{machine_type:{0:{id:"unknown",doc:"The content of this field is assumed to be applicable to any machine type"},332:{id:"i386",doc:"Intel 386 or later processors and compatible processors"},358:{id:"r4000",doc:"MIPS little endian"},361:{id:"wce_mips_v2","-orig-id":"IMAGE_FILE_MACHINE_WCEMIPSV2",doc:"MIPS little-endian WCE v2"},388:{id:"alpha",doc:"Alpha AXP, 32-bit address space"},418:{id:"sh3",doc:"Hitachi SH3"},419:{id:"sh3_dsp","-orig-id":"IMAGE_FILE_MACHINE_SH3DSP",doc:"Hitachi SH3 DSP"},422:{id:"sh4",doc:"Hitachi SH4"},424:{id:"sh5",doc:"Hitachi SH5"},448:{id:"arm",doc:"ARM little endian"},450:{id:"thumb",doc:"Thumb"},452:{id:"arm_nt","-orig-id":"IMAGE_FILE_MACHINE_ARMNT",doc:"ARM Thumb-2 little endian"},467:{id:"am33",doc:"Matsushita AM33"},496:{id:"powerpc",doc:"Power PC little endian"},497:{id:"powerpc_fp","-orig-id":"IMAGE_FILE_MACHINE_POWERPCFP",doc:"Power PC with floating point support"},512:{id:"ia64",doc:"Intel Itanium processor family"},614:{id:"mips16",doc:"MIPS16"},644:{id:"alpha64_or_axp64","-orig-id":["IMAGE_FILE_MACHINE_ALPHA64","IMAGE_FILE_MACHINE_AXP64"],doc:`> Alpha 64, 64-bit address space
or
> AXP 64 (Same as Alpha 64)
`},870:{id:"mips_fpu","-orig-id":"IMAGE_FILE_MACHINE_MIPSFPU",doc:"MIPS with FPU"},1126:{id:"mips16_fpu","-orig-id":"IMAGE_FILE_MACHINE_MIPSFPU16",doc:"MIPS16 with FPU"},3772:{id:"ebc",doc:"EFI byte code"},20530:{id:"riscv32",doc:"RISC-V 32-bit address space"},20580:{id:"riscv64",doc:"RISC-V 64-bit address space"},20776:{id:"riscv128",doc:"RISC-V 128-bit address space"},25138:{id:"loongarch32",doc:"LoongArch 32-bit processor family"},25188:{id:"loongarch64",doc:"LoongArch 64-bit processor family"},34404:{id:"amd64",doc:"x64"},36929:{id:"m32r",doc:"Mitsubishi M32R little endian"},43620:{id:"arm64",doc:"ARM64 little endian"}}}},coff_symbol:{seq:[{id:"name_annoying",type:"annoyingstring",size:8},{id:"value",type:"u4"},{id:"section_number",type:"u2"},{id:"type",type:"u2"},{id:"storage_class",type:"u1"},{id:"number_of_aux_symbols",type:"u1"}],instances:{section:{value:"_root.pe.sections[section_number - 1]"},data:{pos:"section.pointer_to_raw_data + value",size:1}}},annoyingstring:{"-webide-representation":"{name}",instances:{name_zeroes:{pos:0,type:"u4"},name_offset:{pos:4,type:"u4"},name_from_offset:{io:"_root._io",pos:"name_zeroes == 0 ? _parent._parent.symbol_name_table_offset + name_offset : 0",type:"str",terminator:0,"eos-error":!1,encoding:"ascii",if:"name_zeroes == 0"},name_from_short:{pos:0,type:"str",terminator:0,"eos-error":!1,encoding:"ascii",if:"name_zeroes != 0"},name:{value:"name_zeroes == 0 ? name_from_offset : name_from_short"}}},optional_header:{seq:[{id:"std",type:"optional_header_std"},{id:"windows",type:"optional_header_windows"},{id:"data_dirs",type:"optional_header_data_dirs"}]},optional_header_std:{seq:[{id:"format",type:"u2",enum:"pe_format"},{id:"major_linker_version",type:"u1"},{id:"minor_linker_version",type:"u1"},{id:"size_of_code",type:"u4"},{id:"size_of_initialized_data",type:"u4"},{id:"size_of_uninitialized_data",type:"u4"},{id:"address_of_entry_point",type:"u4"},{id:"base_of_code",type:"u4"},{id:"base_of_data",type:"u4",if:"format == pe_format::pe32"}]},optional_header_windows:{seq:[{id:"image_base_32",type:"u4",if:"_parent.std.format == pe_format::pe32"},{id:"image_base_64",type:"u8",if:"_parent.std.format == pe_format::pe32_plus"},{id:"section_alignment",type:"u4"},{id:"file_alignment",type:"u4"},{id:"major_operating_system_version",type:"u2"},{id:"minor_operating_system_version",type:"u2"},{id:"major_image_version",type:"u2"},{id:"minor_image_version",type:"u2"},{id:"major_subsystem_version",type:"u2"},{id:"minor_subsystem_version",type:"u2"},{id:"win32_version_value",type:"u4"},{id:"size_of_image",type:"u4"},{id:"size_of_headers",type:"u4"},{id:"check_sum",type:"u4"},{id:"subsystem",type:"u2",enum:"subsystem_enum"},{id:"dll_characteristics",type:"u2"},{id:"size_of_stack_reserve_32",type:"u4",if:"_parent.std.format == pe_format::pe32"},{id:"size_of_stack_reserve_64",type:"u8",if:"_parent.std.format == pe_format::pe32_plus"},{id:"size_of_stack_commit_32",type:"u4",if:"_parent.std.format == pe_format::pe32"},{id:"size_of_stack_commit_64",type:"u8",if:"_parent.std.format == pe_format::pe32_plus"},{id:"size_of_heap_reserve_32",type:"u4",if:"_parent.std.format == pe_format::pe32"},{id:"size_of_heap_reserve_64",type:"u8",if:"_parent.std.format == pe_format::pe32_plus"},{id:"size_of_heap_commit_32",type:"u4",if:"_parent.std.format == pe_format::pe32"},{id:"size_of_heap_commit_64",type:"u8",if:"_parent.std.format == pe_format::pe32_plus"},{id:"loader_flags",type:"u4"},{id:"number_of_rva_and_sizes",type:"u4"}],enums:{subsystem_enum:{0:"unknown",1:"native",2:"windows_gui",3:"windows_cui",7:"posix_cui",9:"windows_ce_gui",10:"efi_application",11:"efi_boot_service_driver",12:"efi_runtime_driver",13:"efi_rom",14:"xbox",16:"windows_boot_application"}}},optional_header_data_dirs:{seq:[{id:"export_table",type:"data_dir"},{id:"import_table",type:"data_dir"},{id:"resource_table",type:"data_dir"},{id:"exception_table",type:"data_dir"},{id:"certificate_table",type:"data_dir"},{id:"base_relocation_table",type:"data_dir"},{id:"debug",type:"data_dir"},{id:"architecture",type:"data_dir"},{id:"global_ptr",type:"data_dir"},{id:"tls_table",type:"data_dir"},{id:"load_config_table",type:"data_dir"},{id:"bound_import",type:"data_dir"},{id:"iat",type:"data_dir"},{id:"delay_import_descriptor",type:"data_dir"},{id:"clr_runtime_header",type:"data_dir"}]},data_dir:{seq:[{id:"virtual_address",type:"u4"},{id:"size",type:"u4"}]},section:{"-webide-representation":"{name}",seq:[{id:"name",type:"str",encoding:"UTF-8",size:8,"pad-right":0},{id:"virtual_size",type:"u4"},{id:"virtual_address",type:"u4"},{id:"size_of_raw_data",type:"u4"},{id:"pointer_to_raw_data",type:"u4"},{id:"pointer_to_relocations",type:"u4"},{id:"pointer_to_linenumbers",type:"u4"},{id:"number_of_relocations",type:"u2"},{id:"number_of_linenumbers",type:"u2"},{id:"characteristics",type:"u4"}],instances:{body:{pos:"pointer_to_raw_data",size:"size_of_raw_data"}}},certificate_table:{seq:[{id:"items",type:"certificate_entry",repeat:"eos"}]},certificate_entry:{"doc-ref":"https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#the-attribute-certificate-table-image-only",enums:{certificate_revision:{256:{id:"revision_1_0",doc:`Version 1, legacy version of the Win_Certificate structure.
It is supported only for purposes of verifying legacy Authenticode signatures
`},512:{id:"revision_2_0",doc:"Version 2 is the current version of the Win_Certificate structure."}},certificate_type_enum:{1:{id:"x509",doc:`bCertificate contains an X.509 Certificate
Not Supported
`},2:{id:"pkcs_signed_data",doc:"bCertificate contains a PKCS#7 SignedData structure"},3:{id:"reserved_1",doc:"Reserved"},4:{id:"ts_stack_signed",doc:`Terminal Server Protocol Stack Certificate signing
Not Supported
`}}},seq:[{id:"length","-orig-id":"dwLength",type:"u4",doc:"Specifies the length of the attribute certificate entry."},{id:"revision","-orig-id":"wRevision",type:"u2",enum:"certificate_revision",doc:"Contains the certificate version number."},{id:"certificate_type","-orig-id":"wCertificateType",type:"u2",enum:"certificate_type_enum",doc:"Specifies the type of content in bCertificate"},{id:"certificate_bytes","-orig-id":"bCertificate",size:"length - 8",doc:"Contains a certificate, such as an Authenticode signature."}]}}}};export{E as default,w as spec};
